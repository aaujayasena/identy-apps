!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).AsgardioAuth={})}(this,(function(e){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function t(e,t,l,i){return new(l||(l=Promise))((function(n,o){function c(e){try{a(i.next(e))}catch(e){o(e)}}function s(e){try{a(i.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof l?t:new l((function(e){e(t)}))).then(c,s)}a((i=i.apply(e,t||[])).next())}))}const l={authorize:"/oauth2/authorize",jwks:"/oauth2/jwks",logout:"/oidc/logout",oidcSessionIFrame:"/oidc/checksession",revoke:"/oauth2/revoke",token:"/oauth2/token",wellKnown:"/oauth2/token/.well-known/openid-configuration"},i="authorization_endpoint",n="token_endpoint",o="revoke_token_endpoint",c="end_session_endpoint",s="jwks_uri",a="op_config_initiated",d="tenant",r="sign_in_redirect_url",u="sign_out_redirect_url",Z="oidc_session_iframe_endpoint",m="open_id_config",b="access_token",h="expires_in",p="issued_at",G="code",W="client_id",X="id_token",S="openid",y="pkce_code_verifier",I="refresh_token",V="scope",g="session_state",Y="token_type",K="request_params",k="tenant_domain",N="issuer",R="logout_url",J="refresh_token_timer",v="username",U="email",f="display_name",C="init",L="sign-in",T="signed-in",H="auth-required",F="api-call",x="api-call-all",z="custom-grant",P="end-user-session",w="request-start",Q="request-success",j="request-error",B="request-finish",E="get-service-endpoints",M="get-user-info",O="get-decoded-id-token",D="logout_success";var A,_,q;(A=e.Storage||(e.Storage={})).LocalStorage="localStorage",A.SessionStorage="sessionStorage",A.WebWorker="webWorker",(_=e.Hooks||(e.Hooks={})).SignIn="sign-in",_.SignOut="sign-out",_.Initialize="initialize",_.HttpRequestStart="http-request-start",_.HttpRequestFinish="http-request-finish",_.HttpRequestError="http-request-error",_.HttpRequestSuccess="http-request-success",_.EndUserSession="end-user-session",_.CustomGrant="custom-grant",(q=e.ResponseMode||(e.ResponseMode={})).formPost="form_post",q.query="query";const $=t=>t.storage===e.Storage.WebWorker;var ee=function(e,t){return function(){for(var l=new Array(arguments.length),i=0;i<l.length;i++)l[i]=arguments[i];return e.apply(t,l)}},te=Object.prototype.toString;function le(e){return"[object Array]"===te.call(e)}function ie(e){return void 0===e}function ne(e){return null!==e&&"object"==typeof e}function oe(e){if("[object Object]"!==te.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function ce(e){return"[object Function]"===te.call(e)}function se(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),le(e))for(var l=0,i=e.length;l<i;l++)t.call(null,e[l],l,e);else for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(null,e[n],n,e)}var ae={isArray:le,isArrayBuffer:function(e){return"[object ArrayBuffer]"===te.call(e)},isBuffer:function(e){return null!==e&&!ie(e)&&null!==e.constructor&&!ie(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:ne,isPlainObject:oe,isUndefined:ie,isDate:function(e){return"[object Date]"===te.call(e)},isFile:function(e){return"[object File]"===te.call(e)},isBlob:function(e){return"[object Blob]"===te.call(e)},isFunction:ce,isStream:function(e){return ne(e)&&ce(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:se,merge:function e(){var t={};function l(l,i){oe(t[i])&&oe(l)?t[i]=e(t[i],l):oe(l)?t[i]=e({},l):le(l)?t[i]=l.slice():t[i]=l}for(var i=0,n=arguments.length;i<n;i++)se(arguments[i],l);return t},extend:function(e,t,l){return se(t,(function(t,i){e[i]=l&&"function"==typeof t?ee(t,l):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}};function de(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var re=function(e,t,l){if(!t)return e;var i;if(l)i=l(t);else if(ae.isURLSearchParams(t))i=t.toString();else{var n=[];ae.forEach(t,(function(e,t){null!=e&&(ae.isArray(e)?t+="[]":e=[e],ae.forEach(e,(function(e){ae.isDate(e)?e=e.toISOString():ae.isObject(e)&&(e=JSON.stringify(e)),n.push(de(t)+"="+de(e))})))})),i=n.join("&")}if(i){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e};function ue(){this.handlers=[]}ue.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},ue.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},ue.prototype.forEach=function(e){ae.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var Ze=ue,me=function(e,t,l){return ae.forEach(l,(function(l){e=l(e,t)})),e},be=function(e){return!(!e||!e.__CANCEL__)},he=function(e,t){ae.forEach(e,(function(l,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=l,delete e[i])}))},pe=function(e,t,l,i,n){return function(e,t,l,i,n){return e.config=t,l&&(e.code=l),e.request=i,e.response=n,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}(new Error(e),t,l,i,n)},Ge=ae.isStandardBrowserEnv()?{write:function(e,t,l,i,n,o){var c=[];c.push(e+"="+encodeURIComponent(t)),ae.isNumber(l)&&c.push("expires="+new Date(l).toGMTString()),ae.isString(i)&&c.push("path="+i),ae.isString(n)&&c.push("domain="+n),!0===o&&c.push("secure"),document.cookie=c.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},We=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],Xe=ae.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),l=document.createElement("a");function i(e){var i=e;return t&&(l.setAttribute("href",i),i=l.href),l.setAttribute("href",i),{href:l.href,protocol:l.protocol?l.protocol.replace(/:$/,""):"",host:l.host,search:l.search?l.search.replace(/^\?/,""):"",hash:l.hash?l.hash.replace(/^#/,""):"",hostname:l.hostname,port:l.port,pathname:"/"===l.pathname.charAt(0)?l.pathname:"/"+l.pathname}}return e=i(window.location.href),function(t){var l=ae.isString(t)?i(t):t;return l.protocol===e.protocol&&l.host===e.host}}():function(){return!0},Se=function(e){return new Promise((function(t,l){var i=e.data,n=e.headers;ae.isFormData(i)&&delete n["Content-Type"];var o=new XMLHttpRequest;if(e.auth){var c=e.auth.username||"",s=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";n.Authorization="Basic "+btoa(c+":"+s)}var a,d,r=(a=e.baseURL,d=e.url,a&&!/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(d)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(a,d):d);if(o.open(e.method.toUpperCase(),re(r,e.params,e.paramsSerializer),!0),o.timeout=e.timeout,o.onreadystatechange=function(){if(o&&4===o.readyState&&(0!==o.status||o.responseURL&&0===o.responseURL.indexOf("file:"))){var i,n,c,s,a,d="getAllResponseHeaders"in o?(i=o.getAllResponseHeaders(),a={},i?(ae.forEach(i.split("\n"),(function(e){if(s=e.indexOf(":"),n=ae.trim(e.substr(0,s)).toLowerCase(),c=ae.trim(e.substr(s+1)),n){if(a[n]&&We.indexOf(n)>=0)return;a[n]="set-cookie"===n?(a[n]?a[n]:[]).concat([c]):a[n]?a[n]+", "+c:c}})),a):a):null,r={data:e.responseType&&"text"!==e.responseType?o.response:o.responseText,status:o.status,statusText:o.statusText,headers:d,config:e,request:o};!function(e,t,l){var i=l.config.validateStatus;l.status&&i&&!i(l.status)?t(pe("Request failed with status code "+l.status,l.config,null,l.request,l)):e(l)}(t,l,r),o=null}},o.onabort=function(){o&&(l(pe("Request aborted",e,"ECONNABORTED",o)),o=null)},o.onerror=function(){l(pe("Network Error",e,null,o)),o=null},o.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),l(pe(t,e,"ECONNABORTED",o)),o=null},ae.isStandardBrowserEnv()){var u=(e.withCredentials||Xe(r))&&e.xsrfCookieName?Ge.read(e.xsrfCookieName):void 0;u&&(n[e.xsrfHeaderName]=u)}if("setRequestHeader"in o&&ae.forEach(n,(function(e,t){void 0===i&&"content-type"===t.toLowerCase()?delete n[t]:o.setRequestHeader(t,e)})),ae.isUndefined(e.withCredentials)||(o.withCredentials=!!e.withCredentials),e.responseType)try{o.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&o.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&o.upload&&o.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){o&&(o.abort(),l(e),o=null)})),i||(i=null),o.send(i)}))},ye={"Content-Type":"application/x-www-form-urlencoded"};function Ie(e,t){!ae.isUndefined(e)&&ae.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var Ve,ge={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(Ve=Se),Ve),transformRequest:[function(e,t){return he(t,"Accept"),he(t,"Content-Type"),ae.isFormData(e)||ae.isArrayBuffer(e)||ae.isBuffer(e)||ae.isStream(e)||ae.isFile(e)||ae.isBlob(e)?e:ae.isArrayBufferView(e)?e.buffer:ae.isURLSearchParams(e)?(Ie(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):ae.isObject(e)?(Ie(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};ge.headers={common:{Accept:"application/json, text/plain, */*"}},ae.forEach(["delete","get","head"],(function(e){ge.headers[e]={}})),ae.forEach(["post","put","patch"],(function(e){ge.headers[e]=ae.merge(ye)}));var Ye=ge;function Ke(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var ke=function(e){return Ke(e),e.headers=e.headers||{},e.data=me(e.data,e.headers,e.transformRequest),e.headers=ae.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),ae.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||Ye.adapter)(e).then((function(t){return Ke(e),t.data=me(t.data,t.headers,e.transformResponse),t}),(function(t){return be(t)||(Ke(e),t&&t.response&&(t.response.data=me(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},Ne=function(e,t){t=t||{};var l={},i=["url","method","data"],n=["headers","auth","proxy","params"],o=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],c=["validateStatus"];function s(e,t){return ae.isPlainObject(e)&&ae.isPlainObject(t)?ae.merge(e,t):ae.isPlainObject(t)?ae.merge({},t):ae.isArray(t)?t.slice():t}function a(i){ae.isUndefined(t[i])?ae.isUndefined(e[i])||(l[i]=s(void 0,e[i])):l[i]=s(e[i],t[i])}ae.forEach(i,(function(e){ae.isUndefined(t[e])||(l[e]=s(void 0,t[e]))})),ae.forEach(n,a),ae.forEach(o,(function(i){ae.isUndefined(t[i])?ae.isUndefined(e[i])||(l[i]=s(void 0,e[i])):l[i]=s(void 0,t[i])})),ae.forEach(c,(function(i){i in t?l[i]=s(e[i],t[i]):i in e&&(l[i]=s(void 0,e[i]))}));var d=i.concat(n).concat(o).concat(c),r=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===d.indexOf(e)}));return ae.forEach(r,a),l};function Re(e){this.defaults=e,this.interceptors={request:new Ze,response:new Ze}}Re.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=Ne(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[ke,void 0],l=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)l=l.then(t.shift(),t.shift());return l},Re.prototype.getUri=function(e){return e=Ne(this.defaults,e),re(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},ae.forEach(["delete","get","head","options"],(function(e){Re.prototype[e]=function(t,l){return this.request(Ne(l||{},{method:e,url:t,data:(l||{}).data}))}})),ae.forEach(["post","put","patch"],(function(e){Re.prototype[e]=function(t,l,i){return this.request(Ne(i||{},{method:e,url:t,data:l}))}}));var Je=Re;function ve(e){this.message=e}ve.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},ve.prototype.__CANCEL__=!0;var Ue=ve;function fe(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var l=this;e((function(e){l.reason||(l.reason=new Ue(e),t(l.reason))}))}fe.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},fe.source=function(){var e;return{token:new fe((function(t){e=t})),cancel:e}};var Ce=fe;function Le(e){var t=new Je(e),l=ee(Je.prototype.request,t);return ae.extend(l,Je.prototype,t),ae.extend(l,t),l}var Te=Le(Ye);Te.Axios=Je,Te.create=function(e){return Le(Ne(Te.defaults,e))},Te.Cancel=Ue,Te.CancelToken=Ce,Te.isCancel=be,Te.all=function(e){return Promise.all(e)},Te.spread=function(e){return function(t){return e.apply(null,t)}};var He=Te,Fe=Te;He.default=Fe;var xe,ze=He;let Pe=xe=class{constructor(){this.init=this.init.bind(this)}static getInstance(){return this.axiosInstance||(this.axiosInstance=ze.create({withCredentials:!0}),this.clientInstance||(this.clientInstance=new xe),this.axiosInstance.interceptors.request.use((e=>this.clientInstance.requestHandler(e))),this.axiosInstance.interceptors.response.use((e=>this.clientInstance.successHandler(e)),(e=>this.clientInstance.errorHandler(e))),this.axiosInstance.all=ze.all,this.axiosInstance.spread=ze.spread,this.axiosInstance.init=this.clientInstance.init,this.axiosInstance.enableHandler=this.clientInstance.enableHandler,this.axiosInstance.disableHandler=this.clientInstance.disableHandler,this.axiosInstance.disableHandlerWithTimeout=this.clientInstance.disableHandlerWithTimeout),this.axiosInstance}requestHandler(e){return xe.isHandlerEnabled&&this.requestStartCallback&&"function"==typeof this.requestStartCallback&&this.requestStartCallback(e),e}errorHandler(e){throw xe.isHandlerEnabled&&(this.requestErrorCallback&&"function"==typeof this.requestErrorCallback&&this.requestErrorCallback(e),this.requestFinishCallback&&"function"==typeof this.requestFinishCallback&&this.requestFinishCallback()),e}successHandler(e){return xe.isHandlerEnabled&&(this.requestSuccessCallback&&"function"==typeof this.requestSuccessCallback&&this.requestSuccessCallback(e),this.requestFinishCallback&&"function"==typeof this.requestFinishCallback&&this.requestFinishCallback()),e}init(e=!0,t,l,i,n){xe.isHandlerEnabled=e,this.requestStartCallback&&this.requestSuccessCallback&&this.requestErrorCallback&&this.requestFinishCallback||(this.requestStartCallback||(this.requestStartCallback=t),this.requestSuccessCallback||(this.requestSuccessCallback=l),this.requestErrorCallback||(this.requestErrorCallback=i),this.requestFinishCallback||(this.requestFinishCallback=n))}enableHandler(){xe.isHandlerEnabled=!0}disableHandler(){xe.isHandlerEnabled=!1}disableHandlerWithTimeout(e=xe.DEFAULT_HANDLER_DISABLE_TIMEOUT){xe.isHandlerEnabled=!1,setTimeout((()=>{xe.isHandlerEnabled=!0}),e)}};Pe.DEFAULT_HANDLER_DISABLE_TIMEOUT=1e3,Pe=xe=function(e,t,l,i){var n,o=arguments.length,c=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,l):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,l,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(o<3?n(c):o>3?n(t,l,c):n(t,l))||c);return o>3&&c&&Object.defineProperty(t,l,c),c}([e=>{}],Pe);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function we(e,t,l){return e(l={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&l.path)}},l.exports),l.exports}var Qe=we((function(e,t){var l;e.exports=(l=l||function(e,t){var l=Object.create||function(){function e(){}return function(t){var l;return e.prototype=t,l=new e,e.prototype=null,l}}(),i={},n=i.lib={},o=n.Base={extend:function(e){var t=l(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=n.WordArray=o.extend({init:function(e,l){e=this.words=e||[],this.sigBytes=l!=t?l:4*e.length},toString:function(e){return(e||a).stringify(this)},concat:function(e){var t=this.words,l=e.words,i=this.sigBytes,n=e.sigBytes;if(this.clamp(),i%4)for(var o=0;o<n;o++){var c=l[o>>>2]>>>24-o%4*8&255;t[i+o>>>2]|=c<<24-(i+o)%4*8}else for(o=0;o<n;o+=4)t[i+o>>>2]=l[o>>>2];return this.sigBytes+=n,this},clamp:function(){var t=this.words,l=this.sigBytes;t[l>>>2]&=4294967295<<32-l%4*8,t.length=e.ceil(l/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var l,i=[],n=function(t){t=t;var l=987654321,i=4294967295;return function(){var n=((l=36969*(65535&l)+(l>>16)&i)<<16)+(t=18e3*(65535&t)+(t>>16)&i)&i;return n/=4294967296,(n+=.5)*(e.random()>.5?1:-1)}},o=0;o<t;o+=4){var s=n(4294967296*(l||e.random()));l=987654071*s(),i.push(4294967296*s()|0)}return new c.init(i,t)}}),s=i.enc={},a=s.Hex={stringify:function(e){for(var t=e.words,l=e.sigBytes,i=[],n=0;n<l;n++){var o=t[n>>>2]>>>24-n%4*8&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,l=[],i=0;i<t;i+=2)l[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new c.init(l,t/2)}},d=s.Latin1={stringify:function(e){for(var t=e.words,l=e.sigBytes,i=[],n=0;n<l;n++){var o=t[n>>>2]>>>24-n%4*8&255;i.push(String.fromCharCode(o))}return i.join("")},parse:function(e){for(var t=e.length,l=[],i=0;i<t;i++)l[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new c.init(l,t)}},r=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},u=n.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=r.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var l=this._data,i=l.words,n=l.sigBytes,o=this.blockSize,s=n/(4*o),a=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*o,d=e.min(4*a,n);if(a){for(var r=0;r<a;r+=o)this._doProcessBlock(i,r);var u=i.splice(0,a);l.sigBytes-=d}return new c.init(u,d)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),Z=(n.Hasher=u.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,l){return new e.init(l).finalize(t)}},_createHmacHelper:function(e){return function(t,l){return new Z.HMAC.init(e,l).finalize(t)}}}),i.algo={});return i}(Math),l)})),je=we((function(e,t){var l;e.exports=(l=Qe,function(){var e=l,t=e.lib.WordArray;function i(e,l,i){for(var n=[],o=0,c=0;c<l;c++)if(c%4){var s=i[e.charCodeAt(c-1)]<<c%4*2,a=i[e.charCodeAt(c)]>>>6-c%4*2;n[o>>>2]|=(s|a)<<24-o%4*8,o++}return t.create(n,o)}e.enc.Base64={stringify:function(e){var t=e.words,l=e.sigBytes,i=this._map;e.clamp();for(var n=[],o=0;o<l;o+=3)for(var c=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,s=0;s<4&&o+.75*s<l;s++)n.push(i.charAt(c>>>6*(3-s)&63));var a=i.charAt(64);if(a)for(;n.length%4;)n.push(a);return n.join("")},parse:function(e){var t=e.length,l=this._map,n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var o=0;o<l.length;o++)n[l.charCodeAt(o)]=o}var c=l.charAt(64);if(c){var s=e.indexOf(c);-1!==s&&(t=s)}return i(e,t,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),l.enc.Base64)})),Be=we((function(e,t){var l;e.exports=(l=Qe,function(){if("function"==typeof ArrayBuffer){var e=l.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var l=e.byteLength,i=[],n=0;n<l;n++)i[n>>>2]|=e[n]<<24-n%4*8;t.call(this,i,l)}else t.apply(this,arguments)}).prototype=e}}(),l.lib.WordArray)})),Ee=we((function(e,t){var l;e.exports=(l=Qe,function(e){var t=l,i=t.lib,n=i.WordArray,o=i.Hasher,c=t.algo,s=[],a=[];!function(){function t(t){for(var l=e.sqrt(t),i=2;i<=l;i++)if(!(t%i))return!1;return!0}function l(e){return 4294967296*(e-(0|e))|0}for(var i=2,n=0;n<64;)t(i)&&(n<8&&(s[n]=l(e.pow(i,.5))),a[n]=l(e.pow(i,1/3)),n++),i++}();var d=[],r=c.SHA256=o.extend({_doReset:function(){this._hash=new n.init(s.slice(0))},_doProcessBlock:function(e,t){for(var l=this._hash.words,i=l[0],n=l[1],o=l[2],c=l[3],s=l[4],r=l[5],u=l[6],Z=l[7],m=0;m<64;m++){if(m<16)d[m]=0|e[t+m];else{var b=d[m-15],h=(b<<25|b>>>7)^(b<<14|b>>>18)^b>>>3,p=d[m-2],G=(p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10;d[m]=h+d[m-7]+G+d[m-16]}var W=i&n^i&o^n&o,X=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),S=Z+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&r^~s&u)+a[m]+d[m];Z=u,u=r,r=s,s=c+S|0,c=o,o=n,n=i,i=S+(X+W)|0}l[0]=l[0]+i|0,l[1]=l[1]+n|0,l[2]=l[2]+o|0,l[3]=l[3]+c|0,l[4]=l[4]+s|0,l[5]=l[5]+r|0,l[6]=l[6]+u|0,l[7]=l[7]+Z|0},_doFinalize:function(){var t=this._data,l=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;return l[n>>>5]|=128<<24-n%32,l[14+(n+64>>>9<<4)]=e.floor(i/4294967296),l[15+(n+64>>>9<<4)]=i,t.sigBytes=4*l.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(r),t.HmacSHA256=o._createHmacHelper(r)}(Math),l.SHA256)}));const Me=new TextEncoder,Oe=new TextDecoder;var De=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;throw new Error("unable to locate global object")}();const Ae=e=>{let t=e;return t instanceof Uint8Array&&(t=Oe.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,""),new Uint8Array(De.atob(t).split("").map((e=>e.charCodeAt(0))))};class _e extends Error{constructor(e){super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class qe extends _e{constructor(e,t="unspecified",l="unspecified"){super(e),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=t,this.reason=l}}class $e extends _e{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}}class et extends _e{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}}class tt extends _e{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}}class lt extends _e{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}}class it extends _e{constructor(){super(...arguments),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}}class nt extends qe{constructor(){super(...arguments),this.code="ERR_JWT_EXPIRED"}}var ot=De.crypto;function ct(){if(!De.isSecureContext&&!De.crypto.subtle)throw new _e("Web Cryptography API is available only in Secure Contexts. See: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts")}const st=async e=>{var t,l;const{algorithm:i,keyUsages:n}=function(e){let t,l;switch(e.kty){case"oct":switch(e.alg){case"HS256":case"HS384":case"HS512":t={name:"HMAC",hash:`SHA-${e.alg.substr(-3)}`},l=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":throw new et(`${e.alg} keys cannot be imported as CryptoKey instances`);case"A128GCM":case"A192GCM":case"A256GCM":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":t={name:"AES-GCM"},l=["encrypt","decrypt"];break;case"A128KW":case"A192KW":case"A256KW":t={name:"AES-KW"},l=["wrapKey","unwrapKey"];break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":t={name:"PBKDF2"},l=["deriveBits"];break;default:throw new et('unsupported or invalid JWK "alg" (Algorithm) Parameter value')}break;case"RSA":switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.substr(-3)}`},l=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.substr(-3)}`},l=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.substr(-3),10)||1}`},l=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new et('unsupported or invalid JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(e.alg){case"ES256":case"ES384":case"ES512":t={name:"ECDSA",namedCurve:e.crv},l=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},l=e.d?["deriveBits"]:[];break;default:throw new et('unsupported or invalid JWK "alg" (Algorithm) Parameter value')}break;default:throw new et('unsupported or invalid JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:l}}(e);let o="jwk",c={...e};return delete c.alg,"PBKDF2"===i.name&&(o="raw",c=Ae(e.k)),ct(),ot.subtle.importKey(o,c,i,null!==(t=e.ext)&&void 0!==t&&t,null!==(l=e.key_ops)&&void 0!==l?l:n)};function at(e){return!!e&&e.constructor===Object}async function dt(e,t,l){if(!at(e))throw new TypeError("JWK must be an object");if(t||(t=e.alg),"string"!=typeof t||!t)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');switch(e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw new TypeError('missing "k" (Key Value) Parameter value');return null!=l||(l=!0!==e.ext),l?st({...e,alg:t,ext:!1}):Ae(e.k);case"RSA":if(void 0!==e.oth)throw new et('RSA JWK "oth" (Other Primes Info) Parameter value is unsupported');case"EC":case"OKP":return st({...e,alg:t});default:throw new et('unsupported "kty" (Key Type) Parameter value')}}const rt=async(e,t,l,i)=>{let n;if(ct(),t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError("symmetric keys are only applicable for HMAC-based algorithms");n=await ot.subtle.importKey("raw",t,{hash:`SHA-${e.substr(-3)}`,name:"HMAC"},!1,["verify"])}else n=t;return((e,t)=>{if(e.startsWith("HS")){const l=parseInt(e.substr(-3),10),{length:i}=t.algorithm;if("number"!=typeof i||i<l)throw new TypeError(`${e} requires symmetric keys to be ${l} bits or larger`)}if(e.startsWith("RS")||e.startsWith("PS")){const{modulusLength:l}=t.algorithm;if("number"!=typeof l||l<2048)throw new TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}})(e,n),ot.subtle.verify(function(e){switch(e){case"HS256":return{hash:"SHA-256",name:"HMAC"};case"HS384":return{hash:"SHA-384",name:"HMAC"};case"HS512":return{hash:"SHA-512",name:"HMAC"};case"PS256":return{hash:"SHA-256",name:"RSA-PSS",saltLength:32};case"PS384":return{hash:"SHA-384",name:"RSA-PSS",saltLength:48};case"PS512":return{hash:"SHA-512",name:"RSA-PSS",saltLength:64};case"RS256":return{hash:"SHA-256",name:"RSASSA-PKCS1-v1_5"};case"RS384":return{hash:"SHA-384",name:"RSASSA-PKCS1-v1_5"};case"RS512":return{hash:"SHA-512",name:"RSASSA-PKCS1-v1_5"};case"ES256":return{hash:"SHA-256",name:"ECDSA",namedCurve:"P-256"};case"ES384":return{hash:"SHA-384",name:"ECDSA",namedCurve:"P-384"};case"ES512":return{hash:"SHA-512",name:"ECDSA",namedCurve:"P-521"};default:throw new et(`alg ${e} is unsupported either by JOSE or your javascript runtime`)}}(e),n,l,i)};const ut=function(e,t,l,i){if(void 0!==i.crit&&void 0===l.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!l||void 0===l.crit)return new Set;if(!Array.isArray(l.crit)||0===l.crit.length||l.crit.some((e=>"string"!=typeof e||0===e.length)))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(const n of l.crit){if(!t.has(n))throw new et(`Extension Header Parameter "${n}" is not supported by this implementation`);if(void 0===i[n])throw new e(`Extension Header Parameter "${n}" is missing`);if(t.get(n)&&void 0===l[n])throw new e(`Extension Header Parameter "${n}" MUST be integrity protected`)}return new Set(l.crit)}.bind(void 0,tt,new Map([["b64",!0]])),Zt=((e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some((e=>"string"!=typeof e))))throw new TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)}).bind(void 0,"algorithms");async function mt(e,t,l){if(!at(e))throw new tt("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new tt('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new tt("JWS Protected Header incorrect type");if(void 0===e.payload)throw new tt("JWS Payload missing");if("string"!=typeof e.signature)throw new tt("JWS Signature missing or incorrect type");if(void 0!==e.header&&!at(e.header))throw new tt("JWS Unprotected Header incorrect type");let i={};if(e.protected){const t=Ae(e.protected);i=JSON.parse(Oe.decode(t))}if(!((...e)=>{const t=e.filter(Boolean);if(0===t.length||1===t.length)return!0;let l;for(const e of t){const t=Object.keys(e);if(l&&0!==l.size)for(const e of t){if(l.has(e))return!1;l.add(e)}else l=new Set(t)}return!0})(i,e.header))throw new tt("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const n={...i,...e.header};let o=!0;if(ut(i,n).has("b64")&&(o=i.b64,"boolean"!=typeof o))throw new tt('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:c}=n;if("string"!=typeof c||!c)throw new tt('JWS "alg" (Algorithm) Header Parameter missing or invalid');const s=l&&Zt(l.algorithms);if(s&&!s.has(c))throw new $e('"alg" (Algorithm) Header Parameter not allowed');if(o){if("string"!=typeof e.payload)throw new tt("JWS Payload must be a string")}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new tt("JWS Payload must be a string or an Uint8Array instance");"function"==typeof t&&(t=await t(i,e)),((e,t)=>{if(e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||e.match(/^A\d{3}(?:GCM)KW$/)){if(t instanceof Uint8Array||"secret"===t.type)return;throw new TypeError('CryptoKey or KeyObject instances for symmetric algorithms must be of type "secret"')}if(t instanceof Uint8Array)throw new TypeError("CryptoKey or KeyObject instances must be used for asymmetric algorithms");if("secret"===t.type)throw new TypeError('CryptoKey or KeyObject instances for asymmetric algorithms must not be of type "secret"')})(c,t);const a=function(...e){const t=e.reduce(((e,{length:t})=>e+t),0),l=new Uint8Array(t);let i=0;return e.forEach((e=>{l.set(e,i),i+=e.length})),l}(Me.encode(e.protected||""),Me.encode("."),"string"==typeof e.payload?Me.encode(e.payload):e.payload),d=Ae(e.signature);if(!await rt(c,t,d,a))throw new it;let r;r=o?Ae(e.payload):"string"==typeof e.payload?Me.encode(e.payload):e.payload;const u={payload:r};return void 0!==e.protected&&(u.protectedHeader=i),void 0!==e.header&&(u.unprotectedHeader=e.header),u}const bt=86400,ht=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i;var pt=e=>{const t=ht.exec(e);if(!t)throw new TypeError("invalid time period format");const l=parseFloat(t[1]);switch(t[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(l);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*l);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*l);case"day":case"days":case"d":return Math.round(l*bt);case"week":case"weeks":case"w":return Math.round(604800*l);default:return Math.round(31557600*l)}};const Gt=e=>e.toLowerCase().replace(/^application\//,"");var Wt=(e,t,l={})=>{const{typ:i}=l;if(i&&("string"!=typeof e.typ||Gt(e.typ)!==Gt(i)))throw new qe('unexpected "typ" JWT header value',"typ","check_failed");let n;try{n=JSON.parse(Oe.decode(t))}catch(e){}if("object"!=typeof n||!n||Array.isArray(n))throw new lt("JWT Claims Set must be a top-level JSON object");const{issuer:o}=l;if(o&&!("string"==typeof o?[o]:o).includes(n.iss))throw new qe('unexpected "iss" claim value',"iss","check_failed");const{subject:c}=l;if(c&&n.sub!==c)throw new qe('unexpected "sub" claim value',"sub","check_failed");const{audience:s}=l;if(s&&(a=n.aud,d="string"==typeof s?[s]:s,!("string"==typeof a?d.includes(a):d.some(Set.prototype.has.bind(new Set(a))))))throw new qe('unexpected "aud" claim value',"aud","check_failed");var a,d;let r;switch(typeof l.clockTolerance){case"string":r=pt(l.clockTolerance);break;case"number":r=l.clockTolerance;break;case"undefined":r=0;break;default:throw new TypeError("invalid clockTolerance option type")}const{currentDate:u}=l,Z=(m=u||new Date,Math.floor(m.getTime()/1e3));var m;if(void 0!==n.iat||l.maxTokenAge){if("number"!=typeof n.iat)throw new qe('"iat" claim must be a number',"iat","invalid");if(void 0===n.exp&&n.iat>Z+r)throw new qe('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}if(void 0!==n.nbf){if("number"!=typeof n.nbf)throw new qe('"nbf" claim must be a number',"nbf","invalid");if(n.nbf>Z+r)throw new qe('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==n.exp){if("number"!=typeof n.exp)throw new qe('"exp" claim must be a number',"exp","invalid");if(n.exp<=Z-r)throw new nt('"exp" claim timestamp check failed',"exp","check_failed")}if(l.maxTokenAge){const e=Z-n.iat;if(e-r>("number"==typeof l.maxTokenAge?l.maxTokenAge:pt(l.maxTokenAge)))throw new nt('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(e<0-r)throw new qe('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return n};async function Xt(e,t,l){const i=await async function(e,t,l){if(e instanceof Uint8Array&&(e=Oe.decode(e)),"string"!=typeof e)throw new tt("Compact JWS must be a string or Uint8Array");const{0:i,1:n,2:o,length:c}=e.split(".");if(3!==c)throw new tt("Invalid Compact JWS");const s=await mt({payload:n||void 0,protected:i||void 0,signature:o||void 0},t,l);return{payload:s.payload,protectedHeader:s.protectedHeader}}(e,t,l);return{payload:Wt(i.protectedHeader,i.payload,l),protectedHeader:i.protectedHeader}}const St=e=>je.stringify(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),yt=e=>({blob:(null==e?void 0:e.data)instanceof Blob?null==e?void 0:e.data:null,data:JSON.stringify(null!=e?e:""),success:!0}),It=e=>((null==e?void 0:e.toJSON)&&delete e.toJSON,{error:JSON.stringify(null!=e?e:""),success:!1});function Vt(t){if(t&&$(t)){if(t.session.get(G))return t.session.get(G)}else{if(t&&t.responseMode===e.ResponseMode.formPost)return t.authorizationCode;if(new URL(window.location.href).searchParams.get(G))return new URL(window.location.href).searchParams.get(G)}return null}function gt(t,l){const i=ll(t);if(!i||0===i.trim().length)return Promise.reject(new Error("Invalid authorize endpoint found."));let n=i+"?response_type=code&client_id="+t.clientID,o=S;if(t.scope&&t.scope.length>0&&(t.scope.includes(S)||t.scope.push(S),o=t.scope.join(" ")),n+="&scope="+o,n+="&redirect_uri="+t.signInRedirectURL,t.responseMode&&(n+="&response_mode="+t.responseMode),t.enablePKCE){const e=St(Be.random(32)),l=St(Ee(e));Tt(y,e,t),n+="&code_challenge_method=S256&code_challenge="+l}t.prompt&&(n+="&prompt="+t.prompt),l&&(n+="&fidp="+l);const c=t.customParams;if(c)for(const[e,t]of Object.entries(c))""!=e&&""!=t&&(n+="&"+e+"="+t);if(t.storage===e.Storage.WebWorker)return Promise.resolve({code:n,pkce:Ht(y,t),type:H});document.location.href=n}function Yt(e,t){const i=sl(t);return i&&0!==i.trim().length?ze.get(i).then((n=>{var o;if(200!==n.status)return Promise.reject(new Error("Failed to load public keys from JWKS URI: "+i));const c=al(t);let s=t.serverOrigin+l.wellKnown.split("/.well-known")[0];return(null===(o=t.endpoints)||void 0===o?void 0:o.wellKnown)&&(s=t.endpoints.wellKnown.split("/.well-known")[0]),c&&c===s?((e,t)=>{const l=JSON.parse(atob(e));for(const e of t)if(l.kid===e.kid)return dt({alg:e.alg,e:e.e,kty:e.kty,n:e.n});return Promise.reject("Failed to find the 'kid' specified in the id_token. 'kid' found in the header : "+l.kid+", Expected values: "+t.map((e=>e.kid)).join(", "))})(e.split(".")[0],n.data.keys).then((l=>((e,t,l,i,n,o)=>Xt(e,t,{algorithms:["RS256","RS512","RS384","PS256"],audience:l,clockTolerance:o,issuer:i,subject:n}).then((()=>Promise.resolve(!0))).catch((e=>Promise.reject(e))))(e,l,t.clientID,c,Nt(e).username,t.clockTolerance))).catch((e=>Promise.reject(e))):Promise.resolve(!1)})).catch((e=>Promise.reject(e))):Promise.reject("Invalid JWKS URI found.")}function Kt(e,t){const l=il(e);if(!l||0===l.trim().length)return Promise.reject("Invalid token endpoint found.");const i=[];return i.push(`client_id=${e.clientID}`),i.push(`refresh_token=${t}`),i.push("grant_type=refresh_token"),e.clientSecret&&e.clientSecret.trim().length>0&&i.push(`client_secret=${e.clientSecret}`),ze.post(l,i.join("&"),{headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}}).then((t=>{if(200!==t.status)return Promise.reject(new Error("Invalid status code received in the refresh token response: "+t.status));if(e.validateIDToken)return Yt(t.data.id_token,e).then((l=>{if(l){const l={accessToken:t.data.access_token,expiresIn:t.data.expires_in,idToken:t.data.id_token,refreshToken:t.data.refresh_token,scope:t.data.scope,tokenType:t.data.token_type};return xt(l,Nt(t.data.id_token),e),Promise.resolve(l)}return Promise.reject("Invalid id_token in the token response: "+t.data.id_token)}));{const l={accessToken:t.data.access_token,expiresIn:t.data.expires_in,idToken:t.data.id_token,refreshToken:t.data.refresh_token,scope:t.data.scope,tokenType:t.data.token_type};return xt(l,Nt(t.data.id_token),e),Promise.resolve(l)}})).catch((e=>Promise.reject(e)))}function kt(e,t){const l=nl(e);if(!l||0===l.trim().length)return Promise.reject("Invalid revoke token endpoint found.");const i=[];return i.push(`client_id=${e.clientID}`),i.push(`token=${t}`),i.push("token_type_hint=access_token"),ze.post(l,i.join("&"),{headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},withCredentials:!0}).then((e=>200!==e.status?Promise.reject(new Error("Invalid status code received in the revoke token response: "+e.status)):Promise.resolve(e))).catch((e=>Promise.reject(e)))}const Nt=e=>{const t=JSON.parse(atob(null==e?void 0:e.split(".")[1])),l=t.email?t.email:null,i=((e,t="@")=>{if(e.tenant_domain)return e.tenant_domain;const l=e.sub.split(t);return l[l.length-1]})(t);return{displayName:t.preferred_username?t.preferred_username:t.sub,email:l,tenantDomain:i,username:t.sub}};function Rt(t,l){return function(e){return!!Vt(e)}(t)?function(t){const l=il(t);if(!l||0===l.trim().length)return Promise.reject(new Error("Invalid token endpoint found."));const i=$(t)?t.session.get(g):new URL(window.location.href).searchParams.get(g);null!==i&&i.length>0&&Tt(g,i,t);const n=[];n.push(`client_id=${t.clientID}`),t.clientSecret&&t.clientSecret.trim().length>0&&n.push(`client_secret=${t.clientSecret}`);const o=$(t)?t.session.get(G):Vt(t);return n.push(`code=${o}`),t.storage===e.Storage.SessionStorage&&window.sessionStorage.getItem(G)&&window.sessionStorage.removeItem(G),$(t)&&t.session.get(G)&&t.session.delete(G),n.push("grant_type=authorization_code"),n.push(`redirect_uri=${t.signInRedirectURL}`),t.enablePKCE&&(n.push(`code_verifier=${Ht(y,t)}`),Lt(y,t)),ze.post(l,n.join("&"),{headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}}).then((e=>{if(200!==e.status)return Promise.reject(new Error("Invalid status code received in the token response: "+e.status));if(t.validateIDToken)return Yt(e.data.id_token,t).then((l=>{if(l){Tt(K,JSON.stringify(t),t);const l={accessToken:e.data.access_token,expiresIn:e.data.expires_in,idToken:e.data.id_token,refreshToken:e.data.refresh_token,scope:e.data.scope,tokenType:e.data.token_type};return Promise.resolve(l)}return Promise.reject("Invalid id_token in the token response: "+e.data.id_token)})).catch((e=>Promise.reject(e)));{const l={accessToken:e.data.access_token,expiresIn:e.data.expires_in,idToken:e.data.id_token,refreshToken:e.data.refresh_token,scope:e.data.scope,tokenType:e.data.token_type};return Tt(K,JSON.stringify(t),t),Promise.resolve(l)}})).catch((e=>Promise.reject(e)))}(t).then((e=>(xt(e,Nt(e.idToken),t),Promise.resolve({type:T})))).catch((e=>e.response&&400===e.response.status?gt(t):Promise.reject(e))):gt(t,l)}function Jt(e,t){return Ht(b,e)?rl(e)?Promise.resolve({type:T}):(Ft(e),el(e),Lt("auth_callback_url",e),$t(e,!0).then((()=>Rt(e,t))).catch((e=>Promise.reject(e)))):$t(e,!1).then((()=>Rt(e,t))).catch((e=>Promise.reject(e)))}const vt=(e,t)=>{if(!Ht(n,t)||0===Ht(n,t).trim().length)return Promise.reject(new Error("Invalid token endpoint found."));let l="";Object.entries(e.data).map((([i,n],o)=>{const c=((e,t)=>{let l=S;return t.scope&&t.scope.length>0&&(t.scope.includes(S)||t.scope.push(S),l=t.scope.join(" ")),e.replace("{{token}}",Ht(b,t)).replace("{{username}}",Ht(v,t)).replace("{{scope}}",l).replace("{{clientId}}",t.clientID).replace("{{clientSecret}}",t.clientSecret)})(n,t);l+=`${i}=${c}${o!==Object.entries(e.data).length-1?"&":""}`}));const i={data:l,headers:Object.assign({},{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}),method:"POST",url:Ht(n,t)};return e.attachToken&&(i.headers=Object.assign(Object.assign({},i.headers),{Authorization:`Bearer ${Ht(b,t)}`})),ze(i).then((l=>{if(200!==l.status)return Promise.reject(new Error("Invalid status code received in the token response: "+l.status));if(e.returnsSession){if(t.validateIDToken)return Yt(l.data.id_token,t).then((i=>{if(i){const i={accessToken:l.data.access_token,expiresIn:l.data.expires_in,idToken:l.data.id_token,refreshToken:l.data.refresh_token,scope:l.data.scope,tokenType:l.data.token_type};return xt(i,Nt(i.idToken),t),e.returnResponse?Promise.resolve({data:Ut(t),type:T}):Promise.resolve(!0)}return Promise.reject(new Error("Invalid id_token in the token response: "+l.data.id_token))}));{const i={accessToken:l.data.access_token,expiresIn:l.data.expires_in,idToken:l.data.id_token,refreshToken:l.data.refresh_token,scope:l.data.scope,tokenType:l.data.token_type};return xt(i,Nt(i.idToken),t),e.returnResponse?Promise.resolve({data:Ut(t),type:T}):Promise.resolve(!0)}}return e.returnResponse?Promise.resolve(l):Promise.resolve(!0)})).catch((e=>Promise.reject(e)))},Ut=e=>({allowedScopes:Ht(V,e),displayName:Ht(f,e),email:Ht(U,e),sessionState:Ht(g,e),tenantDomain:Ht(k,e),username:Ht(v,e)}),ft=e=>{const t=Ht(X,e);return JSON.parse(atob(t.split(".")[1]))},Ct=new class{constructor(e){this.tasks=[],this.count=e}sched(){if(this.count>0&&this.tasks.length>0){this.count--;let e=this.tasks.shift();if(void 0===e)throw"Unexpected undefined value in tasks list";e()}}acquire(){return new Promise(((e,t)=>{this.tasks.push((()=>{var t=!1;e((()=>{t||(t=!0,this.count++,this.sched())}))})),process&&process.nextTick?process.nextTick(this.sched.bind(this)):setImmediate(this.sched.bind(this))}))}use(e){return this.acquire().then((t=>e().then((e=>(t(),e))).catch((e=>{throw t(),e}))))}}(1);function Lt(t,l){switch(l.storage){case e.Storage.WebWorker:l.session.delete(t);break;case e.Storage.SessionStorage:sessionStorage.removeItem(t);break;case e.Storage.LocalStorage:localStorage.removeItem(t);break;default:sessionStorage.removeItem(t)}}function Tt(t,l,i){switch(i.storage){case e.Storage.WebWorker:i.session.set(t,l);break;case e.Storage.SessionStorage:sessionStorage.setItem(t,l);break;case e.Storage.LocalStorage:localStorage.setItem(t,l);break;default:sessionStorage.setItem(t,l)}}function Ht(t,l){var i;switch(l.storage){case e.Storage.WebWorker:return null===(i=null==l?void 0:l.session)||void 0===i?void 0:i.get(t);case e.Storage.SessionStorage:return sessionStorage.getItem(t);case e.Storage.LocalStorage:return localStorage.getItem(t);default:return sessionStorage.getItem(t)}}function Ft(e){Pt(e),Lt(b,e),Lt(h,e),Lt(p,e),Lt(f,e),Lt(U,e),Lt(X,e),Lt(I,e),Lt(V,e),Lt(k,e),Lt(Y,e),Lt(v,e),Lt(K,e),Lt(g,e)}function xt(e,t,l){Tt(b,e.accessToken,l),Tt(h,e.expiresIn,l),Tt(p,(Date.now()/1e3).toString(),l),Tt(f,t.displayName,l),Tt(U,t.email,l),Tt(X,e.idToken,l),Tt(V,e.scope,l),Tt(I,e.refreshToken,l),Tt(k,t.tenantDomain,l),Tt(Y,e.tokenType,l),Tt(v,t.username,l),zt(l)}const zt=e=>{const t=parseInt(Ht(h,e)),l=t<=10?t:t-10;Pt(e);const i=setTimeout((()=>{Kt(e,Ht(I,e))}),1e3*l);Tt(J,JSON.stringify(i),e)},Pt=e=>{if(Ht(J,e)){const t=JSON.parse(Ht(J,e));clearTimeout(t)}},wt=(e,t)=>{Tt(i,e,t)},Qt=(e,t)=>{Tt(n,e,t)},jt=(e,t)=>{Tt(c,e,t)},Bt=(e,t)=>{Tt(s,e,t)},Et=(e,t)=>{Tt(o,e,t)},Mt=e=>{Tt(a,"true",e)},Ot=(e,t)=>{Tt(r,e,t)},Dt=(e,t)=>{Tt(u,e,t)},At=(e,t)=>{Tt(Z,e,t)},_t=(e,t)=>{Tt(N,e,t)},qt=e=>{Tt(W,e.clientID,e)},$t=(e,t)=>{var i;if(!t&&rl(e))return Promise.resolve();const n=e.serverOrigin;let o=n+l.wellKnown;return(null===(i=null==e?void 0:e.endpoints)||void 0===i?void 0:i.wellKnown)&&(o=e.endpoints.wellKnown),ze.get(o).then((t=>{var i,o,c,s,a,d,r,u,Z,b,h,p;return 200!==t.status?Promise.reject(new Error("Failed to load OpenID provider configuration from: "+n+l.wellKnown)):(((e,t)=>{Tt(m,JSON.stringify(e),t)})(t.data,e),(null===(i=null==e?void 0:e.endpoints)||void 0===i?void 0:i.authorize)?wt(null===(o=null==e?void 0:e.endpoints)||void 0===o?void 0:o.authorize,e):wt(t.data.authorization_endpoint,e),(null===(c=null==e?void 0:e.endpoints)||void 0===c?void 0:c.token)?Qt(null===(s=null==e?void 0:e.endpoints)||void 0===s?void 0:s.token,e):Qt(t.data.token_endpoint,e),(null===(a=null==e?void 0:e.endpoints)||void 0===a?void 0:a.jwks)?Bt(null===(d=null==e?void 0:e.endpoints)||void 0===d?void 0:d.jwks,e):Bt(t.data.jwks_uri,e),(null===(r=null==e?void 0:e.endpoints)||void 0===r?void 0:r.logout)?jt(null===(u=null==e?void 0:e.endpoints)||void 0===u?void 0:u.logout,e):jt(t.data.end_session_endpoint,e),(null===(Z=null==e?void 0:e.endpoints)||void 0===Z?void 0:Z.revoke)?Et(null===(b=null==e?void 0:e.endpoints)||void 0===b?void 0:b.revoke,e):Et(t.data.token_endpoint.substring(0,t.data.token_endpoint.lastIndexOf("token"))+"revoke",e),_t(t.data.issuer,e),qt(e),(null===(h=null==e?void 0:e.endpoints)||void 0===h?void 0:h.oidcSessionIFrame)?At(null===(p=null==e?void 0:e.endpoints)||void 0===p?void 0:p.oidcSessionIFrame,e):At(t.data.check_session_iframe,e),Ot(e.signInRedirectURL,e),Dt(e.signOutRedirectURL,e),Mt(e),Promise.resolve("Initialized OpenID Provider configuration from: "+n+l.wellKnown))})).catch((()=>{var t,i,o,c,s,a,d;return wt(e.serverOrigin+((null===(t=null==e?void 0:e.endpoints)||void 0===t?void 0:t.authorize)||l.authorize),e),Qt(e.serverOrigin+((null===(i=null==e?void 0:e.endpoints)||void 0===i?void 0:i.token)||l.token),e),Et(e.serverOrigin+((null===(o=null==e?void 0:e.endpoints)||void 0===o?void 0:o.revoke)||l.revoke),e),jt(e.serverOrigin+((null===(c=null==e?void 0:e.endpoints)||void 0===c?void 0:c.logout)||l.logout),e),Bt(n+((null===(s=null==e?void 0:e.endpoints)||void 0===s?void 0:s.jwks)||l.jwks),e),_t(e.serverOrigin+((null===(a=null==e?void 0:e.endpoints)||void 0===a?void 0:a.token)||l.token),e),qt(e),At(e.serverOrigin+((null===(d=null==e?void 0:e.endpoints)||void 0===d?void 0:d.oidcSessionIFrame)||l.oidcSessionIFrame),e),Ot(e.signInRedirectURL,e),Dt(e.signOutRedirectURL,e),Mt(e),Promise.resolve(new Error("Initialized OpenID Provider configuration from default configuration.Because failed to access wellknown endpoint: "+n+l.wellKnown))}))},el=t=>{t.storage!==e.Storage.WebWorker?(Lt(i,t),Lt(n,t),Lt(c,t),Lt(s,t),Lt(o,t),Lt(a,t),Lt(N,t),Lt(W,t),Lt(d,t),Lt(r,t),Lt(u,t),Lt(Z,t)):t.session.clear()},tl=e=>({authorize:ll(e),jwks:sl(e),logout:cl(e),oidcSessionIFrame:ol(e),revoke:nl(e),token:il(e),wellKnown:l.wellKnown}),ll=e=>Ht(i,e),il=e=>Ht(n,e),nl=e=>Ht(o,e),ol=e=>Ht(Z,e),cl=e=>Ht(c,e),sl=e=>Ht(s,e),al=e=>Ht(N,e),dl=e=>Ht(W,e),rl=t=>(t=>t.storage!==e.Storage.WebWorker?Ht(a,t)&&"true"===Ht(a,t):t.session.get(a)&&"true"===t.session.get(a))(t)&&!!dl(t)&&dl(t)===t.clientID;function ul(t){var l;return t.storage===e.Storage.SessionStorage&&0===sessionStorage.length||t.storage===e.Storage.LocalStorage&&0===localStorage.length||$(t)&&0===(null===(l=null==t?void 0:t.session)||void 0===l?void 0:l.size)?Promise.reject(new Error("No login sessions.")):function(e){const t=cl(e);if(!t||0===t.trim().length)return Promise.reject(new Error("No logout endpoint found in the session."));const l=Ht(X,e);if(!l||0===l.trim().length)return Promise.reject(new Error("Invalid id_token found in the session."));const i=Ht(u,e);if(!i||0===i.trim().length)return Promise.reject(new Error("No callback URL found in the session."));Ft(e),el(e);const n=`${t}?id_token_hint=${l}&post_logout_redirect_uri=${i}&state=logout_success`;return $(e)?Promise.resolve(n):(window.location.href=n,Promise.resolve(!0))}(t)}const Zl=(()=>{let e,t,l;const i=new Map,n=()=>!!i.get(b),o=()=>!!i.get(b),c=t=>Jt(e,t).then((t=>{if(t.type===T){const l=cl(e);if(!l||0===l.trim().length)return Promise.reject(new Error("No logout endpoint found in the session."));const n=Ht(X,e);if(!n||0===n.trim().length)return Promise.reject(new Error("Invalid id_token found in the session."));const o=Ht(u,e);if(!o||0===o.trim().length)return Promise.reject(new Error("No callback URL found in the session."));const c=`${l}?id_token_hint=${n}&post_logout_redirect_uri=${o}`;return Promise.resolve({data:{allowedScopes:i.get(V),displayName:i.get(f),email:i.get(U),logoutUrl:c,sessionState:i.get(g),tenantDomain:i.get(k),username:i.get(v)},type:t.type})}return Promise.resolve(t)})).catch((e=>Promise.reject(e))),s=()=>Kt(e,i.get(b)),a=()=>ul(e),d=()=>kt(e,i.get(b)).then((()=>(Ft(e),el(e),Promise.resolve(!0)))).catch((e=>Promise.reject(e))),r=(e,t,l)=>{e&&i.set(G,e),t&&i.set(g,t),i.set(y,l)},Z=l=>{let i=!1;return e.baseUrls.forEach((e=>{var t;(null===(t=null==l?void 0:l.url)||void 0===t?void 0:t.startsWith(e))&&(i=!0)})),i?t.request(l).then((e=>Promise.resolve(e))).catch((e=>{var i;return 401===(null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.status)?s().then((()=>t(l).then((e=>Promise.resolve(e))).catch((e=>Promise.reject(e))))).catch((()=>Promise.reject("An error occurred while refreshing the access token. The access token is no more valid and re-authentication is required."))):Promise.reject(e)})):Promise.reject("The provided URL is illegal.")},m=l=>{let i=!1;e.baseUrls.forEach((e=>{l.every((t=>t.url.startsWith(e)))&&(i=!0)}));const n=l.map((e=>t.request(e)));return i?ze.all(n).then((e=>Promise.resolve(e))).catch((e=>{var t;return 401===(null===(t=null==e?void 0:e.response)||void 0===t?void 0:t.status)?s().then((()=>ze.all(n).then((e=>Promise.resolve(e))).catch((e=>Promise.reject(e))))).catch((()=>Promise.reject("An error occurred while refreshing the access token. The access token is no more valid and re-authentication is required."))):Promise.reject(e)})):Promise.reject("The provided URL is illegal.")},h=t=>vt(t,e),p=()=>Ut(e),W=()=>Promise.resolve(tl(e)),S=()=>ft(e);return{getInstance:u=>l||(l=function(l){var u,X,y,I,V,Y;return e=Object.assign({},l),i.clear(),e.session=i,e.authorizationCode&&i.set(G,e.authorizationCode),e.sessionState&&i.set(g,e.sessionState),t=Pe.getInstance(),t.init(!0,(e=>{var t,n;e.headers=Object.assign(Object.assign({},e.headers),{Authorization:`Bearer ${null==i?void 0:i.get(b)}`}),(null===(t=l.httpClient)||void 0===t?void 0:t.requestStartCallback)&&(null===(n=l.httpClient)||void 0===n||n.requestStartCallback())}),null!==(X=null===(u=l.httpClient)||void 0===u?void 0:u.requestSuccessCallback)&&void 0!==X?X:null,null!==(I=null===(y=l.httpClient)||void 0===y?void 0:y.requestErrorCallback)&&void 0!==I?I:null,null!==(Y=null===(V=l.httpClient)||void 0===V?void 0:V.requestFinishCallback)&&void 0!==Y?Y:null),{customGrant:h,doesTokenExist:o,endUserSession:d,getDecodedIDToken:S,getServiceEndpoints:W,getUserInfo:p,httpRequest:Z,httpRequestAll:m,isSignedIn:n,refreshAccessToken:s,setAuthCode:r,signIn:c,signOut:a}}(u),l)}})(),ml=self;let bl;ml.onmessage=({data:e,ports:t})=>{var l,i,n,o;const c=t[0];switch(e.type){case C:try{const t=Object.assign({},e.data);t.httpClient=Object.assign(Object.assign({},t.httpClient),{requestErrorCallback:Wl,requestFinishCallback:Gl,requestStartCallback:hl,requestSuccessCallback:pl}),bl=Zl.getInstance(t),c.postMessage(yt())}catch(e){c.postMessage(It(e))}break;case L:bl?(((null===(l=null==e?void 0:e.data)||void 0===l?void 0:l.code)||(null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.pkce))&&bl.setAuthCode(e.data.code,null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.sessionState,null===(o=null==e?void 0:e.data)||void 0===o?void 0:o.pkce),bl.signIn("string"==typeof(null==e?void 0:e.data)&&(null==e?void 0:e.data)).then((e=>{e.type===T?c.postMessage(yt({data:e.data,type:T})):c.postMessage(yt({code:e.code,pkce:e.pkce,type:H}))})).catch((e=>{c.postMessage(It(e))}))):c.postMessage(It("Worker has not been initiated."));break;case F:if(!bl){c.postMessage(It("Worker has not been initiated."));break}bl.isSignedIn()?bl.httpRequest(e.data).then((e=>{c.postMessage(yt(e))})).catch((e=>{c.postMessage(It(e))})):c.postMessage(It("You have not signed in yet."));break;case x:if(!bl){c.postMessage(It("Worker has not been initiated."));break}bl.isSignedIn()?bl.httpRequestAll(e.data).then((e=>{c.postMessage(yt(e))})).catch((e=>{c.postMessage(It(e))})):c.postMessage(It("You have not signed in yet."));break;case"logout":if(!bl){c.postMessage(It("Worker has not been initiated."));break}bl.isSignedIn()?bl.signOut().then((e=>{e?c.postMessage(yt(e)):c.postMessage(It("Received no response"))})).catch((e=>{c.postMessage(It(e))})):c.postMessage(It("You have not signed in yet."));break;case z:if(!bl){c.postMessage(It("Worker has not been initiated."));break}if(!bl.isSignedIn()&&e.data.signInRequired){c.postMessage(It("You have not signed in yet."));break}bl.customGrant(e.data).then((e=>{c.postMessage(yt(e))})).catch((e=>{c.postMessage(It(e))}));break;case P:if(!bl){c.postMessage(It("Worker has not been initiated."));break}if(!bl.isSignedIn()&&e.data.signInRequired){c.postMessage(It("You have not signed in yet."));break}bl.endUserSession().then((e=>{c.postMessage(yt(e))})).catch((e=>{c.postMessage(It(e))}));break;case E:if(!bl){c.postMessage(It("Worker has not been initiated."));break}bl.getServiceEndpoints().then((e=>{c.postMessage(yt(e))})).catch((e=>{c.postMessage(It(e))}));break;case M:if(!bl){c.postMessage(It("Worker has not been initiated."));break}if(!bl.isSignedIn()&&e.data.signInRequired){c.postMessage(It("You have not signed in yet."));break}try{c.postMessage(yt(bl.getUserInfo()))}catch(e){c.postMessage(It(e))}break;case O:if(!bl){c.postMessage(It("Worker has not been initiated."));break}if(!bl.isSignedIn()&&e.data.signInRequired){c.postMessage(It("You have not signed in yet."));break}try{c.postMessage(yt(bl.getDecodedIDToken()))}catch(e){c.postMessage(It(e))}break;default:null==c||c.postMessage(It(`Unknown message type ${null==e?void 0:e.type}`))}};const hl=()=>{ml.postMessage({type:w})},pl=e=>{ml.postMessage({data:JSON.stringify(null!=e?e:""),type:Q})},Gl=()=>{ml.postMessage({type:B})},Wl=e=>{const t=Object.assign({},e);delete t.toJSON,ml.postMessage({data:JSON.stringify(null!=t?t:""),type:j})};function Xl(e,t,l){var i=void 0===t?null:t,n=function(e,t){var l=atob(e);if(t){for(var i=new Uint8Array(l.length),n=0,o=l.length;n<o;++n)i[n]=l.charCodeAt(n);return String.fromCharCode.apply(null,new Uint16Array(i.buffer))}return l}(e,void 0!==l&&l),o=n.indexOf("\n",10)+1,c=n.substring(o)+(i?"//# sourceMappingURL="+i:""),s=new Blob([c],{type:"application/javascript"});return URL.createObjectURL(s)}var Sl,yl,Il,Vl,gl=(Sl="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwp2YXIgd29ya2VyX2NvZGU9ZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7dmFyIGU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZnVuY3Rpb24oKXtmb3IodmFyIG49bmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGgpLHI9MDtyPG4ubGVuZ3RoO3IrKyluW3JdPWFyZ3VtZW50c1tyXTtyZXR1cm4gZS5hcHBseSh0LG4pfX0sdD1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO2Z1bmN0aW9uIG4oZSl7cmV0dXJuIltvYmplY3QgQXJyYXldIj09PXQuY2FsbChlKX1mdW5jdGlvbiByKGUpe3JldHVybiB2b2lkIDA9PT1lfWZ1bmN0aW9uIG8oZSl7cmV0dXJuIG51bGwhPT1lJiYib2JqZWN0Ij09dHlwZW9mIGV9ZnVuY3Rpb24gcyhlKXtpZigiW29iamVjdCBPYmplY3RdIiE9PXQuY2FsbChlKSlyZXR1cm4hMTt2YXIgbj1PYmplY3QuZ2V0UHJvdG90eXBlT2YoZSk7cmV0dXJuIG51bGw9PT1ufHxuPT09T2JqZWN0LnByb3RvdHlwZX1mdW5jdGlvbiBpKGUpe3JldHVybiJbb2JqZWN0IEZ1bmN0aW9uXSI9PT10LmNhbGwoZSl9ZnVuY3Rpb24gYShlLHQpe2lmKG51bGwhPWUpaWYoIm9iamVjdCIhPXR5cGVvZiBlJiYoZT1bZV0pLG4oZSkpZm9yKHZhciByPTAsbz1lLmxlbmd0aDtyPG87cisrKXQuY2FsbChudWxsLGVbcl0scixlKTtlbHNlIGZvcih2YXIgcyBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHMpJiZ0LmNhbGwobnVsbCxlW3NdLHMsZSl9dmFyIGM9e2lzQXJyYXk6bixpc0FycmF5QnVmZmVyOmZ1bmN0aW9uKGUpe3JldHVybiJbb2JqZWN0IEFycmF5QnVmZmVyXSI9PT10LmNhbGwoZSl9LGlzQnVmZmVyOmZ1bmN0aW9uKGUpe3JldHVybiBudWxsIT09ZSYmIXIoZSkmJm51bGwhPT1lLmNvbnN0cnVjdG9yJiYhcihlLmNvbnN0cnVjdG9yKSYmImZ1bmN0aW9uIj09dHlwZW9mIGUuY29uc3RydWN0b3IuaXNCdWZmZXImJmUuY29uc3RydWN0b3IuaXNCdWZmZXIoZSl9LGlzRm9ybURhdGE6ZnVuY3Rpb24oZSl7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiBGb3JtRGF0YSYmZSBpbnN0YW5jZW9mIEZvcm1EYXRhfSxpc0FycmF5QnVmZmVyVmlldzpmdW5jdGlvbihlKXtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIEFycmF5QnVmZmVyJiZBcnJheUJ1ZmZlci5pc1ZpZXc/QXJyYXlCdWZmZXIuaXNWaWV3KGUpOmUmJmUuYnVmZmVyJiZlLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyfSxpc1N0cmluZzpmdW5jdGlvbihlKXtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIGV9LGlzTnVtYmVyOmZ1bmN0aW9uKGUpe3JldHVybiJudW1iZXIiPT10eXBlb2YgZX0saXNPYmplY3Q6byxpc1BsYWluT2JqZWN0OnMsaXNVbmRlZmluZWQ6cixpc0RhdGU6ZnVuY3Rpb24oZSl7cmV0dXJuIltvYmplY3QgRGF0ZV0iPT09dC5jYWxsKGUpfSxpc0ZpbGU6ZnVuY3Rpb24oZSl7cmV0dXJuIltvYmplY3QgRmlsZV0iPT09dC5jYWxsKGUpfSxpc0Jsb2I6ZnVuY3Rpb24oZSl7cmV0dXJuIltvYmplY3QgQmxvYl0iPT09dC5jYWxsKGUpfSxpc0Z1bmN0aW9uOmksaXNTdHJlYW06ZnVuY3Rpb24oZSl7cmV0dXJuIG8oZSkmJmkoZS5waXBlKX0saXNVUkxTZWFyY2hQYXJhbXM6ZnVuY3Rpb24oZSl7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiBVUkxTZWFyY2hQYXJhbXMmJmUgaW5zdGFuY2VvZiBVUkxTZWFyY2hQYXJhbXN9LGlzU3RhbmRhcmRCcm93c2VyRW52OmZ1bmN0aW9uKCl7cmV0dXJuKCJ1bmRlZmluZWQiPT10eXBlb2YgbmF2aWdhdG9yfHwiUmVhY3ROYXRpdmUiIT09bmF2aWdhdG9yLnByb2R1Y3QmJiJOYXRpdmVTY3JpcHQiIT09bmF2aWdhdG9yLnByb2R1Y3QmJiJOUyIhPT1uYXZpZ2F0b3IucHJvZHVjdCkmJigidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyYmInVuZGVmaW5lZCIhPXR5cGVvZiBkb2N1bWVudCl9LGZvckVhY2g6YSxtZXJnZTpmdW5jdGlvbiBlKCl7dmFyIHQ9e307ZnVuY3Rpb24gcihyLG8pe3ModFtvXSkmJnMocik/dFtvXT1lKHRbb10scik6cyhyKT90W29dPWUoe30scik6bihyKT90W29dPXIuc2xpY2UoKTp0W29dPXJ9Zm9yKHZhciBvPTAsaT1hcmd1bWVudHMubGVuZ3RoO288aTtvKyspYShhcmd1bWVudHNbb10scik7cmV0dXJuIHR9LGV4dGVuZDpmdW5jdGlvbih0LG4scil7cmV0dXJuIGEobiwoZnVuY3Rpb24obixvKXt0W29dPXImJiJmdW5jdGlvbiI9PXR5cGVvZiBuP2UobixyKTpufSkpLHR9LHRyaW06ZnVuY3Rpb24oZSl7cmV0dXJuIGUucmVwbGFjZSgvXlxzKi8sIiIpLnJlcGxhY2UoL1xzKiQvLCIiKX0sc3RyaXBCT006ZnVuY3Rpb24oZSl7cmV0dXJuIDY1Mjc5PT09ZS5jaGFyQ29kZUF0KDApJiYoZT1lLnNsaWNlKDEpKSxlfX07ZnVuY3Rpb24gdShlKXtyZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGUpLnJlcGxhY2UoLyUzQS9naSwiOiIpLnJlcGxhY2UoLyUyNC9nLCIkIikucmVwbGFjZSgvJTJDL2dpLCIsIikucmVwbGFjZSgvJTIwL2csIisiKS5yZXBsYWNlKC8lNUIvZ2ksIlsiKS5yZXBsYWNlKC8lNUQvZ2ksIl0iKX12YXIgbD1mdW5jdGlvbihlLHQsbil7aWYoIXQpcmV0dXJuIGU7dmFyIHI7aWYobilyPW4odCk7ZWxzZSBpZihjLmlzVVJMU2VhcmNoUGFyYW1zKHQpKXI9dC50b1N0cmluZygpO2Vsc2V7dmFyIG89W107Yy5mb3JFYWNoKHQsKGZ1bmN0aW9uKGUsdCl7bnVsbCE9ZSYmKGMuaXNBcnJheShlKT90Kz0iW10iOmU9W2VdLGMuZm9yRWFjaChlLChmdW5jdGlvbihlKXtjLmlzRGF0ZShlKT9lPWUudG9JU09TdHJpbmcoKTpjLmlzT2JqZWN0KGUpJiYoZT1KU09OLnN0cmluZ2lmeShlKSksby5wdXNoKHUodCkrIj0iK3UoZSkpfSkpKX0pKSxyPW8uam9pbigiJiIpfWlmKHIpe3ZhciBzPWUuaW5kZXhPZigiIyIpOy0xIT09cyYmKGU9ZS5zbGljZSgwLHMpKSxlKz0oLTE9PT1lLmluZGV4T2YoIj8iKT8iPyI6IiYiKStyfXJldHVybiBlfTtmdW5jdGlvbiBkKCl7dGhpcy5oYW5kbGVycz1bXX1kLnByb3RvdHlwZS51c2U9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5oYW5kbGVycy5wdXNoKHtmdWxmaWxsZWQ6ZSxyZWplY3RlZDp0fSksdGhpcy5oYW5kbGVycy5sZW5ndGgtMX0sZC5wcm90b3R5cGUuZWplY3Q9ZnVuY3Rpb24oZSl7dGhpcy5oYW5kbGVyc1tlXSYmKHRoaXMuaGFuZGxlcnNbZV09bnVsbCl9LGQucHJvdG90eXBlLmZvckVhY2g9ZnVuY3Rpb24oZSl7Yy5mb3JFYWNoKHRoaXMuaGFuZGxlcnMsKGZ1bmN0aW9uKHQpe251bGwhPT10JiZlKHQpfSkpfTt2YXIgcD1kLGg9ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBjLmZvckVhY2gobiwoZnVuY3Rpb24obil7ZT1uKGUsdCl9KSksZX0sZj1mdW5jdGlvbihlKXtyZXR1cm4hKCFlfHwhZS5fX0NBTkNFTF9fKX0sbT1mdW5jdGlvbihlLHQpe2MuZm9yRWFjaChlLChmdW5jdGlvbihuLHIpe3IhPT10JiZyLnRvVXBwZXJDYXNlKCk9PT10LnRvVXBwZXJDYXNlKCkmJihlW3RdPW4sZGVsZXRlIGVbcl0pfSkpfSxnPWZ1bmN0aW9uKGUsdCxuLHIsbyl7cmV0dXJuIGZ1bmN0aW9uKGUsdCxuLHIsbyl7cmV0dXJuIGUuY29uZmlnPXQsbiYmKGUuY29kZT1uKSxlLnJlcXVlc3Q9cixlLnJlc3BvbnNlPW8sZS5pc0F4aW9zRXJyb3I9ITAsZS50b0pTT049ZnVuY3Rpb24oKXtyZXR1cm57bWVzc2FnZTp0aGlzLm1lc3NhZ2UsbmFtZTp0aGlzLm5hbWUsZGVzY3JpcHRpb246dGhpcy5kZXNjcmlwdGlvbixudW1iZXI6dGhpcy5udW1iZXIsZmlsZU5hbWU6dGhpcy5maWxlTmFtZSxsaW5lTnVtYmVyOnRoaXMubGluZU51bWJlcixjb2x1bW5OdW1iZXI6dGhpcy5jb2x1bW5OdW1iZXIsc3RhY2s6dGhpcy5zdGFjayxjb25maWc6dGhpcy5jb25maWcsY29kZTp0aGlzLmNvZGV9fSxlfShuZXcgRXJyb3IoZSksdCxuLHIsbyl9LHY9Yy5pc1N0YW5kYXJkQnJvd3NlckVudigpP3t3cml0ZTpmdW5jdGlvbihlLHQsbixyLG8scyl7dmFyIGk9W107aS5wdXNoKGUrIj0iK2VuY29kZVVSSUNvbXBvbmVudCh0KSksYy5pc051bWJlcihuKSYmaS5wdXNoKCJleHBpcmVzPSIrbmV3IERhdGUobikudG9HTVRTdHJpbmcoKSksYy5pc1N0cmluZyhyKSYmaS5wdXNoKCJwYXRoPSIrciksYy5pc1N0cmluZyhvKSYmaS5wdXNoKCJkb21haW49IitvKSwhMD09PXMmJmkucHVzaCgic2VjdXJlIiksZG9jdW1lbnQuY29va2llPWkuam9pbigiOyAiKX0scmVhZDpmdW5jdGlvbihlKXt2YXIgdD1kb2N1bWVudC5jb29raWUubWF0Y2gobmV3IFJlZ0V4cCgiKF58O1xccyopKCIrZSsiKT0oW147XSopIikpO3JldHVybiB0P2RlY29kZVVSSUNvbXBvbmVudCh0WzNdKTpudWxsfSxyZW1vdmU6ZnVuY3Rpb24oZSl7dGhpcy53cml0ZShlLCIiLERhdGUubm93KCktODY0ZTUpfX06e3dyaXRlOmZ1bmN0aW9uKCl7fSxyZWFkOmZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LHJlbW92ZTpmdW5jdGlvbigpe319LHk9WyJhZ2UiLCJhdXRob3JpemF0aW9uIiwiY29udGVudC1sZW5ndGgiLCJjb250ZW50LXR5cGUiLCJldGFnIiwiZXhwaXJlcyIsImZyb20iLCJob3N0IiwiaWYtbW9kaWZpZWQtc2luY2UiLCJpZi11bm1vZGlmaWVkLXNpbmNlIiwibGFzdC1tb2RpZmllZCIsImxvY2F0aW9uIiwibWF4LWZvcndhcmRzIiwicHJveHktYXV0aG9yaXphdGlvbiIsInJlZmVyZXIiLCJyZXRyeS1hZnRlciIsInVzZXItYWdlbnQiXSx3PWMuaXNTdGFuZGFyZEJyb3dzZXJFbnYoKT9mdW5jdGlvbigpe3ZhciBlLHQ9Lyhtc2llfHRyaWRlbnQpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSxuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTtmdW5jdGlvbiByKGUpe3ZhciByPWU7cmV0dXJuIHQmJihuLnNldEF0dHJpYnV0ZSgiaHJlZiIscikscj1uLmhyZWYpLG4uc2V0QXR0cmlidXRlKCJocmVmIixyKSx7aHJlZjpuLmhyZWYscHJvdG9jb2w6bi5wcm90b2NvbD9uLnByb3RvY29sLnJlcGxhY2UoLzokLywiIik6IiIsaG9zdDpuLmhvc3Qsc2VhcmNoOm4uc2VhcmNoP24uc2VhcmNoLnJlcGxhY2UoL15cPy8sIiIpOiIiLGhhc2g6bi5oYXNoP24uaGFzaC5yZXBsYWNlKC9eIy8sIiIpOiIiLGhvc3RuYW1lOm4uaG9zdG5hbWUscG9ydDpuLnBvcnQscGF0aG5hbWU6Ii8iPT09bi5wYXRobmFtZS5jaGFyQXQoMCk/bi5wYXRobmFtZToiLyIrbi5wYXRobmFtZX19cmV0dXJuIGU9cih3aW5kb3cubG9jYXRpb24uaHJlZiksZnVuY3Rpb24odCl7dmFyIG49Yy5pc1N0cmluZyh0KT9yKHQpOnQ7cmV0dXJuIG4ucHJvdG9jb2w9PT1lLnByb3RvY29sJiZuLmhvc3Q9PT1lLmhvc3R9fSgpOmZ1bmN0aW9uKCl7cmV0dXJuITB9LGs9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbih0LG4pe3ZhciByPWUuZGF0YSxvPWUuaGVhZGVycztjLmlzRm9ybURhdGEocikmJmRlbGV0ZSBvWyJDb250ZW50LVR5cGUiXTt2YXIgcz1uZXcgWE1MSHR0cFJlcXVlc3Q7aWYoZS5hdXRoKXt2YXIgaT1lLmF1dGgudXNlcm5hbWV8fCIiLGE9ZS5hdXRoLnBhc3N3b3JkP3VuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChlLmF1dGgucGFzc3dvcmQpKToiIjtvLkF1dGhvcml6YXRpb249IkJhc2ljICIrYnRvYShpKyI6IithKX12YXIgdSxkLHA9KHU9ZS5iYXNlVVJMLGQ9ZS51cmwsdSYmIS9eKFthLXpdW2EtelxkXCtcLVwuXSo6KT9cL1wvL2kudGVzdChkKT9mdW5jdGlvbihlLHQpe3JldHVybiB0P2UucmVwbGFjZSgvXC8rJC8sIiIpKyIvIit0LnJlcGxhY2UoL15cLysvLCIiKTplfSh1LGQpOmQpO2lmKHMub3BlbihlLm1ldGhvZC50b1VwcGVyQ2FzZSgpLGwocCxlLnBhcmFtcyxlLnBhcmFtc1NlcmlhbGl6ZXIpLCEwKSxzLnRpbWVvdXQ9ZS50aW1lb3V0LHMub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7aWYocyYmND09PXMucmVhZHlTdGF0ZSYmKDAhPT1zLnN0YXR1c3x8cy5yZXNwb25zZVVSTCYmMD09PXMucmVzcG9uc2VVUkwuaW5kZXhPZigiZmlsZToiKSkpe3ZhciByLG8saSxhLHUsbD0iZ2V0QWxsUmVzcG9uc2VIZWFkZXJzImluIHM/KHI9cy5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSx1PXt9LHI/KGMuZm9yRWFjaChyLnNwbGl0KCJcbiIpLChmdW5jdGlvbihlKXtpZihhPWUuaW5kZXhPZigiOiIpLG89Yy50cmltKGUuc3Vic3RyKDAsYSkpLnRvTG93ZXJDYXNlKCksaT1jLnRyaW0oZS5zdWJzdHIoYSsxKSksbyl7aWYodVtvXSYmeS5pbmRleE9mKG8pPj0wKXJldHVybjt1W29dPSJzZXQtY29va2llIj09PW8/KHVbb10/dVtvXTpbXSkuY29uY2F0KFtpXSk6dVtvXT91W29dKyIsICIraTppfX0pKSx1KTp1KTpudWxsLGQ9e2RhdGE6ZS5yZXNwb25zZVR5cGUmJiJ0ZXh0IiE9PWUucmVzcG9uc2VUeXBlP3MucmVzcG9uc2U6cy5yZXNwb25zZVRleHQsc3RhdHVzOnMuc3RhdHVzLHN0YXR1c1RleHQ6cy5zdGF0dXNUZXh0LGhlYWRlcnM6bCxjb25maWc6ZSxyZXF1ZXN0OnN9OyFmdW5jdGlvbihlLHQsbil7dmFyIHI9bi5jb25maWcudmFsaWRhdGVTdGF0dXM7bi5zdGF0dXMmJnImJiFyKG4uc3RhdHVzKT90KGcoIlJlcXVlc3QgZmFpbGVkIHdpdGggc3RhdHVzIGNvZGUgIituLnN0YXR1cyxuLmNvbmZpZyxudWxsLG4ucmVxdWVzdCxuKSk6ZShuKX0odCxuLGQpLHM9bnVsbH19LHMub25hYm9ydD1mdW5jdGlvbigpe3MmJihuKGcoIlJlcXVlc3QgYWJvcnRlZCIsZSwiRUNPTk5BQk9SVEVEIixzKSkscz1udWxsKX0scy5vbmVycm9yPWZ1bmN0aW9uKCl7bihnKCJOZXR3b3JrIEVycm9yIixlLG51bGwscykpLHM9bnVsbH0scy5vbnRpbWVvdXQ9ZnVuY3Rpb24oKXt2YXIgdD0idGltZW91dCBvZiAiK2UudGltZW91dCsibXMgZXhjZWVkZWQiO2UudGltZW91dEVycm9yTWVzc2FnZSYmKHQ9ZS50aW1lb3V0RXJyb3JNZXNzYWdlKSxuKGcodCxlLCJFQ09OTkFCT1JURUQiLHMpKSxzPW51bGx9LGMuaXNTdGFuZGFyZEJyb3dzZXJFbnYoKSl7dmFyIGg9KGUud2l0aENyZWRlbnRpYWxzfHx3KHApKSYmZS54c3JmQ29va2llTmFtZT92LnJlYWQoZS54c3JmQ29va2llTmFtZSk6dm9pZCAwO2gmJihvW2UueHNyZkhlYWRlck5hbWVdPWgpfWlmKCJzZXRSZXF1ZXN0SGVhZGVyImluIHMmJmMuZm9yRWFjaChvLChmdW5jdGlvbihlLHQpe3ZvaWQgMD09PXImJiJjb250ZW50LXR5cGUiPT09dC50b0xvd2VyQ2FzZSgpP2RlbGV0ZSBvW3RdOnMuc2V0UmVxdWVzdEhlYWRlcih0LGUpfSkpLGMuaXNVbmRlZmluZWQoZS53aXRoQ3JlZGVudGlhbHMpfHwocy53aXRoQ3JlZGVudGlhbHM9ISFlLndpdGhDcmVkZW50aWFscyksZS5yZXNwb25zZVR5cGUpdHJ5e3MucmVzcG9uc2VUeXBlPWUucmVzcG9uc2VUeXBlfWNhdGNoKHQpe2lmKCJqc29uIiE9PWUucmVzcG9uc2VUeXBlKXRocm93IHR9ImZ1bmN0aW9uIj09dHlwZW9mIGUub25Eb3dubG9hZFByb2dyZXNzJiZzLmFkZEV2ZW50TGlzdGVuZXIoInByb2dyZXNzIixlLm9uRG93bmxvYWRQcm9ncmVzcyksImZ1bmN0aW9uIj09dHlwZW9mIGUub25VcGxvYWRQcm9ncmVzcyYmcy51cGxvYWQmJnMudXBsb2FkLmFkZEV2ZW50TGlzdGVuZXIoInByb2dyZXNzIixlLm9uVXBsb2FkUHJvZ3Jlc3MpLGUuY2FuY2VsVG9rZW4mJmUuY2FuY2VsVG9rZW4ucHJvbWlzZS50aGVuKChmdW5jdGlvbihlKXtzJiYocy5hYm9ydCgpLG4oZSkscz1udWxsKX0pKSxyfHwocj1udWxsKSxzLnNlbmQocil9KSl9LFM9eyJDb250ZW50LVR5cGUiOiJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQifTtmdW5jdGlvbiBiKGUsdCl7IWMuaXNVbmRlZmluZWQoZSkmJmMuaXNVbmRlZmluZWQoZVsiQ29udGVudC1UeXBlIl0pJiYoZVsiQ29udGVudC1UeXBlIl09dCl9dmFyIF8sQT17YWRhcHRlcjooKCJ1bmRlZmluZWQiIT10eXBlb2YgWE1MSHR0cFJlcXVlc3R8fCJ1bmRlZmluZWQiIT10eXBlb2YgcHJvY2VzcyYmIltvYmplY3QgcHJvY2Vzc10iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHByb2Nlc3MpKSYmKF89ayksXyksdHJhbnNmb3JtUmVxdWVzdDpbZnVuY3Rpb24oZSx0KXtyZXR1cm4gbSh0LCJBY2NlcHQiKSxtKHQsIkNvbnRlbnQtVHlwZSIpLGMuaXNGb3JtRGF0YShlKXx8Yy5pc0FycmF5QnVmZmVyKGUpfHxjLmlzQnVmZmVyKGUpfHxjLmlzU3RyZWFtKGUpfHxjLmlzRmlsZShlKXx8Yy5pc0Jsb2IoZSk/ZTpjLmlzQXJyYXlCdWZmZXJWaWV3KGUpP2UuYnVmZmVyOmMuaXNVUkxTZWFyY2hQYXJhbXMoZSk/KGIodCwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkO2NoYXJzZXQ9dXRmLTgiKSxlLnRvU3RyaW5nKCkpOmMuaXNPYmplY3QoZSk/KGIodCwiYXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04IiksSlNPTi5zdHJpbmdpZnkoZSkpOmV9XSx0cmFuc2Zvcm1SZXNwb25zZTpbZnVuY3Rpb24oZSl7aWYoInN0cmluZyI9PXR5cGVvZiBlKXRyeXtlPUpTT04ucGFyc2UoZSl9Y2F0Y2goZSl7fXJldHVybiBlfV0sdGltZW91dDowLHhzcmZDb29raWVOYW1lOiJYU1JGLVRPS0VOIix4c3JmSGVhZGVyTmFtZToiWC1YU1JGLVRPS0VOIixtYXhDb250ZW50TGVuZ3RoOi0xLG1heEJvZHlMZW5ndGg6LTEsdmFsaWRhdGVTdGF0dXM6ZnVuY3Rpb24oZSl7cmV0dXJuIGU+PTIwMCYmZTwzMDB9fTtBLmhlYWRlcnM9e2NvbW1vbjp7QWNjZXB0OiJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoifX0sYy5mb3JFYWNoKFsiZGVsZXRlIiwiZ2V0IiwiaGVhZCJdLChmdW5jdGlvbihlKXtBLmhlYWRlcnNbZV09e319KSksYy5mb3JFYWNoKFsicG9zdCIsInB1dCIsInBhdGNoIl0sKGZ1bmN0aW9uKGUpe0EuaGVhZGVyc1tlXT1jLm1lcmdlKFMpfSkpO3ZhciBFPUE7ZnVuY3Rpb24gUChlKXtlLmNhbmNlbFRva2VuJiZlLmNhbmNlbFRva2VuLnRocm93SWZSZXF1ZXN0ZWQoKX12YXIgQz1mdW5jdGlvbihlKXtyZXR1cm4gUChlKSxlLmhlYWRlcnM9ZS5oZWFkZXJzfHx7fSxlLmRhdGE9aChlLmRhdGEsZS5oZWFkZXJzLGUudHJhbnNmb3JtUmVxdWVzdCksZS5oZWFkZXJzPWMubWVyZ2UoZS5oZWFkZXJzLmNvbW1vbnx8e30sZS5oZWFkZXJzW2UubWV0aG9kXXx8e30sZS5oZWFkZXJzKSxjLmZvckVhY2goWyJkZWxldGUiLCJnZXQiLCJoZWFkIiwicG9zdCIsInB1dCIsInBhdGNoIiwiY29tbW9uIl0sKGZ1bmN0aW9uKHQpe2RlbGV0ZSBlLmhlYWRlcnNbdF19KSksKGUuYWRhcHRlcnx8RS5hZGFwdGVyKShlKS50aGVuKChmdW5jdGlvbih0KXtyZXR1cm4gUChlKSx0LmRhdGE9aCh0LmRhdGEsdC5oZWFkZXJzLGUudHJhbnNmb3JtUmVzcG9uc2UpLHR9KSwoZnVuY3Rpb24odCl7cmV0dXJuIGYodCl8fChQKGUpLHQmJnQucmVzcG9uc2UmJih0LnJlc3BvbnNlLmRhdGE9aCh0LnJlc3BvbnNlLmRhdGEsdC5yZXNwb25zZS5oZWFkZXJzLGUudHJhbnNmb3JtUmVzcG9uc2UpKSksUHJvbWlzZS5yZWplY3QodCl9KSl9LEk9ZnVuY3Rpb24oZSx0KXt0PXR8fHt9O3ZhciBuPXt9LHI9WyJ1cmwiLCJtZXRob2QiLCJkYXRhIl0sbz1bImhlYWRlcnMiLCJhdXRoIiwicHJveHkiLCJwYXJhbXMiXSxzPVsiYmFzZVVSTCIsInRyYW5zZm9ybVJlcXVlc3QiLCJ0cmFuc2Zvcm1SZXNwb25zZSIsInBhcmFtc1NlcmlhbGl6ZXIiLCJ0aW1lb3V0IiwidGltZW91dE1lc3NhZ2UiLCJ3aXRoQ3JlZGVudGlhbHMiLCJhZGFwdGVyIiwicmVzcG9uc2VUeXBlIiwieHNyZkNvb2tpZU5hbWUiLCJ4c3JmSGVhZGVyTmFtZSIsIm9uVXBsb2FkUHJvZ3Jlc3MiLCJvbkRvd25sb2FkUHJvZ3Jlc3MiLCJkZWNvbXByZXNzIiwibWF4Q29udGVudExlbmd0aCIsIm1heEJvZHlMZW5ndGgiLCJtYXhSZWRpcmVjdHMiLCJ0cmFuc3BvcnQiLCJodHRwQWdlbnQiLCJodHRwc0FnZW50IiwiY2FuY2VsVG9rZW4iLCJzb2NrZXRQYXRoIiwicmVzcG9uc2VFbmNvZGluZyJdLGk9WyJ2YWxpZGF0ZVN0YXR1cyJdO2Z1bmN0aW9uIGEoZSx0KXtyZXR1cm4gYy5pc1BsYWluT2JqZWN0KGUpJiZjLmlzUGxhaW5PYmplY3QodCk/Yy5tZXJnZShlLHQpOmMuaXNQbGFpbk9iamVjdCh0KT9jLm1lcmdlKHt9LHQpOmMuaXNBcnJheSh0KT90LnNsaWNlKCk6dH1mdW5jdGlvbiB1KHIpe2MuaXNVbmRlZmluZWQodFtyXSk/Yy5pc1VuZGVmaW5lZChlW3JdKXx8KG5bcl09YSh2b2lkIDAsZVtyXSkpOm5bcl09YShlW3JdLHRbcl0pfWMuZm9yRWFjaChyLChmdW5jdGlvbihlKXtjLmlzVW5kZWZpbmVkKHRbZV0pfHwobltlXT1hKHZvaWQgMCx0W2VdKSl9KSksYy5mb3JFYWNoKG8sdSksYy5mb3JFYWNoKHMsKGZ1bmN0aW9uKHIpe2MuaXNVbmRlZmluZWQodFtyXSk/Yy5pc1VuZGVmaW5lZChlW3JdKXx8KG5bcl09YSh2b2lkIDAsZVtyXSkpOm5bcl09YSh2b2lkIDAsdFtyXSl9KSksYy5mb3JFYWNoKGksKGZ1bmN0aW9uKHIpe3IgaW4gdD9uW3JdPWEoZVtyXSx0W3JdKTpyIGluIGUmJihuW3JdPWEodm9pZCAwLGVbcl0pKX0pKTt2YXIgbD1yLmNvbmNhdChvKS5jb25jYXQocykuY29uY2F0KGkpLGQ9T2JqZWN0LmtleXMoZSkuY29uY2F0KE9iamVjdC5rZXlzKHQpKS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybi0xPT09bC5pbmRleE9mKGUpfSkpO3JldHVybiBjLmZvckVhY2goZCx1KSxufTtmdW5jdGlvbiBUKGUpe3RoaXMuZGVmYXVsdHM9ZSx0aGlzLmludGVyY2VwdG9ycz17cmVxdWVzdDpuZXcgcCxyZXNwb25zZTpuZXcgcH19VC5wcm90b3R5cGUucmVxdWVzdD1mdW5jdGlvbihlKXsic3RyaW5nIj09dHlwZW9mIGU/KGU9YXJndW1lbnRzWzFdfHx7fSkudXJsPWFyZ3VtZW50c1swXTplPWV8fHt9LChlPUkodGhpcy5kZWZhdWx0cyxlKSkubWV0aG9kP2UubWV0aG9kPWUubWV0aG9kLnRvTG93ZXJDYXNlKCk6dGhpcy5kZWZhdWx0cy5tZXRob2Q/ZS5tZXRob2Q9dGhpcy5kZWZhdWx0cy5tZXRob2QudG9Mb3dlckNhc2UoKTplLm1ldGhvZD0iZ2V0Ijt2YXIgdD1bQyx2b2lkIDBdLG49UHJvbWlzZS5yZXNvbHZlKGUpO2Zvcih0aGlzLmludGVyY2VwdG9ycy5yZXF1ZXN0LmZvckVhY2goKGZ1bmN0aW9uKGUpe3QudW5zaGlmdChlLmZ1bGZpbGxlZCxlLnJlamVjdGVkKX0pKSx0aGlzLmludGVyY2VwdG9ycy5yZXNwb25zZS5mb3JFYWNoKChmdW5jdGlvbihlKXt0LnB1c2goZS5mdWxmaWxsZWQsZS5yZWplY3RlZCl9KSk7dC5sZW5ndGg7KW49bi50aGVuKHQuc2hpZnQoKSx0LnNoaWZ0KCkpO3JldHVybiBufSxULnByb3RvdHlwZS5nZXRVcmk9ZnVuY3Rpb24oZSl7cmV0dXJuIGU9SSh0aGlzLmRlZmF1bHRzLGUpLGwoZS51cmwsZS5wYXJhbXMsZS5wYXJhbXNTZXJpYWxpemVyKS5yZXBsYWNlKC9eXD8vLCIiKX0sYy5mb3JFYWNoKFsiZGVsZXRlIiwiZ2V0IiwiaGVhZCIsIm9wdGlvbnMiXSwoZnVuY3Rpb24oZSl7VC5wcm90b3R5cGVbZV09ZnVuY3Rpb24odCxuKXtyZXR1cm4gdGhpcy5yZXF1ZXN0KEkobnx8e30se21ldGhvZDplLHVybDp0LGRhdGE6KG58fHt9KS5kYXRhfSkpfX0pKSxjLmZvckVhY2goWyJwb3N0IiwicHV0IiwicGF0Y2giXSwoZnVuY3Rpb24oZSl7VC5wcm90b3R5cGVbZV09ZnVuY3Rpb24odCxuLHIpe3JldHVybiB0aGlzLnJlcXVlc3QoSShyfHx7fSx7bWV0aG9kOmUsdXJsOnQsZGF0YTpufSkpfX0pKTt2YXIgaj1UO2Z1bmN0aW9uIFIoZSl7dGhpcy5tZXNzYWdlPWV9Ui5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4iQ2FuY2VsIisodGhpcy5tZXNzYWdlPyI6ICIrdGhpcy5tZXNzYWdlOiIiKX0sUi5wcm90b3R5cGUuX19DQU5DRUxfXz0hMDt2YXIgeD1SO2Z1bmN0aW9uIE8oZSl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIGUpdGhyb3cgbmV3IFR5cGVFcnJvcigiZXhlY3V0b3IgbXVzdCBiZSBhIGZ1bmN0aW9uLiIpO3ZhciB0O3RoaXMucHJvbWlzZT1uZXcgUHJvbWlzZSgoZnVuY3Rpb24oZSl7dD1lfSkpO3ZhciBuPXRoaXM7ZSgoZnVuY3Rpb24oZSl7bi5yZWFzb258fChuLnJlYXNvbj1uZXcgeChlKSx0KG4ucmVhc29uKSl9KSl9Ty5wcm90b3R5cGUudGhyb3dJZlJlcXVlc3RlZD1mdW5jdGlvbigpe2lmKHRoaXMucmVhc29uKXRocm93IHRoaXMucmVhc29ufSxPLnNvdXJjZT1mdW5jdGlvbigpe3ZhciBlO3JldHVybnt0b2tlbjpuZXcgTygoZnVuY3Rpb24odCl7ZT10fSkpLGNhbmNlbDplfX07dmFyIEg9TztmdW5jdGlvbiBxKHQpe3ZhciBuPW5ldyBqKHQpLHI9ZShqLnByb3RvdHlwZS5yZXF1ZXN0LG4pO3JldHVybiBjLmV4dGVuZChyLGoucHJvdG90eXBlLG4pLGMuZXh0ZW5kKHIsbikscn12YXIgTT1xKEUpO00uQXhpb3M9aixNLmNyZWF0ZT1mdW5jdGlvbihlKXtyZXR1cm4gcShJKE0uZGVmYXVsdHMsZSkpfSxNLkNhbmNlbD14LE0uQ2FuY2VsVG9rZW49SCxNLmlzQ2FuY2VsPWYsTS5hbGw9ZnVuY3Rpb24oZSl7cmV0dXJuIFByb21pc2UuYWxsKGUpfSxNLnNwcmVhZD1mdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuIGUuYXBwbHkobnVsbCx0KX19O3ZhciBVPU0sVz1NO1UuZGVmYXVsdD1XO3ZhciBCPVU7Y29uc3QgRD17YXV0aG9yaXplOiIvb2F1dGgyL2F1dGhvcml6ZSIsandrczoiL29hdXRoMi9qd2tzIixsb2dvdXQ6Ii9vaWRjL2xvZ291dCIsb2lkY1Nlc3Npb25JRnJhbWU6Ii9vaWRjL2NoZWNrc2Vzc2lvbiIscmV2b2tlOiIvb2F1dGgyL3Jldm9rZSIsdG9rZW46Ii9vYXV0aDIvdG9rZW4iLHdlbGxLbm93bjoiL29hdXRoMi90b2tlbi8ud2VsbC1rbm93bi9vcGVuaWQtY29uZmlndXJhdGlvbiJ9LE49ImF1dGhvcml6YXRpb25fZW5kcG9pbnQiLEw9InRva2VuX2VuZHBvaW50IixLPSJyZXZva2VfdG9rZW5fZW5kcG9pbnQiLEo9ImVuZF9zZXNzaW9uX2VuZHBvaW50IixGPSJqd2tzX3VyaSIsJD0ib3BfY29uZmlnX2luaXRpYXRlZCIsej0ic2lnbl9pbl9yZWRpcmVjdF91cmwiLEc9InNpZ25fb3V0X3JlZGlyZWN0X3VybCIsVj0ib2lkY19zZXNzaW9uX2lmcmFtZV9lbmRwb2ludCIsWT0iYWNjZXNzX3Rva2VuIixYPSJleHBpcmVzX2luIixRPSJpc3N1ZWRfYXQiLFo9ImNvZGUiLGVlPSJjbGllbnRfaWQiLHRlPSJpZF90b2tlbiIsbmU9Im9wZW5pZCIscmU9InBrY2VfY29kZV92ZXJpZmllciIsb2U9InJlZnJlc2hfdG9rZW4iLHNlPSJzY29wZSIsaWU9InNlc3Npb25fc3RhdGUiLGFlPSJ0b2tlbl90eXBlIixjZT0icmVxdWVzdF9wYXJhbXMiLHVlPSJ0ZW5hbnRfZG9tYWluIixsZT0iaXNzdWVyIixkZT0icmVmcmVzaF90b2tlbl90aW1lciIscGU9InVzZXJuYW1lIixoZT0iZW1haWwiLGZlPSJkaXNwbGF5X25hbWUiLG1lPSJzaWduZWQtaW4iLGdlPSJhdXRoLXJlcXVpcmVkIjt2YXIgdmUseWUsd2Usa2U7IWZ1bmN0aW9uKGUpe2UuTG9jYWxTdG9yYWdlPSJsb2NhbFN0b3JhZ2UiLGUuU2Vzc2lvblN0b3JhZ2U9InNlc3Npb25TdG9yYWdlIixlLldlYldvcmtlcj0id2ViV29ya2VyIn0odmV8fCh2ZT17fSkpLGZ1bmN0aW9uKGUpe2UuU2lnbkluPSJzaWduLWluIixlLlNpZ25PdXQ9InNpZ24tb3V0IixlLkluaXRpYWxpemU9ImluaXRpYWxpemUiLGUuSHR0cFJlcXVlc3RTdGFydD0iaHR0cC1yZXF1ZXN0LXN0YXJ0IixlLkh0dHBSZXF1ZXN0RmluaXNoPSJodHRwLXJlcXVlc3QtZmluaXNoIixlLkh0dHBSZXF1ZXN0RXJyb3I9Imh0dHAtcmVxdWVzdC1lcnJvciIsZS5IdHRwUmVxdWVzdFN1Y2Nlc3M9Imh0dHAtcmVxdWVzdC1zdWNjZXNzIixlLkVuZFVzZXJTZXNzaW9uPSJlbmQtdXNlci1zZXNzaW9uIixlLkN1c3RvbUdyYW50PSJjdXN0b20tZ3JhbnQifSh5ZXx8KHllPXt9KSksZnVuY3Rpb24oZSl7ZS5mb3JtUG9zdD0iZm9ybV9wb3N0IixlLnF1ZXJ5PSJxdWVyeSJ9KHdlfHwod2U9e30pKTtsZXQgU2U9a2U9Y2xhc3N7Y29uc3RydWN0b3IoKXt0aGlzLmluaXQ9dGhpcy5pbml0LmJpbmQodGhpcyl9c3RhdGljIGdldEluc3RhbmNlKCl7cmV0dXJuIHRoaXMuYXhpb3NJbnN0YW5jZXx8KHRoaXMuYXhpb3NJbnN0YW5jZT1CLmNyZWF0ZSh7d2l0aENyZWRlbnRpYWxzOiEwfSksdGhpcy5jbGllbnRJbnN0YW5jZXx8KHRoaXMuY2xpZW50SW5zdGFuY2U9bmV3IGtlKSx0aGlzLmF4aW9zSW5zdGFuY2UuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKChlPT50aGlzLmNsaWVudEluc3RhbmNlLnJlcXVlc3RIYW5kbGVyKGUpKSksdGhpcy5heGlvc0luc3RhbmNlLmludGVyY2VwdG9ycy5yZXNwb25zZS51c2UoKGU9PnRoaXMuY2xpZW50SW5zdGFuY2Uuc3VjY2Vzc0hhbmRsZXIoZSkpLChlPT50aGlzLmNsaWVudEluc3RhbmNlLmVycm9ySGFuZGxlcihlKSkpLHRoaXMuYXhpb3NJbnN0YW5jZS5hbGw9Qi5hbGwsdGhpcy5heGlvc0luc3RhbmNlLnNwcmVhZD1CLnNwcmVhZCx0aGlzLmF4aW9zSW5zdGFuY2UuaW5pdD10aGlzLmNsaWVudEluc3RhbmNlLmluaXQsdGhpcy5heGlvc0luc3RhbmNlLmVuYWJsZUhhbmRsZXI9dGhpcy5jbGllbnRJbnN0YW5jZS5lbmFibGVIYW5kbGVyLHRoaXMuYXhpb3NJbnN0YW5jZS5kaXNhYmxlSGFuZGxlcj10aGlzLmNsaWVudEluc3RhbmNlLmRpc2FibGVIYW5kbGVyLHRoaXMuYXhpb3NJbnN0YW5jZS5kaXNhYmxlSGFuZGxlcldpdGhUaW1lb3V0PXRoaXMuY2xpZW50SW5zdGFuY2UuZGlzYWJsZUhhbmRsZXJXaXRoVGltZW91dCksdGhpcy5heGlvc0luc3RhbmNlfXJlcXVlc3RIYW5kbGVyKGUpe3JldHVybiBrZS5pc0hhbmRsZXJFbmFibGVkJiZ0aGlzLnJlcXVlc3RTdGFydENhbGxiYWNrJiYiZnVuY3Rpb24iPT10eXBlb2YgdGhpcy5yZXF1ZXN0U3RhcnRDYWxsYmFjayYmdGhpcy5yZXF1ZXN0U3RhcnRDYWxsYmFjayhlKSxlfWVycm9ySGFuZGxlcihlKXt0aHJvdyBrZS5pc0hhbmRsZXJFbmFibGVkJiYodGhpcy5yZXF1ZXN0RXJyb3JDYWxsYmFjayYmImZ1bmN0aW9uIj09dHlwZW9mIHRoaXMucmVxdWVzdEVycm9yQ2FsbGJhY2smJnRoaXMucmVxdWVzdEVycm9yQ2FsbGJhY2soZSksdGhpcy5yZXF1ZXN0RmluaXNoQ2FsbGJhY2smJiJmdW5jdGlvbiI9PXR5cGVvZiB0aGlzLnJlcXVlc3RGaW5pc2hDYWxsYmFjayYmdGhpcy5yZXF1ZXN0RmluaXNoQ2FsbGJhY2soKSksZX1zdWNjZXNzSGFuZGxlcihlKXtyZXR1cm4ga2UuaXNIYW5kbGVyRW5hYmxlZCYmKHRoaXMucmVxdWVzdFN1Y2Nlc3NDYWxsYmFjayYmImZ1bmN0aW9uIj09dHlwZW9mIHRoaXMucmVxdWVzdFN1Y2Nlc3NDYWxsYmFjayYmdGhpcy5yZXF1ZXN0U3VjY2Vzc0NhbGxiYWNrKGUpLHRoaXMucmVxdWVzdEZpbmlzaENhbGxiYWNrJiYiZnVuY3Rpb24iPT10eXBlb2YgdGhpcy5yZXF1ZXN0RmluaXNoQ2FsbGJhY2smJnRoaXMucmVxdWVzdEZpbmlzaENhbGxiYWNrKCkpLGV9aW5pdChlPSEwLHQsbixyLG8pe2tlLmlzSGFuZGxlckVuYWJsZWQ9ZSx0aGlzLnJlcXVlc3RTdGFydENhbGxiYWNrJiZ0aGlzLnJlcXVlc3RTdWNjZXNzQ2FsbGJhY2smJnRoaXMucmVxdWVzdEVycm9yQ2FsbGJhY2smJnRoaXMucmVxdWVzdEZpbmlzaENhbGxiYWNrfHwodGhpcy5yZXF1ZXN0U3RhcnRDYWxsYmFja3x8KHRoaXMucmVxdWVzdFN0YXJ0Q2FsbGJhY2s9dCksdGhpcy5yZXF1ZXN0U3VjY2Vzc0NhbGxiYWNrfHwodGhpcy5yZXF1ZXN0U3VjY2Vzc0NhbGxiYWNrPW4pLHRoaXMucmVxdWVzdEVycm9yQ2FsbGJhY2t8fCh0aGlzLnJlcXVlc3RFcnJvckNhbGxiYWNrPXIpLHRoaXMucmVxdWVzdEZpbmlzaENhbGxiYWNrfHwodGhpcy5yZXF1ZXN0RmluaXNoQ2FsbGJhY2s9bykpfWVuYWJsZUhhbmRsZXIoKXtrZS5pc0hhbmRsZXJFbmFibGVkPSEwfWRpc2FibGVIYW5kbGVyKCl7a2UuaXNIYW5kbGVyRW5hYmxlZD0hMX1kaXNhYmxlSGFuZGxlcldpdGhUaW1lb3V0KGU9a2UuREVGQVVMVF9IQU5ETEVSX0RJU0FCTEVfVElNRU9VVCl7a2UuaXNIYW5kbGVyRW5hYmxlZD0hMSxzZXRUaW1lb3V0KCgoKT0+e2tlLmlzSGFuZGxlckVuYWJsZWQ9ITB9KSxlKX19O1NlLkRFRkFVTFRfSEFORExFUl9ESVNBQkxFX1RJTUVPVVQ9MWUzLFNlPWtlPQovKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4KCiAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55CiAgcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLgoKICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSAogIFJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWQogIEFORCBGSVRORVNTLiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SIEJFIExJQUJMRSBGT1IgQU5ZIFNQRUNJQUwsIERJUkVDVCwKICBJTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST00KICBMT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUgogIE9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1IKICBQRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLgogICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovCmZ1bmN0aW9uKGUsdCxuLHIpe3ZhciBvLHM9YXJndW1lbnRzLmxlbmd0aCxpPXM8Mz90Om51bGw9PT1yP3I9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LG4pOnI7aWYoIm9iamVjdCI9PXR5cGVvZiBSZWZsZWN0JiYiZnVuY3Rpb24iPT10eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSlpPVJlZmxlY3QuZGVjb3JhdGUoZSx0LG4scik7ZWxzZSBmb3IodmFyIGE9ZS5sZW5ndGgtMTthPj0wO2EtLSkobz1lW2FdKSYmKGk9KHM8Mz9vKGkpOnM+Mz9vKHQsbixpKTpvKHQsbikpfHxpKTtyZXR1cm4gcz4zJiZpJiZPYmplY3QuZGVmaW5lUHJvcGVydHkodCxuLGkpLGl9KFtlPT57fV0sU2UpOyJ1bmRlZmluZWQiIT10eXBlb2YgZ2xvYmFsVGhpcz9nbG9iYWxUaGlzOiJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93P3dpbmRvdzoidW5kZWZpbmVkIiE9dHlwZW9mIGdsb2JhbD9nbG9iYWw6InVuZGVmaW5lZCIhPXR5cGVvZiBzZWxmJiZzZWxmO2Z1bmN0aW9uIGJlKGUsdCxuKXtyZXR1cm4gZShuPXtwYXRoOnQsZXhwb3J0czp7fSxyZXF1aXJlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKCJEeW5hbWljIHJlcXVpcmVzIGFyZSBub3QgY3VycmVudGx5IHN1cHBvcnRlZCBieSBAcm9sbHVwL3BsdWdpbi1jb21tb25qcyIpfShudWxsPT10JiZuLnBhdGgpfX0sbi5leHBvcnRzKSxuLmV4cG9ydHN9dmFyIF9lPWJlKChmdW5jdGlvbihlLHQpe3ZhciBuO2UuZXhwb3J0cz0obj1ufHxmdW5jdGlvbihlLHQpe3ZhciBuPU9iamVjdC5jcmVhdGV8fGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe31yZXR1cm4gZnVuY3Rpb24odCl7dmFyIG47cmV0dXJuIGUucHJvdG90eXBlPXQsbj1uZXcgZSxlLnByb3RvdHlwZT1udWxsLG59fSgpLHI9e30sbz1yLmxpYj17fSxzPW8uQmFzZT17ZXh0ZW5kOmZ1bmN0aW9uKGUpe3ZhciB0PW4odGhpcyk7cmV0dXJuIGUmJnQubWl4SW4oZSksdC5oYXNPd25Qcm9wZXJ0eSgiaW5pdCIpJiZ0aGlzLmluaXQhPT10LmluaXR8fCh0LmluaXQ9ZnVuY3Rpb24oKXt0LiRzdXBlci5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pLHQuaW5pdC5wcm90b3R5cGU9dCx0LiRzdXBlcj10aGlzLHR9LGNyZWF0ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuZXh0ZW5kKCk7cmV0dXJuIGUuaW5pdC5hcHBseShlLGFyZ3VtZW50cyksZX0saW5pdDpmdW5jdGlvbigpe30sbWl4SW46ZnVuY3Rpb24oZSl7Zm9yKHZhciB0IGluIGUpZS5oYXNPd25Qcm9wZXJ0eSh0KSYmKHRoaXNbdF09ZVt0XSk7ZS5oYXNPd25Qcm9wZXJ0eSgidG9TdHJpbmciKSYmKHRoaXMudG9TdHJpbmc9ZS50b1N0cmluZyl9LGNsb25lOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW5pdC5wcm90b3R5cGUuZXh0ZW5kKHRoaXMpfX0saT1vLldvcmRBcnJheT1zLmV4dGVuZCh7aW5pdDpmdW5jdGlvbihlLG4pe2U9dGhpcy53b3Jkcz1lfHxbXSx0aGlzLnNpZ0J5dGVzPW4hPXQ/bjo0KmUubGVuZ3RofSx0b1N0cmluZzpmdW5jdGlvbihlKXtyZXR1cm4oZXx8Yykuc3RyaW5naWZ5KHRoaXMpfSxjb25jYXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy53b3JkcyxuPWUud29yZHMscj10aGlzLnNpZ0J5dGVzLG89ZS5zaWdCeXRlcztpZih0aGlzLmNsYW1wKCksciU0KWZvcih2YXIgcz0wO3M8bztzKyspe3ZhciBpPW5bcz4+PjJdPj4+MjQtcyU0KjgmMjU1O3RbcitzPj4+Ml18PWk8PDI0LShyK3MpJTQqOH1lbHNlIGZvcihzPTA7czxvO3MrPTQpdFtyK3M+Pj4yXT1uW3M+Pj4yXTtyZXR1cm4gdGhpcy5zaWdCeXRlcys9byx0aGlzfSxjbGFtcDpmdW5jdGlvbigpe3ZhciB0PXRoaXMud29yZHMsbj10aGlzLnNpZ0J5dGVzO3Rbbj4+PjJdJj00Mjk0OTY3Mjk1PDwzMi1uJTQqOCx0Lmxlbmd0aD1lLmNlaWwobi80KX0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgZT1zLmNsb25lLmNhbGwodGhpcyk7cmV0dXJuIGUud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKSxlfSxyYW5kb206ZnVuY3Rpb24odCl7Zm9yKHZhciBuLHI9W10sbz1mdW5jdGlvbih0KXt0PXQ7dmFyIG49OTg3NjU0MzIxLHI9NDI5NDk2NzI5NTtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgbz0oKG49MzY5NjkqKDY1NTM1Jm4pKyhuPj4xNikmcik8PDE2KSsodD0xOGUzKig2NTUzNSZ0KSsodD4+MTYpJnIpJnI7cmV0dXJuIG8vPTQyOTQ5NjcyOTYsKG8rPS41KSooZS5yYW5kb20oKT4uNT8xOi0xKX19LHM9MDtzPHQ7cys9NCl7dmFyIGE9byg0Mjk0OTY3Mjk2KihufHxlLnJhbmRvbSgpKSk7bj05ODc2NTQwNzEqYSgpLHIucHVzaCg0Mjk0OTY3Mjk2KmEoKXwwKX1yZXR1cm4gbmV3IGkuaW5pdChyLHQpfX0pLGE9ci5lbmM9e30sYz1hLkhleD17c3RyaW5naWZ5OmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLndvcmRzLG49ZS5zaWdCeXRlcyxyPVtdLG89MDtvPG47bysrKXt2YXIgcz10W28+Pj4yXT4+PjI0LW8lNCo4JjI1NTtyLnB1c2goKHM+Pj40KS50b1N0cmluZygxNikpLHIucHVzaCgoMTUmcykudG9TdHJpbmcoMTYpKX1yZXR1cm4gci5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PWUubGVuZ3RoLG49W10scj0wO3I8dDtyKz0yKW5bcj4+PjNdfD1wYXJzZUludChlLnN1YnN0cihyLDIpLDE2KTw8MjQtciU4KjQ7cmV0dXJuIG5ldyBpLmluaXQobix0LzIpfX0sdT1hLkxhdGluMT17c3RyaW5naWZ5OmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLndvcmRzLG49ZS5zaWdCeXRlcyxyPVtdLG89MDtvPG47bysrKXt2YXIgcz10W28+Pj4yXT4+PjI0LW8lNCo4JjI1NTtyLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShzKSl9cmV0dXJuIHIuam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLmxlbmd0aCxuPVtdLHI9MDtyPHQ7cisrKW5bcj4+PjJdfD0oMjU1JmUuY2hhckNvZGVBdChyKSk8PDI0LXIlNCo4O3JldHVybiBuZXcgaS5pbml0KG4sdCl9fSxsPWEuVXRmOD17c3RyaW5naWZ5OmZ1bmN0aW9uKGUpe3RyeXtyZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGVzY2FwZSh1LnN0cmluZ2lmeShlKSkpfWNhdGNoKGUpe3Rocm93IG5ldyBFcnJvcigiTWFsZm9ybWVkIFVURi04IGRhdGEiKX19LHBhcnNlOmZ1bmN0aW9uKGUpe3JldHVybiB1LnBhcnNlKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChlKSkpfX0sZD1vLkJ1ZmZlcmVkQmxvY2tBbGdvcml0aG09cy5leHRlbmQoe3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fZGF0YT1uZXcgaS5pbml0LHRoaXMuX25EYXRhQnl0ZXM9MH0sX2FwcGVuZDpmdW5jdGlvbihlKXsic3RyaW5nIj09dHlwZW9mIGUmJihlPWwucGFyc2UoZSkpLHRoaXMuX2RhdGEuY29uY2F0KGUpLHRoaXMuX25EYXRhQnl0ZXMrPWUuc2lnQnl0ZXN9LF9wcm9jZXNzOmZ1bmN0aW9uKHQpe3ZhciBuPXRoaXMuX2RhdGEscj1uLndvcmRzLG89bi5zaWdCeXRlcyxzPXRoaXMuYmxvY2tTaXplLGE9by8oNCpzKSxjPShhPXQ/ZS5jZWlsKGEpOmUubWF4KCgwfGEpLXRoaXMuX21pbkJ1ZmZlclNpemUsMCkpKnMsdT1lLm1pbig0KmMsbyk7aWYoYyl7Zm9yKHZhciBsPTA7bDxjO2wrPXMpdGhpcy5fZG9Qcm9jZXNzQmxvY2socixsKTt2YXIgZD1yLnNwbGljZSgwLGMpO24uc2lnQnl0ZXMtPXV9cmV0dXJuIG5ldyBpLmluaXQoZCx1KX0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgZT1zLmNsb25lLmNhbGwodGhpcyk7cmV0dXJuIGUuX2RhdGE9dGhpcy5fZGF0YS5jbG9uZSgpLGV9LF9taW5CdWZmZXJTaXplOjB9KSxwPShvLkhhc2hlcj1kLmV4dGVuZCh7Y2ZnOnMuZXh0ZW5kKCksaW5pdDpmdW5jdGlvbihlKXt0aGlzLmNmZz10aGlzLmNmZy5leHRlbmQoZSksdGhpcy5yZXNldCgpfSxyZXNldDpmdW5jdGlvbigpe2QucmVzZXQuY2FsbCh0aGlzKSx0aGlzLl9kb1Jlc2V0KCl9LHVwZGF0ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fYXBwZW5kKGUpLHRoaXMuX3Byb2Nlc3MoKSx0aGlzfSxmaW5hbGl6ZTpmdW5jdGlvbihlKXtyZXR1cm4gZSYmdGhpcy5fYXBwZW5kKGUpLHRoaXMuX2RvRmluYWxpemUoKX0sYmxvY2tTaXplOjE2LF9jcmVhdGVIZWxwZXI6ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKHQsbil7cmV0dXJuIG5ldyBlLmluaXQobikuZmluYWxpemUodCl9fSxfY3JlYXRlSG1hY0hlbHBlcjpmdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24odCxuKXtyZXR1cm4gbmV3IHAuSE1BQy5pbml0KGUsbikuZmluYWxpemUodCl9fX0pLHIuYWxnbz17fSk7cmV0dXJuIHJ9KE1hdGgpLG4pfSkpLEFlPWJlKChmdW5jdGlvbihlLHQpe3ZhciBuO2UuZXhwb3J0cz0obj1fZSxmdW5jdGlvbigpe3ZhciBlPW4sdD1lLmxpYi5Xb3JkQXJyYXk7ZnVuY3Rpb24gcihlLG4scil7Zm9yKHZhciBvPVtdLHM9MCxpPTA7aTxuO2krKylpZihpJTQpe3ZhciBhPXJbZS5jaGFyQ29kZUF0KGktMSldPDxpJTQqMixjPXJbZS5jaGFyQ29kZUF0KGkpXT4+PjYtaSU0KjI7b1tzPj4+Ml18PShhfGMpPDwyNC1zJTQqOCxzKyt9cmV0dXJuIHQuY3JlYXRlKG8scyl9ZS5lbmMuQmFzZTY0PXtzdHJpbmdpZnk6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS53b3JkcyxuPWUuc2lnQnl0ZXMscj10aGlzLl9tYXA7ZS5jbGFtcCgpO2Zvcih2YXIgbz1bXSxzPTA7czxuO3MrPTMpZm9yKHZhciBpPSh0W3M+Pj4yXT4+PjI0LXMlNCo4JjI1NSk8PDE2fCh0W3MrMT4+PjJdPj4+MjQtKHMrMSklNCo4JjI1NSk8PDh8dFtzKzI+Pj4yXT4+PjI0LShzKzIpJTQqOCYyNTUsYT0wO2E8NCYmcysuNzUqYTxuO2ErKylvLnB1c2goci5jaGFyQXQoaT4+PjYqKDMtYSkmNjMpKTt2YXIgYz1yLmNoYXJBdCg2NCk7aWYoYylmb3IoO28ubGVuZ3RoJTQ7KW8ucHVzaChjKTtyZXR1cm4gby5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5sZW5ndGgsbj10aGlzLl9tYXAsbz10aGlzLl9yZXZlcnNlTWFwO2lmKCFvKXtvPXRoaXMuX3JldmVyc2VNYXA9W107Zm9yKHZhciBzPTA7czxuLmxlbmd0aDtzKyspb1tuLmNoYXJDb2RlQXQocyldPXN9dmFyIGk9bi5jaGFyQXQoNjQpO2lmKGkpe3ZhciBhPWUuaW5kZXhPZihpKTstMSE9PWEmJih0PWEpfXJldHVybiByKGUsdCxvKX0sX21hcDoiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0ifX0oKSxuLmVuYy5CYXNlNjQpfSkpLEVlPWJlKChmdW5jdGlvbihlLHQpe3ZhciBuO2UuZXhwb3J0cz0obj1fZSxmdW5jdGlvbigpe2lmKCJmdW5jdGlvbiI9PXR5cGVvZiBBcnJheUJ1ZmZlcil7dmFyIGU9bi5saWIuV29yZEFycmF5LHQ9ZS5pbml0OyhlLmluaXQ9ZnVuY3Rpb24oZSl7aWYoZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyJiYoZT1uZXcgVWludDhBcnJheShlKSksKGUgaW5zdGFuY2VvZiBJbnQ4QXJyYXl8fCJ1bmRlZmluZWQiIT10eXBlb2YgVWludDhDbGFtcGVkQXJyYXkmJmUgaW5zdGFuY2VvZiBVaW50OENsYW1wZWRBcnJheXx8ZSBpbnN0YW5jZW9mIEludDE2QXJyYXl8fGUgaW5zdGFuY2VvZiBVaW50MTZBcnJheXx8ZSBpbnN0YW5jZW9mIEludDMyQXJyYXl8fGUgaW5zdGFuY2VvZiBVaW50MzJBcnJheXx8ZSBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheXx8ZSBpbnN0YW5jZW9mIEZsb2F0NjRBcnJheSkmJihlPW5ldyBVaW50OEFycmF5KGUuYnVmZmVyLGUuYnl0ZU9mZnNldCxlLmJ5dGVMZW5ndGgpKSxlIGluc3RhbmNlb2YgVWludDhBcnJheSl7Zm9yKHZhciBuPWUuYnl0ZUxlbmd0aCxyPVtdLG89MDtvPG47bysrKXJbbz4+PjJdfD1lW29dPDwyNC1vJTQqODt0LmNhbGwodGhpcyxyLG4pfWVsc2UgdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9KS5wcm90b3R5cGU9ZX19KCksbi5saWIuV29yZEFycmF5KX0pKSxQZT1iZSgoZnVuY3Rpb24oZSx0KXt2YXIgbjtlLmV4cG9ydHM9KG49X2UsZnVuY3Rpb24oZSl7dmFyIHQ9bixyPXQubGliLG89ci5Xb3JkQXJyYXkscz1yLkhhc2hlcixpPXQuYWxnbyxhPVtdLGM9W107IWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXtmb3IodmFyIG49ZS5zcXJ0KHQpLHI9MjtyPD1uO3IrKylpZighKHQlcikpcmV0dXJuITE7cmV0dXJuITB9ZnVuY3Rpb24gbihlKXtyZXR1cm4gNDI5NDk2NzI5NiooZS0oMHxlKSl8MH1mb3IodmFyIHI9MixvPTA7bzw2NDspdChyKSYmKG88OCYmKGFbb109bihlLnBvdyhyLC41KSkpLGNbb109bihlLnBvdyhyLDEvMykpLG8rKykscisrfSgpO3ZhciB1PVtdLGw9aS5TSEEyNTY9cy5leHRlbmQoe19kb1Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5faGFzaD1uZXcgby5pbml0KGEuc2xpY2UoMCkpfSxfZG9Qcm9jZXNzQmxvY2s6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49dGhpcy5faGFzaC53b3JkcyxyPW5bMF0sbz1uWzFdLHM9blsyXSxpPW5bM10sYT1uWzRdLGw9bls1XSxkPW5bNl0scD1uWzddLGg9MDtoPDY0O2grKyl7aWYoaDwxNil1W2hdPTB8ZVt0K2hdO2Vsc2V7dmFyIGY9dVtoLTE1XSxtPShmPDwyNXxmPj4+NyleKGY8PDE0fGY+Pj4xOCleZj4+PjMsZz11W2gtMl0sdj0oZzw8MTV8Zz4+PjE3KV4oZzw8MTN8Zz4+PjE5KV5nPj4+MTA7dVtoXT1tK3VbaC03XSt2K3VbaC0xNl19dmFyIHk9ciZvXnImc15vJnMsdz0ocjw8MzB8cj4+PjIpXihyPDwxOXxyPj4+MTMpXihyPDwxMHxyPj4+MjIpLGs9cCsoKGE8PDI2fGE+Pj42KV4oYTw8MjF8YT4+PjExKV4oYTw8N3xhPj4+MjUpKSsoYSZsXn5hJmQpK2NbaF0rdVtoXTtwPWQsZD1sLGw9YSxhPWkra3wwLGk9cyxzPW8sbz1yLHI9aysodyt5KXwwfW5bMF09blswXStyfDAsblsxXT1uWzFdK298MCxuWzJdPW5bMl0rc3wwLG5bM109blszXStpfDAsbls0XT1uWzRdK2F8MCxuWzVdPW5bNV0rbHwwLG5bNl09bls2XStkfDAsbls3XT1uWzddK3B8MH0sX2RvRmluYWxpemU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9kYXRhLG49dC53b3JkcyxyPTgqdGhpcy5fbkRhdGFCeXRlcyxvPTgqdC5zaWdCeXRlcztyZXR1cm4gbltvPj4+NV18PTEyODw8MjQtbyUzMixuWzE0KyhvKzY0Pj4+OTw8NCldPWUuZmxvb3Ioci80Mjk0OTY3Mjk2KSxuWzE1KyhvKzY0Pj4+OTw8NCldPXIsdC5zaWdCeXRlcz00Km4ubGVuZ3RoLHRoaXMuX3Byb2Nlc3MoKSx0aGlzLl9oYXNofSxjbG9uZTpmdW5jdGlvbigpe3ZhciBlPXMuY2xvbmUuY2FsbCh0aGlzKTtyZXR1cm4gZS5faGFzaD10aGlzLl9oYXNoLmNsb25lKCksZX19KTt0LlNIQTI1Nj1zLl9jcmVhdGVIZWxwZXIobCksdC5IbWFjU0hBMjU2PXMuX2NyZWF0ZUhtYWNIZWxwZXIobCl9KE1hdGgpLG4uU0hBMjU2KX0pKTtjb25zdCBDZT1uZXcgVGV4dEVuY29kZXIsSWU9bmV3IFRleHREZWNvZGVyO3ZhciBUZT1mdW5jdGlvbigpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgZ2xvYmFsVGhpcylyZXR1cm4gZ2xvYmFsVGhpcztpZigidW5kZWZpbmVkIiE9dHlwZW9mIHNlbGYpcmV0dXJuIHNlbGY7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cpcmV0dXJuIHdpbmRvdzt0aHJvdyBuZXcgRXJyb3IoInVuYWJsZSB0byBsb2NhdGUgZ2xvYmFsIG9iamVjdCIpfSgpO2NvbnN0IGplPWU9PntsZXQgdD1lO3JldHVybiB0IGluc3RhbmNlb2YgVWludDhBcnJheSYmKHQ9SWUuZGVjb2RlKHQpKSx0PXQucmVwbGFjZSgvLS9nLCIrIikucmVwbGFjZSgvXy9nLCIvIikucmVwbGFjZSgvXHMvZywiIiksbmV3IFVpbnQ4QXJyYXkoVGUuYXRvYih0KS5zcGxpdCgiIikubWFwKChlPT5lLmNoYXJDb2RlQXQoMCkpKSl9O2NsYXNzIFJlIGV4dGVuZHMgRXJyb3J7Y29uc3RydWN0b3IoZSl7c3VwZXIoZSksdGhpcy5jb2RlPSJFUlJfSk9TRV9HRU5FUklDIix0aGlzLm5hbWU9dGhpcy5jb25zdHJ1Y3Rvci5uYW1lLEVycm9yLmNhcHR1cmVTdGFja1RyYWNlJiZFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLHRoaXMuY29uc3RydWN0b3IpfX1jbGFzcyB4ZSBleHRlbmRzIFJle2NvbnN0cnVjdG9yKGUsdD0idW5zcGVjaWZpZWQiLG49InVuc3BlY2lmaWVkIil7c3VwZXIoZSksdGhpcy5jb2RlPSJFUlJfSldUX0NMQUlNX1ZBTElEQVRJT05fRkFJTEVEIix0aGlzLmNsYWltPXQsdGhpcy5yZWFzb249bn19Y2xhc3MgT2UgZXh0ZW5kcyBSZXtjb25zdHJ1Y3Rvcigpe3N1cGVyKC4uLmFyZ3VtZW50cyksdGhpcy5jb2RlPSJFUlJfSk9TRV9BTEdfTk9UX0FMTE9XRUQifX1jbGFzcyBIZSBleHRlbmRzIFJle2NvbnN0cnVjdG9yKCl7c3VwZXIoLi4uYXJndW1lbnRzKSx0aGlzLmNvZGU9IkVSUl9KT1NFX05PVF9TVVBQT1JURUQifX1jbGFzcyBxZSBleHRlbmRzIFJle2NvbnN0cnVjdG9yKCl7c3VwZXIoLi4uYXJndW1lbnRzKSx0aGlzLmNvZGU9IkVSUl9KV1NfSU5WQUxJRCJ9fWNsYXNzIE1lIGV4dGVuZHMgUmV7Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpLHRoaXMuY29kZT0iRVJSX0pXVF9JTlZBTElEIn19Y2xhc3MgVWUgZXh0ZW5kcyBSZXtjb25zdHJ1Y3Rvcigpe3N1cGVyKC4uLmFyZ3VtZW50cyksdGhpcy5jb2RlPSJFUlJfSldTX1NJR05BVFVSRV9WRVJJRklDQVRJT05fRkFJTEVEIix0aGlzLm1lc3NhZ2U9InNpZ25hdHVyZSB2ZXJpZmljYXRpb24gZmFpbGVkIn19Y2xhc3MgV2UgZXh0ZW5kcyB4ZXtjb25zdHJ1Y3Rvcigpe3N1cGVyKC4uLmFyZ3VtZW50cyksdGhpcy5jb2RlPSJFUlJfSldUX0VYUElSRUQifX12YXIgQmU9VGUuY3J5cHRvO2Z1bmN0aW9uIERlKCl7aWYoIVRlLmlzU2VjdXJlQ29udGV4dCYmIVRlLmNyeXB0by5zdWJ0bGUpdGhyb3cgbmV3IFJlKCJXZWIgQ3J5cHRvZ3JhcGh5IEFQSSBpcyBhdmFpbGFibGUgb25seSBpbiBTZWN1cmUgQ29udGV4dHMuIFNlZTogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvU2VjdXJpdHkvU2VjdXJlX0NvbnRleHRzIil9Y29uc3QgTmU9YXN5bmMgZT0+e3ZhciB0LG47Y29uc3R7YWxnb3JpdGhtOnIsa2V5VXNhZ2VzOm99PWZ1bmN0aW9uKGUpe2xldCB0LG47c3dpdGNoKGUua3R5KXtjYXNlIm9jdCI6c3dpdGNoKGUuYWxnKXtjYXNlIkhTMjU2IjpjYXNlIkhTMzg0IjpjYXNlIkhTNTEyIjp0PXtuYW1lOiJITUFDIixoYXNoOmBTSEEtJHtlLmFsZy5zdWJzdHIoLTMpfWB9LG49WyJzaWduIiwidmVyaWZ5Il07YnJlYWs7Y2FzZSJBMTI4Q0JDLUhTMjU2IjpjYXNlIkExOTJDQkMtSFMzODQiOmNhc2UiQTI1NkNCQy1IUzUxMiI6dGhyb3cgbmV3IEhlKGAke2UuYWxnfSBrZXlzIGNhbm5vdCBiZSBpbXBvcnRlZCBhcyBDcnlwdG9LZXkgaW5zdGFuY2VzYCk7Y2FzZSJBMTI4R0NNIjpjYXNlIkExOTJHQ00iOmNhc2UiQTI1NkdDTSI6Y2FzZSJBMTI4R0NNS1ciOmNhc2UiQTE5MkdDTUtXIjpjYXNlIkEyNTZHQ01LVyI6dD17bmFtZToiQUVTLUdDTSJ9LG49WyJlbmNyeXB0IiwiZGVjcnlwdCJdO2JyZWFrO2Nhc2UiQTEyOEtXIjpjYXNlIkExOTJLVyI6Y2FzZSJBMjU2S1ciOnQ9e25hbWU6IkFFUy1LVyJ9LG49WyJ3cmFwS2V5IiwidW53cmFwS2V5Il07YnJlYWs7Y2FzZSJQQkVTMi1IUzI1NitBMTI4S1ciOmNhc2UiUEJFUzItSFMzODQrQTE5MktXIjpjYXNlIlBCRVMyLUhTNTEyK0EyNTZLVyI6dD17bmFtZToiUEJLREYyIn0sbj1bImRlcml2ZUJpdHMiXTticmVhaztkZWZhdWx0OnRocm93IG5ldyBIZSgndW5zdXBwb3J0ZWQgb3IgaW52YWxpZCBKV0sgImFsZyIgKEFsZ29yaXRobSkgUGFyYW1ldGVyIHZhbHVlJyl9YnJlYWs7Y2FzZSJSU0EiOnN3aXRjaChlLmFsZyl7Y2FzZSJQUzI1NiI6Y2FzZSJQUzM4NCI6Y2FzZSJQUzUxMiI6dD17bmFtZToiUlNBLVBTUyIsaGFzaDpgU0hBLSR7ZS5hbGcuc3Vic3RyKC0zKX1gfSxuPWUuZD9bInNpZ24iXTpbInZlcmlmeSJdO2JyZWFrO2Nhc2UiUlMyNTYiOmNhc2UiUlMzODQiOmNhc2UiUlM1MTIiOnQ9e25hbWU6IlJTQVNTQS1QS0NTMS12MV81IixoYXNoOmBTSEEtJHtlLmFsZy5zdWJzdHIoLTMpfWB9LG49ZS5kP1sic2lnbiJdOlsidmVyaWZ5Il07YnJlYWs7Y2FzZSJSU0EtT0FFUCI6Y2FzZSJSU0EtT0FFUC0yNTYiOmNhc2UiUlNBLU9BRVAtMzg0IjpjYXNlIlJTQS1PQUVQLTUxMiI6dD17bmFtZToiUlNBLU9BRVAiLGhhc2g6YFNIQS0ke3BhcnNlSW50KGUuYWxnLnN1YnN0cigtMyksMTApfHwxfWB9LG49ZS5kP1siZGVjcnlwdCIsInVud3JhcEtleSJdOlsiZW5jcnlwdCIsIndyYXBLZXkiXTticmVhaztkZWZhdWx0OnRocm93IG5ldyBIZSgndW5zdXBwb3J0ZWQgb3IgaW52YWxpZCBKV0sgImFsZyIgKEFsZ29yaXRobSkgUGFyYW1ldGVyIHZhbHVlJyl9YnJlYWs7Y2FzZSJFQyI6c3dpdGNoKGUuYWxnKXtjYXNlIkVTMjU2IjpjYXNlIkVTMzg0IjpjYXNlIkVTNTEyIjp0PXtuYW1lOiJFQ0RTQSIsbmFtZWRDdXJ2ZTplLmNydn0sbj1lLmQ/WyJzaWduIl06WyJ2ZXJpZnkiXTticmVhaztjYXNlIkVDREgtRVMiOmNhc2UiRUNESC1FUytBMTI4S1ciOmNhc2UiRUNESC1FUytBMTkyS1ciOmNhc2UiRUNESC1FUytBMjU2S1ciOnQ9e25hbWU6IkVDREgiLG5hbWVkQ3VydmU6ZS5jcnZ9LG49ZS5kP1siZGVyaXZlQml0cyJdOltdO2JyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IEhlKCd1bnN1cHBvcnRlZCBvciBpbnZhbGlkIEpXSyAiYWxnIiAoQWxnb3JpdGhtKSBQYXJhbWV0ZXIgdmFsdWUnKX1icmVhaztkZWZhdWx0OnRocm93IG5ldyBIZSgndW5zdXBwb3J0ZWQgb3IgaW52YWxpZCBKV0sgImt0eSIgKEtleSBUeXBlKSBQYXJhbWV0ZXIgdmFsdWUnKX1yZXR1cm57YWxnb3JpdGhtOnQsa2V5VXNhZ2VzOm59fShlKTtsZXQgcz0iandrIixpPXsuLi5lfTtyZXR1cm4gZGVsZXRlIGkuYWxnLCJQQktERjIiPT09ci5uYW1lJiYocz0icmF3IixpPWplKGUuaykpLERlKCksQmUuc3VidGxlLmltcG9ydEtleShzLGkscixudWxsIT09KHQ9ZS5leHQpJiZ2b2lkIDAhPT10JiZ0LG51bGwhPT0obj1lLmtleV9vcHMpJiZ2b2lkIDAhPT1uP246byl9O2Z1bmN0aW9uIExlKGUpe3JldHVybiEhZSYmZS5jb25zdHJ1Y3Rvcj09PU9iamVjdH1hc3luYyBmdW5jdGlvbiBLZShlLHQsbil7aWYoIUxlKGUpKXRocm93IG5ldyBUeXBlRXJyb3IoIkpXSyBtdXN0IGJlIGFuIG9iamVjdCIpO2lmKHR8fCh0PWUuYWxnKSwic3RyaW5nIiE9dHlwZW9mIHR8fCF0KXRocm93IG5ldyBUeXBlRXJyb3IoJyJhbGciIGFyZ3VtZW50IGlzIHJlcXVpcmVkIHdoZW4gImp3ay5hbGciIGlzIG5vdCBwcmVzZW50Jyk7c3dpdGNoKGUua3R5KXtjYXNlIm9jdCI6aWYoInN0cmluZyIhPXR5cGVvZiBlLmt8fCFlLmspdGhyb3cgbmV3IFR5cGVFcnJvcignbWlzc2luZyAiayIgKEtleSBWYWx1ZSkgUGFyYW1ldGVyIHZhbHVlJyk7cmV0dXJuIG51bGwhPW58fChuPSEwIT09ZS5leHQpLG4/TmUoey4uLmUsYWxnOnQsZXh0OiExfSk6amUoZS5rKTtjYXNlIlJTQSI6aWYodm9pZCAwIT09ZS5vdGgpdGhyb3cgbmV3IEhlKCdSU0EgSldLICJvdGgiIChPdGhlciBQcmltZXMgSW5mbykgUGFyYW1ldGVyIHZhbHVlIGlzIHVuc3VwcG9ydGVkJyk7Y2FzZSJFQyI6Y2FzZSJPS1AiOnJldHVybiBOZSh7Li4uZSxhbGc6dH0pO2RlZmF1bHQ6dGhyb3cgbmV3IEhlKCd1bnN1cHBvcnRlZCAia3R5IiAoS2V5IFR5cGUpIFBhcmFtZXRlciB2YWx1ZScpfX1jb25zdCBKZT1hc3luYyhlLHQsbixyKT0+e2xldCBvO2lmKERlKCksdCBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpe2lmKCFlLnN0YXJ0c1dpdGgoIkhTIikpdGhyb3cgbmV3IFR5cGVFcnJvcigic3ltbWV0cmljIGtleXMgYXJlIG9ubHkgYXBwbGljYWJsZSBmb3IgSE1BQy1iYXNlZCBhbGdvcml0aG1zIik7bz1hd2FpdCBCZS5zdWJ0bGUuaW1wb3J0S2V5KCJyYXciLHQse2hhc2g6YFNIQS0ke2Uuc3Vic3RyKC0zKX1gLG5hbWU6IkhNQUMifSwhMSxbInZlcmlmeSJdKX1lbHNlIG89dDtyZXR1cm4oKGUsdCk9PntpZihlLnN0YXJ0c1dpdGgoIkhTIikpe2NvbnN0IG49cGFyc2VJbnQoZS5zdWJzdHIoLTMpLDEwKSx7bGVuZ3RoOnJ9PXQuYWxnb3JpdGhtO2lmKCJudW1iZXIiIT10eXBlb2Ygcnx8cjxuKXRocm93IG5ldyBUeXBlRXJyb3IoYCR7ZX0gcmVxdWlyZXMgc3ltbWV0cmljIGtleXMgdG8gYmUgJHtufSBiaXRzIG9yIGxhcmdlcmApfWlmKGUuc3RhcnRzV2l0aCgiUlMiKXx8ZS5zdGFydHNXaXRoKCJQUyIpKXtjb25zdHttb2R1bHVzTGVuZ3RoOm59PXQuYWxnb3JpdGhtO2lmKCJudW1iZXIiIT10eXBlb2Ygbnx8bjwyMDQ4KXRocm93IG5ldyBUeXBlRXJyb3IoYCR7ZX0gcmVxdWlyZXMga2V5IG1vZHVsdXNMZW5ndGggdG8gYmUgMjA0OCBiaXRzIG9yIGxhcmdlcmApfX0pKGUsbyksQmUuc3VidGxlLnZlcmlmeShmdW5jdGlvbihlKXtzd2l0Y2goZSl7Y2FzZSJIUzI1NiI6cmV0dXJue2hhc2g6IlNIQS0yNTYiLG5hbWU6IkhNQUMifTtjYXNlIkhTMzg0IjpyZXR1cm57aGFzaDoiU0hBLTM4NCIsbmFtZToiSE1BQyJ9O2Nhc2UiSFM1MTIiOnJldHVybntoYXNoOiJTSEEtNTEyIixuYW1lOiJITUFDIn07Y2FzZSJQUzI1NiI6cmV0dXJue2hhc2g6IlNIQS0yNTYiLG5hbWU6IlJTQS1QU1MiLHNhbHRMZW5ndGg6MzJ9O2Nhc2UiUFMzODQiOnJldHVybntoYXNoOiJTSEEtMzg0IixuYW1lOiJSU0EtUFNTIixzYWx0TGVuZ3RoOjQ4fTtjYXNlIlBTNTEyIjpyZXR1cm57aGFzaDoiU0hBLTUxMiIsbmFtZToiUlNBLVBTUyIsc2FsdExlbmd0aDo2NH07Y2FzZSJSUzI1NiI6cmV0dXJue2hhc2g6IlNIQS0yNTYiLG5hbWU6IlJTQVNTQS1QS0NTMS12MV81In07Y2FzZSJSUzM4NCI6cmV0dXJue2hhc2g6IlNIQS0zODQiLG5hbWU6IlJTQVNTQS1QS0NTMS12MV81In07Y2FzZSJSUzUxMiI6cmV0dXJue2hhc2g6IlNIQS01MTIiLG5hbWU6IlJTQVNTQS1QS0NTMS12MV81In07Y2FzZSJFUzI1NiI6cmV0dXJue2hhc2g6IlNIQS0yNTYiLG5hbWU6IkVDRFNBIixuYW1lZEN1cnZlOiJQLTI1NiJ9O2Nhc2UiRVMzODQiOnJldHVybntoYXNoOiJTSEEtMzg0IixuYW1lOiJFQ0RTQSIsbmFtZWRDdXJ2ZToiUC0zODQifTtjYXNlIkVTNTEyIjpyZXR1cm57aGFzaDoiU0hBLTUxMiIsbmFtZToiRUNEU0EiLG5hbWVkQ3VydmU6IlAtNTIxIn07ZGVmYXVsdDp0aHJvdyBuZXcgSGUoYGFsZyAke2V9IGlzIHVuc3VwcG9ydGVkIGVpdGhlciBieSBKT1NFIG9yIHlvdXIgamF2YXNjcmlwdCBydW50aW1lYCl9fShlKSxvLG4scil9O2NvbnN0IEZlPWZ1bmN0aW9uKGUsdCxuLHIpe2lmKHZvaWQgMCE9PXIuY3JpdCYmdm9pZCAwPT09bi5jcml0KXRocm93IG5ldyBlKCciY3JpdCIgKENyaXRpY2FsKSBIZWFkZXIgUGFyYW1ldGVyIE1VU1QgYmUgaW50ZWdyaXR5IHByb3RlY3RlZCcpO2lmKCFufHx2b2lkIDA9PT1uLmNyaXQpcmV0dXJuIG5ldyBTZXQ7aWYoIUFycmF5LmlzQXJyYXkobi5jcml0KXx8MD09PW4uY3JpdC5sZW5ndGh8fG4uY3JpdC5zb21lKChlPT4ic3RyaW5nIiE9dHlwZW9mIGV8fDA9PT1lLmxlbmd0aCkpKXRocm93IG5ldyBlKCciY3JpdCIgKENyaXRpY2FsKSBIZWFkZXIgUGFyYW1ldGVyIE1VU1QgYmUgYW4gYXJyYXkgb2Ygbm9uLWVtcHR5IHN0cmluZ3Mgd2hlbiBwcmVzZW50Jyk7Zm9yKGNvbnN0IG8gb2Ygbi5jcml0KXtpZighdC5oYXMobykpdGhyb3cgbmV3IEhlKGBFeHRlbnNpb24gSGVhZGVyIFBhcmFtZXRlciAiJHtvfSIgaXMgbm90IHN1cHBvcnRlZCBieSB0aGlzIGltcGxlbWVudGF0aW9uYCk7aWYodm9pZCAwPT09cltvXSl0aHJvdyBuZXcgZShgRXh0ZW5zaW9uIEhlYWRlciBQYXJhbWV0ZXIgIiR7b30iIGlzIG1pc3NpbmdgKTtpZih0LmdldChvKSYmdm9pZCAwPT09bltvXSl0aHJvdyBuZXcgZShgRXh0ZW5zaW9uIEhlYWRlciBQYXJhbWV0ZXIgIiR7b30iIE1VU1QgYmUgaW50ZWdyaXR5IHByb3RlY3RlZGApfXJldHVybiBuZXcgU2V0KG4uY3JpdCl9LmJpbmQodm9pZCAwLHFlLG5ldyBNYXAoW1siYjY0IiwhMF1dKSksJGU9KChlLHQpPT57aWYodm9pZCAwIT09dCYmKCFBcnJheS5pc0FycmF5KHQpfHx0LnNvbWUoKGU9PiJzdHJpbmciIT10eXBlb2YgZSkpKSl0aHJvdyBuZXcgVHlwZUVycm9yKGAiJHtlfSIgb3B0aW9uIG11c3QgYmUgYW4gYXJyYXkgb2Ygc3RyaW5nc2ApO2lmKHQpcmV0dXJuIG5ldyBTZXQodCl9KS5iaW5kKHZvaWQgMCwiYWxnb3JpdGhtcyIpO2FzeW5jIGZ1bmN0aW9uIHplKGUsdCxuKXtpZighTGUoZSkpdGhyb3cgbmV3IHFlKCJGbGF0dGVuZWQgSldTIG11c3QgYmUgYW4gb2JqZWN0Iik7aWYodm9pZCAwPT09ZS5wcm90ZWN0ZWQmJnZvaWQgMD09PWUuaGVhZGVyKXRocm93IG5ldyBxZSgnRmxhdHRlbmVkIEpXUyBtdXN0IGhhdmUgZWl0aGVyIG9mIHRoZSAicHJvdGVjdGVkIiBvciAiaGVhZGVyIiBtZW1iZXJzJyk7aWYodm9pZCAwIT09ZS5wcm90ZWN0ZWQmJiJzdHJpbmciIT10eXBlb2YgZS5wcm90ZWN0ZWQpdGhyb3cgbmV3IHFlKCJKV1MgUHJvdGVjdGVkIEhlYWRlciBpbmNvcnJlY3QgdHlwZSIpO2lmKHZvaWQgMD09PWUucGF5bG9hZCl0aHJvdyBuZXcgcWUoIkpXUyBQYXlsb2FkIG1pc3NpbmciKTtpZigic3RyaW5nIiE9dHlwZW9mIGUuc2lnbmF0dXJlKXRocm93IG5ldyBxZSgiSldTIFNpZ25hdHVyZSBtaXNzaW5nIG9yIGluY29ycmVjdCB0eXBlIik7aWYodm9pZCAwIT09ZS5oZWFkZXImJiFMZShlLmhlYWRlcikpdGhyb3cgbmV3IHFlKCJKV1MgVW5wcm90ZWN0ZWQgSGVhZGVyIGluY29ycmVjdCB0eXBlIik7bGV0IHI9e307aWYoZS5wcm90ZWN0ZWQpe2NvbnN0IHQ9amUoZS5wcm90ZWN0ZWQpO3I9SlNPTi5wYXJzZShJZS5kZWNvZGUodCkpfWlmKCEoKC4uLmUpPT57Y29uc3QgdD1lLmZpbHRlcihCb29sZWFuKTtpZigwPT09dC5sZW5ndGh8fDE9PT10Lmxlbmd0aClyZXR1cm4hMDtsZXQgbjtmb3IoY29uc3QgZSBvZiB0KXtjb25zdCB0PU9iamVjdC5rZXlzKGUpO2lmKG4mJjAhPT1uLnNpemUpZm9yKGNvbnN0IGUgb2YgdCl7aWYobi5oYXMoZSkpcmV0dXJuITE7bi5hZGQoZSl9ZWxzZSBuPW5ldyBTZXQodCl9cmV0dXJuITB9KShyLGUuaGVhZGVyKSl0aHJvdyBuZXcgcWUoIkpXUyBQcm90ZWN0ZWQgYW5kIEpXUyBVbnByb3RlY3RlZCBIZWFkZXIgUGFyYW1ldGVyIG5hbWVzIG11c3QgYmUgZGlzam9pbnQiKTtjb25zdCBvPXsuLi5yLC4uLmUuaGVhZGVyfTtsZXQgcz0hMDtpZihGZShyLG8pLmhhcygiYjY0IikmJihzPXIuYjY0LCJib29sZWFuIiE9dHlwZW9mIHMpKXRocm93IG5ldyBxZSgnVGhlICJiNjQiIChiYXNlNjR1cmwtZW5jb2RlIHBheWxvYWQpIEhlYWRlciBQYXJhbWV0ZXIgbXVzdCBiZSBhIGJvb2xlYW4nKTtjb25zdHthbGc6aX09bztpZigic3RyaW5nIiE9dHlwZW9mIGl8fCFpKXRocm93IG5ldyBxZSgnSldTICJhbGciIChBbGdvcml0aG0pIEhlYWRlciBQYXJhbWV0ZXIgbWlzc2luZyBvciBpbnZhbGlkJyk7Y29uc3QgYT1uJiYkZShuLmFsZ29yaXRobXMpO2lmKGEmJiFhLmhhcyhpKSl0aHJvdyBuZXcgT2UoJyJhbGciIChBbGdvcml0aG0pIEhlYWRlciBQYXJhbWV0ZXIgbm90IGFsbG93ZWQnKTtpZihzKXtpZigic3RyaW5nIiE9dHlwZW9mIGUucGF5bG9hZCl0aHJvdyBuZXcgcWUoIkpXUyBQYXlsb2FkIG11c3QgYmUgYSBzdHJpbmciKX1lbHNlIGlmKCJzdHJpbmciIT10eXBlb2YgZS5wYXlsb2FkJiYhKGUucGF5bG9hZCBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpKXRocm93IG5ldyBxZSgiSldTIFBheWxvYWQgbXVzdCBiZSBhIHN0cmluZyBvciBhbiBVaW50OEFycmF5IGluc3RhbmNlIik7ImZ1bmN0aW9uIj09dHlwZW9mIHQmJih0PWF3YWl0IHQocixlKSksKChlLHQpPT57aWYoZS5zdGFydHNXaXRoKCJIUyIpfHwiZGlyIj09PWV8fGUuc3RhcnRzV2l0aCgiUEJFUzIiKXx8ZS5tYXRjaCgvXkFcZHszfSg/OkdDTSlLVyQvKSl7aWYodCBpbnN0YW5jZW9mIFVpbnQ4QXJyYXl8fCJzZWNyZXQiPT09dC50eXBlKXJldHVybjt0aHJvdyBuZXcgVHlwZUVycm9yKCdDcnlwdG9LZXkgb3IgS2V5T2JqZWN0IGluc3RhbmNlcyBmb3Igc3ltbWV0cmljIGFsZ29yaXRobXMgbXVzdCBiZSBvZiB0eXBlICJzZWNyZXQiJyl9aWYodCBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ3J5cHRvS2V5IG9yIEtleU9iamVjdCBpbnN0YW5jZXMgbXVzdCBiZSB1c2VkIGZvciBhc3ltbWV0cmljIGFsZ29yaXRobXMiKTtpZigic2VjcmV0Ij09PXQudHlwZSl0aHJvdyBuZXcgVHlwZUVycm9yKCdDcnlwdG9LZXkgb3IgS2V5T2JqZWN0IGluc3RhbmNlcyBmb3IgYXN5bW1ldHJpYyBhbGdvcml0aG1zIG11c3Qgbm90IGJlIG9mIHR5cGUgInNlY3JldCInKX0pKGksdCk7Y29uc3QgYz1mdW5jdGlvbiguLi5lKXtjb25zdCB0PWUucmVkdWNlKCgoZSx7bGVuZ3RoOnR9KT0+ZSt0KSwwKSxuPW5ldyBVaW50OEFycmF5KHQpO2xldCByPTA7cmV0dXJuIGUuZm9yRWFjaCgoZT0+e24uc2V0KGUscikscis9ZS5sZW5ndGh9KSksbn0oQ2UuZW5jb2RlKGUucHJvdGVjdGVkfHwiIiksQ2UuZW5jb2RlKCIuIiksInN0cmluZyI9PXR5cGVvZiBlLnBheWxvYWQ/Q2UuZW5jb2RlKGUucGF5bG9hZCk6ZS5wYXlsb2FkKSx1PWplKGUuc2lnbmF0dXJlKTtpZighYXdhaXQgSmUoaSx0LHUsYykpdGhyb3cgbmV3IFVlO2xldCBsO2w9cz9qZShlLnBheWxvYWQpOiJzdHJpbmciPT10eXBlb2YgZS5wYXlsb2FkP0NlLmVuY29kZShlLnBheWxvYWQpOmUucGF5bG9hZDtjb25zdCBkPXtwYXlsb2FkOmx9O3JldHVybiB2b2lkIDAhPT1lLnByb3RlY3RlZCYmKGQucHJvdGVjdGVkSGVhZGVyPXIpLHZvaWQgMCE9PWUuaGVhZGVyJiYoZC51bnByb3RlY3RlZEhlYWRlcj1lLmhlYWRlciksZH1jb25zdCBHZT04NjQwMCxWZT0vXihcZCt8XGQrXC5cZCspID8oc2Vjb25kcz98c2Vjcz98c3xtaW51dGVzP3xtaW5zP3xtfGhvdXJzP3xocnM/fGh8ZGF5cz98ZHx3ZWVrcz98d3x5ZWFycz98eXJzP3x5KSQvaTt2YXIgWWU9ZT0+e2NvbnN0IHQ9VmUuZXhlYyhlKTtpZighdCl0aHJvdyBuZXcgVHlwZUVycm9yKCJpbnZhbGlkIHRpbWUgcGVyaW9kIGZvcm1hdCIpO2NvbnN0IG49cGFyc2VGbG9hdCh0WzFdKTtzd2l0Y2godFsyXS50b0xvd2VyQ2FzZSgpKXtjYXNlInNlYyI6Y2FzZSJzZWNzIjpjYXNlInNlY29uZCI6Y2FzZSJzZWNvbmRzIjpjYXNlInMiOnJldHVybiBNYXRoLnJvdW5kKG4pO2Nhc2UibWludXRlIjpjYXNlIm1pbnV0ZXMiOmNhc2UibWluIjpjYXNlIm1pbnMiOmNhc2UibSI6cmV0dXJuIE1hdGgucm91bmQoNjAqbik7Y2FzZSJob3VyIjpjYXNlImhvdXJzIjpjYXNlImhyIjpjYXNlImhycyI6Y2FzZSJoIjpyZXR1cm4gTWF0aC5yb3VuZCgzNjAwKm4pO2Nhc2UiZGF5IjpjYXNlImRheXMiOmNhc2UiZCI6cmV0dXJuIE1hdGgucm91bmQobipHZSk7Y2FzZSJ3ZWVrIjpjYXNlIndlZWtzIjpjYXNlInciOnJldHVybiBNYXRoLnJvdW5kKDYwNDgwMCpuKTtkZWZhdWx0OnJldHVybiBNYXRoLnJvdW5kKDMxNTU3NjAwKm4pfX07Y29uc3QgWGU9ZT0+ZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL15hcHBsaWNhdGlvblwvLywiIik7dmFyIFFlPShlLHQsbj17fSk9Pntjb25zdHt0eXA6cn09bjtpZihyJiYoInN0cmluZyIhPXR5cGVvZiBlLnR5cHx8WGUoZS50eXApIT09WGUocikpKXRocm93IG5ldyB4ZSgndW5leHBlY3RlZCAidHlwIiBKV1QgaGVhZGVyIHZhbHVlJywidHlwIiwiY2hlY2tfZmFpbGVkIik7bGV0IG87dHJ5e289SlNPTi5wYXJzZShJZS5kZWNvZGUodCkpfWNhdGNoKGUpe31pZigib2JqZWN0IiE9dHlwZW9mIG98fCFvfHxBcnJheS5pc0FycmF5KG8pKXRocm93IG5ldyBNZSgiSldUIENsYWltcyBTZXQgbXVzdCBiZSBhIHRvcC1sZXZlbCBKU09OIG9iamVjdCIpO2NvbnN0e2lzc3VlcjpzfT1uO2lmKHMmJiEoInN0cmluZyI9PXR5cGVvZiBzP1tzXTpzKS5pbmNsdWRlcyhvLmlzcykpdGhyb3cgbmV3IHhlKCd1bmV4cGVjdGVkICJpc3MiIGNsYWltIHZhbHVlJywiaXNzIiwiY2hlY2tfZmFpbGVkIik7Y29uc3R7c3ViamVjdDppfT1uO2lmKGkmJm8uc3ViIT09aSl0aHJvdyBuZXcgeGUoJ3VuZXhwZWN0ZWQgInN1YiIgY2xhaW0gdmFsdWUnLCJzdWIiLCJjaGVja19mYWlsZWQiKTtjb25zdHthdWRpZW5jZTphfT1uO2lmKGEmJihjPW8uYXVkLHU9InN0cmluZyI9PXR5cGVvZiBhP1thXTphLCEoInN0cmluZyI9PXR5cGVvZiBjP3UuaW5jbHVkZXMoYyk6dS5zb21lKFNldC5wcm90b3R5cGUuaGFzLmJpbmQobmV3IFNldChjKSkpKSkpdGhyb3cgbmV3IHhlKCd1bmV4cGVjdGVkICJhdWQiIGNsYWltIHZhbHVlJywiYXVkIiwiY2hlY2tfZmFpbGVkIik7dmFyIGMsdTtsZXQgbDtzd2l0Y2godHlwZW9mIG4uY2xvY2tUb2xlcmFuY2Upe2Nhc2Uic3RyaW5nIjpsPVllKG4uY2xvY2tUb2xlcmFuY2UpO2JyZWFrO2Nhc2UibnVtYmVyIjpsPW4uY2xvY2tUb2xlcmFuY2U7YnJlYWs7Y2FzZSJ1bmRlZmluZWQiOmw9MDticmVhaztkZWZhdWx0OnRocm93IG5ldyBUeXBlRXJyb3IoImludmFsaWQgY2xvY2tUb2xlcmFuY2Ugb3B0aW9uIHR5cGUiKX1jb25zdHtjdXJyZW50RGF0ZTpkfT1uLHA9KGg9ZHx8bmV3IERhdGUsTWF0aC5mbG9vcihoLmdldFRpbWUoKS8xZTMpKTt2YXIgaDtpZih2b2lkIDAhPT1vLmlhdHx8bi5tYXhUb2tlbkFnZSl7aWYoIm51bWJlciIhPXR5cGVvZiBvLmlhdCl0aHJvdyBuZXcgeGUoJyJpYXQiIGNsYWltIG11c3QgYmUgYSBudW1iZXInLCJpYXQiLCJpbnZhbGlkIik7aWYodm9pZCAwPT09by5leHAmJm8uaWF0PnArbCl0aHJvdyBuZXcgeGUoJyJpYXQiIGNsYWltIHRpbWVzdGFtcCBjaGVjayBmYWlsZWQgKGl0IHNob3VsZCBiZSBpbiB0aGUgcGFzdCknLCJpYXQiLCJjaGVja19mYWlsZWQiKX1pZih2b2lkIDAhPT1vLm5iZil7aWYoIm51bWJlciIhPXR5cGVvZiBvLm5iZil0aHJvdyBuZXcgeGUoJyJuYmYiIGNsYWltIG11c3QgYmUgYSBudW1iZXInLCJuYmYiLCJpbnZhbGlkIik7aWYoby5uYmY+cCtsKXRocm93IG5ldyB4ZSgnIm5iZiIgY2xhaW0gdGltZXN0YW1wIGNoZWNrIGZhaWxlZCcsIm5iZiIsImNoZWNrX2ZhaWxlZCIpfWlmKHZvaWQgMCE9PW8uZXhwKXtpZigibnVtYmVyIiE9dHlwZW9mIG8uZXhwKXRocm93IG5ldyB4ZSgnImV4cCIgY2xhaW0gbXVzdCBiZSBhIG51bWJlcicsImV4cCIsImludmFsaWQiKTtpZihvLmV4cDw9cC1sKXRocm93IG5ldyBXZSgnImV4cCIgY2xhaW0gdGltZXN0YW1wIGNoZWNrIGZhaWxlZCcsImV4cCIsImNoZWNrX2ZhaWxlZCIpfWlmKG4ubWF4VG9rZW5BZ2Upe2NvbnN0IGU9cC1vLmlhdDtpZihlLWw+KCJudW1iZXIiPT10eXBlb2Ygbi5tYXhUb2tlbkFnZT9uLm1heFRva2VuQWdlOlllKG4ubWF4VG9rZW5BZ2UpKSl0aHJvdyBuZXcgV2UoJyJpYXQiIGNsYWltIHRpbWVzdGFtcCBjaGVjayBmYWlsZWQgKHRvbyBmYXIgaW4gdGhlIHBhc3QpJywiaWF0IiwiY2hlY2tfZmFpbGVkIik7aWYoZTwwLWwpdGhyb3cgbmV3IHhlKCciaWF0IiBjbGFpbSB0aW1lc3RhbXAgY2hlY2sgZmFpbGVkIChpdCBzaG91bGQgYmUgaW4gdGhlIHBhc3QpJywiaWF0IiwiY2hlY2tfZmFpbGVkIil9cmV0dXJuIG99O2FzeW5jIGZ1bmN0aW9uIFplKGUsdCxuKXtjb25zdCByPWF3YWl0IGFzeW5jIGZ1bmN0aW9uKGUsdCxuKXtpZihlIGluc3RhbmNlb2YgVWludDhBcnJheSYmKGU9SWUuZGVjb2RlKGUpKSwic3RyaW5nIiE9dHlwZW9mIGUpdGhyb3cgbmV3IHFlKCJDb21wYWN0IEpXUyBtdXN0IGJlIGEgc3RyaW5nIG9yIFVpbnQ4QXJyYXkiKTtjb25zdHswOnIsMTpvLDI6cyxsZW5ndGg6aX09ZS5zcGxpdCgiLiIpO2lmKDMhPT1pKXRocm93IG5ldyBxZSgiSW52YWxpZCBDb21wYWN0IEpXUyIpO2NvbnN0IGE9YXdhaXQgemUoe3BheWxvYWQ6b3x8dm9pZCAwLHByb3RlY3RlZDpyfHx2b2lkIDAsc2lnbmF0dXJlOnN8fHZvaWQgMH0sdCxuKTtyZXR1cm57cGF5bG9hZDphLnBheWxvYWQscHJvdGVjdGVkSGVhZGVyOmEucHJvdGVjdGVkSGVhZGVyfX0oZSx0LG4pO3JldHVybntwYXlsb2FkOlFlKHIucHJvdGVjdGVkSGVhZGVyLHIucGF5bG9hZCxuKSxwcm90ZWN0ZWRIZWFkZXI6ci5wcm90ZWN0ZWRIZWFkZXJ9fWNvbnN0IGV0PWU9PkFlLnN0cmluZ2lmeShlKS5yZXBsYWNlKC9cKy9nLCItIikucmVwbGFjZSgvXC8vZywiXyIpLnJlcGxhY2UoLz0vZywiIiksdHQ9ZT0+KHtibG9iOihudWxsPT1lP3ZvaWQgMDplLmRhdGEpaW5zdGFuY2VvZiBCbG9iP251bGw9PWU/dm9pZCAwOmUuZGF0YTpudWxsLGRhdGE6SlNPTi5zdHJpbmdpZnkobnVsbCE9ZT9lOiIiKSxzdWNjZXNzOiEwfSksbnQ9ZT0+KChudWxsPT1lP3ZvaWQgMDplLnRvSlNPTikmJmRlbGV0ZSBlLnRvSlNPTix7ZXJyb3I6SlNPTi5zdHJpbmdpZnkobnVsbCE9ZT9lOiIiKSxzdWNjZXNzOiExfSkscnQ9ZT0+ZS5zdG9yYWdlPT09dmUuV2ViV29ya2VyO2Z1bmN0aW9uIG90KGUpe2lmKGUmJnJ0KGUpKXtpZihlLnNlc3Npb24uZ2V0KFopKXJldHVybiBlLnNlc3Npb24uZ2V0KFopfWVsc2V7aWYoZSYmZS5yZXNwb25zZU1vZGU9PT13ZS5mb3JtUG9zdClyZXR1cm4gZS5hdXRob3JpemF0aW9uQ29kZTtpZihuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKS5zZWFyY2hQYXJhbXMuZ2V0KFopKXJldHVybiBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKS5zZWFyY2hQYXJhbXMuZ2V0KFopfXJldHVybiBudWxsfWZ1bmN0aW9uIHN0KGUsdCl7Y29uc3Qgbj14dChlKTtpZighbnx8MD09PW4udHJpbSgpLmxlbmd0aClyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCJJbnZhbGlkIGF1dGhvcml6ZSBlbmRwb2ludCBmb3VuZC4iKSk7bGV0IHI9bisiP3Jlc3BvbnNlX3R5cGU9Y29kZSZjbGllbnRfaWQ9IitlLmNsaWVudElELG89bmU7aWYoZS5zY29wZSYmZS5zY29wZS5sZW5ndGg+MCYmKGUuc2NvcGUuaW5jbHVkZXMobmUpfHxlLnNjb3BlLnB1c2gobmUpLG89ZS5zY29wZS5qb2luKCIgIikpLHIrPSImc2NvcGU9IitvLHIrPSImcmVkaXJlY3RfdXJpPSIrZS5zaWduSW5SZWRpcmVjdFVSTCxlLnJlc3BvbnNlTW9kZSYmKHIrPSImcmVzcG9uc2VfbW9kZT0iK2UucmVzcG9uc2VNb2RlKSxlLmVuYWJsZVBLQ0Upe2NvbnN0IHQ9ZXQoRWUucmFuZG9tKDMyKSksbj1ldChQZSh0KSk7aHQocmUsdCxlKSxyKz0iJmNvZGVfY2hhbGxlbmdlX21ldGhvZD1TMjU2JmNvZGVfY2hhbGxlbmdlPSIrbn1lLnByb21wdCYmKHIrPSImcHJvbXB0PSIrZS5wcm9tcHQpLHQmJihyKz0iJmZpZHA9Iit0KTtjb25zdCBzPWUuY3VzdG9tUGFyYW1zO2lmKHMpZm9yKGNvbnN0W2UsdF1vZiBPYmplY3QuZW50cmllcyhzKSkiIiE9ZSYmIiIhPXQmJihyKz0iJiIrZSsiPSIrdCk7aWYoZS5zdG9yYWdlPT09dmUuV2ViV29ya2VyKXJldHVybiBQcm9taXNlLnJlc29sdmUoe2NvZGU6cixwa2NlOmZ0KHJlLGUpLHR5cGU6Z2V9KTtkb2N1bWVudC5sb2NhdGlvbi5ocmVmPXJ9ZnVuY3Rpb24gaXQoZSx0KXtjb25zdCBuPVV0KHQpO3JldHVybiBuJiYwIT09bi50cmltKCkubGVuZ3RoP0IuZ2V0KG4pLnRoZW4oKHI9Pnt2YXIgbztpZigyMDAhPT1yLnN0YXR1cylyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCJGYWlsZWQgdG8gbG9hZCBwdWJsaWMga2V5cyBmcm9tIEpXS1MgVVJJOiAiK24pKTtjb25zdCBzPVd0KHQpO2xldCBpPXQuc2VydmVyT3JpZ2luK0Qud2VsbEtub3duLnNwbGl0KCIvLndlbGwta25vd24iKVswXTtyZXR1cm4obnVsbD09PShvPXQuZW5kcG9pbnRzKXx8dm9pZCAwPT09bz92b2lkIDA6by53ZWxsS25vd24pJiYoaT10LmVuZHBvaW50cy53ZWxsS25vd24uc3BsaXQoIi8ud2VsbC1rbm93biIpWzBdKSxzJiZzPT09aT8oKGUsdCk9Pntjb25zdCBuPUpTT04ucGFyc2UoYXRvYihlKSk7Zm9yKGNvbnN0IGUgb2YgdClpZihuLmtpZD09PWUua2lkKXJldHVybiBLZSh7YWxnOmUuYWxnLGU6ZS5lLGt0eTplLmt0eSxuOmUubn0pO3JldHVybiBQcm9taXNlLnJlamVjdCgiRmFpbGVkIHRvIGZpbmQgdGhlICdraWQnIHNwZWNpZmllZCBpbiB0aGUgaWRfdG9rZW4uICdraWQnIGZvdW5kIGluIHRoZSBoZWFkZXIgOiAiK24ua2lkKyIsIEV4cGVjdGVkIHZhbHVlczogIit0Lm1hcCgoZT0+ZS5raWQpKS5qb2luKCIsICIpKX0pKGUuc3BsaXQoIi4iKVswXSxyLmRhdGEua2V5cykudGhlbigobj0+KChlLHQsbixyLG8scyk9PlplKGUsdCx7YWxnb3JpdGhtczpbIlJTMjU2IiwiUlM1MTIiLCJSUzM4NCIsIlBTMjU2Il0sYXVkaWVuY2U6bixjbG9ja1RvbGVyYW5jZTpzLGlzc3VlcjpyLHN1YmplY3Q6b30pLnRoZW4oKCgpPT5Qcm9taXNlLnJlc29sdmUoITApKSkuY2F0Y2goKGU9PlByb21pc2UucmVqZWN0KGUpKSkpKGUsbix0LmNsaWVudElELHMsY3QoZSkudXNlcm5hbWUsdC5jbG9ja1RvbGVyYW5jZSkpKS5jYXRjaCgoZT0+UHJvbWlzZS5yZWplY3QoZSkpKTpQcm9taXNlLnJlc29sdmUoITEpfSkpLmNhdGNoKChlPT5Qcm9taXNlLnJlamVjdChlKSkpOlByb21pc2UucmVqZWN0KCJJbnZhbGlkIEpXS1MgVVJJIGZvdW5kLiIpfWZ1bmN0aW9uIGF0KGUsdCl7Y29uc3Qgbj1PdChlKTtpZighbnx8MD09PW4udHJpbSgpLmxlbmd0aClyZXR1cm4gUHJvbWlzZS5yZWplY3QoIkludmFsaWQgdG9rZW4gZW5kcG9pbnQgZm91bmQuIik7Y29uc3Qgcj1bXTtyZXR1cm4gci5wdXNoKGBjbGllbnRfaWQ9JHtlLmNsaWVudElEfWApLHIucHVzaChgcmVmcmVzaF90b2tlbj0ke3R9YCksci5wdXNoKCJncmFudF90eXBlPXJlZnJlc2hfdG9rZW4iKSxlLmNsaWVudFNlY3JldCYmZS5jbGllbnRTZWNyZXQudHJpbSgpLmxlbmd0aD4wJiZyLnB1c2goYGNsaWVudF9zZWNyZXQ9JHtlLmNsaWVudFNlY3JldH1gKSxCLnBvc3QobixyLmpvaW4oIiYiKSx7aGVhZGVyczp7QWNjZXB0OiJhcHBsaWNhdGlvbi9qc29uIiwiQ29udGVudC1UeXBlIjoiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIn19KS50aGVuKCh0PT57aWYoMjAwIT09dC5zdGF0dXMpcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcigiSW52YWxpZCBzdGF0dXMgY29kZSByZWNlaXZlZCBpbiB0aGUgcmVmcmVzaCB0b2tlbiByZXNwb25zZTogIit0LnN0YXR1cykpO2lmKGUudmFsaWRhdGVJRFRva2VuKXJldHVybiBpdCh0LmRhdGEuaWRfdG9rZW4sZSkudGhlbigobj0+e2lmKG4pe2NvbnN0IG49e2FjY2Vzc1Rva2VuOnQuZGF0YS5hY2Nlc3NfdG9rZW4sZXhwaXJlc0luOnQuZGF0YS5leHBpcmVzX2luLGlkVG9rZW46dC5kYXRhLmlkX3Rva2VuLHJlZnJlc2hUb2tlbjp0LmRhdGEucmVmcmVzaF90b2tlbixzY29wZTp0LmRhdGEuc2NvcGUsdG9rZW5UeXBlOnQuZGF0YS50b2tlbl90eXBlfTtyZXR1cm4gZ3QobixjdCh0LmRhdGEuaWRfdG9rZW4pLGUpLFByb21pc2UucmVzb2x2ZShuKX1yZXR1cm4gUHJvbWlzZS5yZWplY3QoIkludmFsaWQgaWRfdG9rZW4gaW4gdGhlIHRva2VuIHJlc3BvbnNlOiAiK3QuZGF0YS5pZF90b2tlbil9KSk7e2NvbnN0IG49e2FjY2Vzc1Rva2VuOnQuZGF0YS5hY2Nlc3NfdG9rZW4sZXhwaXJlc0luOnQuZGF0YS5leHBpcmVzX2luLGlkVG9rZW46dC5kYXRhLmlkX3Rva2VuLHJlZnJlc2hUb2tlbjp0LmRhdGEucmVmcmVzaF90b2tlbixzY29wZTp0LmRhdGEuc2NvcGUsdG9rZW5UeXBlOnQuZGF0YS50b2tlbl90eXBlfTtyZXR1cm4gZ3QobixjdCh0LmRhdGEuaWRfdG9rZW4pLGUpLFByb21pc2UucmVzb2x2ZShuKX19KSkuY2F0Y2goKGU9PlByb21pc2UucmVqZWN0KGUpKSl9Y29uc3QgY3Q9ZT0+e2NvbnN0IHQ9SlNPTi5wYXJzZShhdG9iKG51bGw9PWU/dm9pZCAwOmUuc3BsaXQoIi4iKVsxXSkpLG49dC5lbWFpbD90LmVtYWlsOm51bGwscj0oKGUsdD0iQCIpPT57aWYoZS50ZW5hbnRfZG9tYWluKXJldHVybiBlLnRlbmFudF9kb21haW47Y29uc3Qgbj1lLnN1Yi5zcGxpdCh0KTtyZXR1cm4gbltuLmxlbmd0aC0xXX0pKHQpO3JldHVybntkaXNwbGF5TmFtZTp0LnByZWZlcnJlZF91c2VybmFtZT90LnByZWZlcnJlZF91c2VybmFtZTp0LnN1YixlbWFpbDpuLHRlbmFudERvbWFpbjpyLHVzZXJuYW1lOnQuc3VifX07ZnVuY3Rpb24gdXQoZSx0KXtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuISFvdChlKX0oZSk/ZnVuY3Rpb24oZSl7Y29uc3QgdD1PdChlKTtpZighdHx8MD09PXQudHJpbSgpLmxlbmd0aClyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCJJbnZhbGlkIHRva2VuIGVuZHBvaW50IGZvdW5kLiIpKTtjb25zdCBuPXJ0KGUpP2Uuc2Vzc2lvbi5nZXQoaWUpOm5ldyBVUkwod2luZG93LmxvY2F0aW9uLmhyZWYpLnNlYXJjaFBhcmFtcy5nZXQoaWUpO251bGwhPT1uJiZuLmxlbmd0aD4wJiZodChpZSxuLGUpO2NvbnN0IHI9W107ci5wdXNoKGBjbGllbnRfaWQ9JHtlLmNsaWVudElEfWApLGUuY2xpZW50U2VjcmV0JiZlLmNsaWVudFNlY3JldC50cmltKCkubGVuZ3RoPjAmJnIucHVzaChgY2xpZW50X3NlY3JldD0ke2UuY2xpZW50U2VjcmV0fWApO2NvbnN0IG89cnQoZSk/ZS5zZXNzaW9uLmdldChaKTpvdChlKTtyZXR1cm4gci5wdXNoKGBjb2RlPSR7b31gKSxlLnN0b3JhZ2U9PT12ZS5TZXNzaW9uU3RvcmFnZSYmd2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oWikmJndpbmRvdy5zZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKFopLHJ0KGUpJiZlLnNlc3Npb24uZ2V0KFopJiZlLnNlc3Npb24uZGVsZXRlKFopLHIucHVzaCgiZ3JhbnRfdHlwZT1hdXRob3JpemF0aW9uX2NvZGUiKSxyLnB1c2goYHJlZGlyZWN0X3VyaT0ke2Uuc2lnbkluUmVkaXJlY3RVUkx9YCksZS5lbmFibGVQS0NFJiYoci5wdXNoKGBjb2RlX3ZlcmlmaWVyPSR7ZnQocmUsZSl9YCkscHQocmUsZSkpLEIucG9zdCh0LHIuam9pbigiJiIpLHtoZWFkZXJzOntBY2NlcHQ6ImFwcGxpY2F0aW9uL2pzb24iLCJDb250ZW50LVR5cGUiOiJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQifX0pLnRoZW4oKHQ9PntpZigyMDAhPT10LnN0YXR1cylyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCJJbnZhbGlkIHN0YXR1cyBjb2RlIHJlY2VpdmVkIGluIHRoZSB0b2tlbiByZXNwb25zZTogIit0LnN0YXR1cykpO2lmKGUudmFsaWRhdGVJRFRva2VuKXJldHVybiBpdCh0LmRhdGEuaWRfdG9rZW4sZSkudGhlbigobj0+e2lmKG4pe2h0KGNlLEpTT04uc3RyaW5naWZ5KGUpLGUpO2NvbnN0IG49e2FjY2Vzc1Rva2VuOnQuZGF0YS5hY2Nlc3NfdG9rZW4sZXhwaXJlc0luOnQuZGF0YS5leHBpcmVzX2luLGlkVG9rZW46dC5kYXRhLmlkX3Rva2VuLHJlZnJlc2hUb2tlbjp0LmRhdGEucmVmcmVzaF90b2tlbixzY29wZTp0LmRhdGEuc2NvcGUsdG9rZW5UeXBlOnQuZGF0YS50b2tlbl90eXBlfTtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG4pfXJldHVybiBQcm9taXNlLnJlamVjdCgiSW52YWxpZCBpZF90b2tlbiBpbiB0aGUgdG9rZW4gcmVzcG9uc2U6ICIrdC5kYXRhLmlkX3Rva2VuKX0pKS5jYXRjaCgoZT0+UHJvbWlzZS5yZWplY3QoZSkpKTt7Y29uc3Qgbj17YWNjZXNzVG9rZW46dC5kYXRhLmFjY2Vzc190b2tlbixleHBpcmVzSW46dC5kYXRhLmV4cGlyZXNfaW4saWRUb2tlbjp0LmRhdGEuaWRfdG9rZW4scmVmcmVzaFRva2VuOnQuZGF0YS5yZWZyZXNoX3Rva2VuLHNjb3BlOnQuZGF0YS5zY29wZSx0b2tlblR5cGU6dC5kYXRhLnRva2VuX3R5cGV9O3JldHVybiBodChjZSxKU09OLnN0cmluZ2lmeShlKSxlKSxQcm9taXNlLnJlc29sdmUobil9fSkpLmNhdGNoKChlPT5Qcm9taXNlLnJlamVjdChlKSkpfShlKS50aGVuKCh0PT4oZ3QodCxjdCh0LmlkVG9rZW4pLGUpLFByb21pc2UucmVzb2x2ZSh7dHlwZTptZX0pKSkpLmNhdGNoKCh0PT50LnJlc3BvbnNlJiY0MDA9PT10LnJlc3BvbnNlLnN0YXR1cz9zdChlKTpQcm9taXNlLnJlamVjdCh0KSkpOnN0KGUsdCl9Y29uc3QgbHQ9KGUsdCk9PntpZighZnQoTCx0KXx8MD09PWZ0KEwsdCkudHJpbSgpLmxlbmd0aClyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCJJbnZhbGlkIHRva2VuIGVuZHBvaW50IGZvdW5kLiIpKTtsZXQgbj0iIjtPYmplY3QuZW50cmllcyhlLmRhdGEpLm1hcCgoKFtyLG9dLHMpPT57Y29uc3QgaT0oKGUsdCk9PntsZXQgbj1uZTtyZXR1cm4gdC5zY29wZSYmdC5zY29wZS5sZW5ndGg+MCYmKHQuc2NvcGUuaW5jbHVkZXMobmUpfHx0LnNjb3BlLnB1c2gobmUpLG49dC5zY29wZS5qb2luKCIgIikpLGUucmVwbGFjZSgie3t0b2tlbn19IixmdChZLHQpKS5yZXBsYWNlKCJ7e3VzZXJuYW1lfX0iLGZ0KHBlLHQpKS5yZXBsYWNlKCJ7e3Njb3BlfX0iLG4pLnJlcGxhY2UoInt7Y2xpZW50SWR9fSIsdC5jbGllbnRJRCkucmVwbGFjZSgie3tjbGllbnRTZWNyZXR9fSIsdC5jbGllbnRTZWNyZXQpfSkobyx0KTtuKz1gJHtyfT0ke2l9JHtzIT09T2JqZWN0LmVudHJpZXMoZS5kYXRhKS5sZW5ndGgtMT8iJiI6IiJ9YH0pKTtjb25zdCByPXtkYXRhOm4saGVhZGVyczpPYmplY3QuYXNzaWduKHt9LHtBY2NlcHQ6ImFwcGxpY2F0aW9uL2pzb24iLCJDb250ZW50LVR5cGUiOiJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQifSksbWV0aG9kOiJQT1NUIix1cmw6ZnQoTCx0KX07cmV0dXJuIGUuYXR0YWNoVG9rZW4mJihyLmhlYWRlcnM9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHIuaGVhZGVycykse0F1dGhvcml6YXRpb246YEJlYXJlciAke2Z0KFksdCl9YH0pKSxCKHIpLnRoZW4oKG49PntpZigyMDAhPT1uLnN0YXR1cylyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCJJbnZhbGlkIHN0YXR1cyBjb2RlIHJlY2VpdmVkIGluIHRoZSB0b2tlbiByZXNwb25zZTogIituLnN0YXR1cykpO2lmKGUucmV0dXJuc1Nlc3Npb24pe2lmKHQudmFsaWRhdGVJRFRva2VuKXJldHVybiBpdChuLmRhdGEuaWRfdG9rZW4sdCkudGhlbigocj0+e2lmKHIpe2NvbnN0IHI9e2FjY2Vzc1Rva2VuOm4uZGF0YS5hY2Nlc3NfdG9rZW4sZXhwaXJlc0luOm4uZGF0YS5leHBpcmVzX2luLGlkVG9rZW46bi5kYXRhLmlkX3Rva2VuLHJlZnJlc2hUb2tlbjpuLmRhdGEucmVmcmVzaF90b2tlbixzY29wZTpuLmRhdGEuc2NvcGUsdG9rZW5UeXBlOm4uZGF0YS50b2tlbl90eXBlfTtyZXR1cm4gZ3QocixjdChyLmlkVG9rZW4pLHQpLGUucmV0dXJuUmVzcG9uc2U/UHJvbWlzZS5yZXNvbHZlKHtkYXRhOmR0KHQpLHR5cGU6bWV9KTpQcm9taXNlLnJlc29sdmUoITApfXJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoIkludmFsaWQgaWRfdG9rZW4gaW4gdGhlIHRva2VuIHJlc3BvbnNlOiAiK24uZGF0YS5pZF90b2tlbikpfSkpO3tjb25zdCByPXthY2Nlc3NUb2tlbjpuLmRhdGEuYWNjZXNzX3Rva2VuLGV4cGlyZXNJbjpuLmRhdGEuZXhwaXJlc19pbixpZFRva2VuOm4uZGF0YS5pZF90b2tlbixyZWZyZXNoVG9rZW46bi5kYXRhLnJlZnJlc2hfdG9rZW4sc2NvcGU6bi5kYXRhLnNjb3BlLHRva2VuVHlwZTpuLmRhdGEudG9rZW5fdHlwZX07cmV0dXJuIGd0KHIsY3Qoci5pZFRva2VuKSx0KSxlLnJldHVyblJlc3BvbnNlP1Byb21pc2UucmVzb2x2ZSh7ZGF0YTpkdCh0KSx0eXBlOm1lfSk6UHJvbWlzZS5yZXNvbHZlKCEwKX19cmV0dXJuIGUucmV0dXJuUmVzcG9uc2U/UHJvbWlzZS5yZXNvbHZlKG4pOlByb21pc2UucmVzb2x2ZSghMCl9KSkuY2F0Y2goKGU9PlByb21pc2UucmVqZWN0KGUpKSl9LGR0PWU9Pih7YWxsb3dlZFNjb3BlczpmdChzZSxlKSxkaXNwbGF5TmFtZTpmdChmZSxlKSxlbWFpbDpmdChoZSxlKSxzZXNzaW9uU3RhdGU6ZnQoaWUsZSksdGVuYW50RG9tYWluOmZ0KHVlLGUpLHVzZXJuYW1lOmZ0KHBlLGUpfSk7ZnVuY3Rpb24gcHQoZSx0KXtzd2l0Y2godC5zdG9yYWdlKXtjYXNlIHZlLldlYldvcmtlcjp0LnNlc3Npb24uZGVsZXRlKGUpO2JyZWFrO2Nhc2UgdmUuU2Vzc2lvblN0b3JhZ2U6c2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbShlKTticmVhaztjYXNlIHZlLkxvY2FsU3RvcmFnZTpsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShlKTticmVhaztkZWZhdWx0OnNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oZSl9fWZ1bmN0aW9uIGh0KGUsdCxuKXtzd2l0Y2gobi5zdG9yYWdlKXtjYXNlIHZlLldlYldvcmtlcjpuLnNlc3Npb24uc2V0KGUsdCk7YnJlYWs7Y2FzZSB2ZS5TZXNzaW9uU3RvcmFnZTpzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKGUsdCk7YnJlYWs7Y2FzZSB2ZS5Mb2NhbFN0b3JhZ2U6bG9jYWxTdG9yYWdlLnNldEl0ZW0oZSx0KTticmVhaztkZWZhdWx0OnNlc3Npb25TdG9yYWdlLnNldEl0ZW0oZSx0KX19ZnVuY3Rpb24gZnQoZSx0KXt2YXIgbjtzd2l0Y2godC5zdG9yYWdlKXtjYXNlIHZlLldlYldvcmtlcjpyZXR1cm4gbnVsbD09PShuPW51bGw9PXQ/dm9pZCAwOnQuc2Vzc2lvbil8fHZvaWQgMD09PW4/dm9pZCAwOm4uZ2V0KGUpO2Nhc2UgdmUuU2Vzc2lvblN0b3JhZ2U6cmV0dXJuIHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oZSk7Y2FzZSB2ZS5Mb2NhbFN0b3JhZ2U6cmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKGUpO2RlZmF1bHQ6cmV0dXJuIHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oZSl9fWZ1bmN0aW9uIG10KGUpe3l0KGUpLHB0KFksZSkscHQoWCxlKSxwdChRLGUpLHB0KGZlLGUpLHB0KGhlLGUpLHB0KHRlLGUpLHB0KG9lLGUpLHB0KHNlLGUpLHB0KHVlLGUpLHB0KGFlLGUpLHB0KHBlLGUpLHB0KGNlLGUpLHB0KGllLGUpfWZ1bmN0aW9uIGd0KGUsdCxuKXtodChZLGUuYWNjZXNzVG9rZW4sbiksaHQoWCxlLmV4cGlyZXNJbixuKSxodChRLChEYXRlLm5vdygpLzFlMykudG9TdHJpbmcoKSxuKSxodChmZSx0LmRpc3BsYXlOYW1lLG4pLGh0KGhlLHQuZW1haWwsbiksaHQodGUsZS5pZFRva2VuLG4pLGh0KHNlLGUuc2NvcGUsbiksaHQob2UsZS5yZWZyZXNoVG9rZW4sbiksaHQodWUsdC50ZW5hbnREb21haW4sbiksaHQoYWUsZS50b2tlblR5cGUsbiksaHQocGUsdC51c2VybmFtZSxuKSx2dChuKX1jb25zdCB2dD1lPT57Y29uc3QgdD1wYXJzZUludChmdChYLGUpKSxuPXQ8PTEwP3Q6dC0xMDt5dChlKTtjb25zdCByPXNldFRpbWVvdXQoKCgpPT57YXQoZSxmdChvZSxlKSl9KSwxZTMqbik7aHQoZGUsSlNPTi5zdHJpbmdpZnkociksZSl9LHl0PWU9PntpZihmdChkZSxlKSl7Y29uc3QgdD1KU09OLnBhcnNlKGZ0KGRlLGUpKTtjbGVhclRpbWVvdXQodCl9fSx3dD0oZSx0KT0+e2h0KE4sZSx0KX0sa3Q9KGUsdCk9PntodChMLGUsdCl9LFN0PShlLHQpPT57aHQoSixlLHQpfSxidD0oZSx0KT0+e2h0KEYsZSx0KX0sX3Q9KGUsdCk9PntodChLLGUsdCl9LEF0PWU9PntodCgkLCJ0cnVlIixlKX0sRXQ9KGUsdCk9PntodCh6LGUsdCl9LFB0PShlLHQpPT57aHQoRyxlLHQpfSxDdD0oZSx0KT0+e2h0KFYsZSx0KX0sSXQ9KGUsdCk9PntodChsZSxlLHQpfSxUdD1lPT57aHQoZWUsZS5jbGllbnRJRCxlKX0sanQ9KGUsdCk9Pnt2YXIgbjtpZighdCYmRHQoZSkpcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO2NvbnN0IHI9ZS5zZXJ2ZXJPcmlnaW47bGV0IG89citELndlbGxLbm93bjtyZXR1cm4obnVsbD09PShuPW51bGw9PWU/dm9pZCAwOmUuZW5kcG9pbnRzKXx8dm9pZCAwPT09bj92b2lkIDA6bi53ZWxsS25vd24pJiYobz1lLmVuZHBvaW50cy53ZWxsS25vd24pLEIuZ2V0KG8pLnRoZW4oKHQ9Pnt2YXIgbixvLHMsaSxhLGMsdSxsLGQscCxoLGY7cmV0dXJuIDIwMCE9PXQuc3RhdHVzP1Byb21pc2UucmVqZWN0KG5ldyBFcnJvcigiRmFpbGVkIHRvIGxvYWQgT3BlbklEIHByb3ZpZGVyIGNvbmZpZ3VyYXRpb24gZnJvbTogIityK0Qud2VsbEtub3duKSk6KCgoZSx0KT0+e2h0KCJvcGVuX2lkX2NvbmZpZyIsSlNPTi5zdHJpbmdpZnkoZSksdCl9KSh0LmRhdGEsZSksKG51bGw9PT0obj1udWxsPT1lP3ZvaWQgMDplLmVuZHBvaW50cyl8fHZvaWQgMD09PW4/dm9pZCAwOm4uYXV0aG9yaXplKT93dChudWxsPT09KG89bnVsbD09ZT92b2lkIDA6ZS5lbmRwb2ludHMpfHx2b2lkIDA9PT1vP3ZvaWQgMDpvLmF1dGhvcml6ZSxlKTp3dCh0LmRhdGEuYXV0aG9yaXphdGlvbl9lbmRwb2ludCxlKSwobnVsbD09PShzPW51bGw9PWU/dm9pZCAwOmUuZW5kcG9pbnRzKXx8dm9pZCAwPT09cz92b2lkIDA6cy50b2tlbik/a3QobnVsbD09PShpPW51bGw9PWU/dm9pZCAwOmUuZW5kcG9pbnRzKXx8dm9pZCAwPT09aT92b2lkIDA6aS50b2tlbixlKTprdCh0LmRhdGEudG9rZW5fZW5kcG9pbnQsZSksKG51bGw9PT0oYT1udWxsPT1lP3ZvaWQgMDplLmVuZHBvaW50cyl8fHZvaWQgMD09PWE/dm9pZCAwOmEuandrcyk/YnQobnVsbD09PShjPW51bGw9PWU/dm9pZCAwOmUuZW5kcG9pbnRzKXx8dm9pZCAwPT09Yz92b2lkIDA6Yy5qd2tzLGUpOmJ0KHQuZGF0YS5qd2tzX3VyaSxlKSwobnVsbD09PSh1PW51bGw9PWU/dm9pZCAwOmUuZW5kcG9pbnRzKXx8dm9pZCAwPT09dT92b2lkIDA6dS5sb2dvdXQpP1N0KG51bGw9PT0obD1udWxsPT1lP3ZvaWQgMDplLmVuZHBvaW50cyl8fHZvaWQgMD09PWw/dm9pZCAwOmwubG9nb3V0LGUpOlN0KHQuZGF0YS5lbmRfc2Vzc2lvbl9lbmRwb2ludCxlKSwobnVsbD09PShkPW51bGw9PWU/dm9pZCAwOmUuZW5kcG9pbnRzKXx8dm9pZCAwPT09ZD92b2lkIDA6ZC5yZXZva2UpP190KG51bGw9PT0ocD1udWxsPT1lP3ZvaWQgMDplLmVuZHBvaW50cyl8fHZvaWQgMD09PXA/dm9pZCAwOnAucmV2b2tlLGUpOl90KHQuZGF0YS50b2tlbl9lbmRwb2ludC5zdWJzdHJpbmcoMCx0LmRhdGEudG9rZW5fZW5kcG9pbnQubGFzdEluZGV4T2YoInRva2VuIikpKyJyZXZva2UiLGUpLEl0KHQuZGF0YS5pc3N1ZXIsZSksVHQoZSksKG51bGw9PT0oaD1udWxsPT1lP3ZvaWQgMDplLmVuZHBvaW50cyl8fHZvaWQgMD09PWg/dm9pZCAwOmgub2lkY1Nlc3Npb25JRnJhbWUpP0N0KG51bGw9PT0oZj1udWxsPT1lP3ZvaWQgMDplLmVuZHBvaW50cyl8fHZvaWQgMD09PWY/dm9pZCAwOmYub2lkY1Nlc3Npb25JRnJhbWUsZSk6Q3QodC5kYXRhLmNoZWNrX3Nlc3Npb25faWZyYW1lLGUpLEV0KGUuc2lnbkluUmVkaXJlY3RVUkwsZSksUHQoZS5zaWduT3V0UmVkaXJlY3RVUkwsZSksQXQoZSksUHJvbWlzZS5yZXNvbHZlKCJJbml0aWFsaXplZCBPcGVuSUQgUHJvdmlkZXIgY29uZmlndXJhdGlvbiBmcm9tOiAiK3IrRC53ZWxsS25vd24pKX0pKS5jYXRjaCgoKCk9Pnt2YXIgdCxuLG8scyxpLGEsYztyZXR1cm4gd3QoZS5zZXJ2ZXJPcmlnaW4rKChudWxsPT09KHQ9bnVsbD09ZT92b2lkIDA6ZS5lbmRwb2ludHMpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmF1dGhvcml6ZSl8fEQuYXV0aG9yaXplKSxlKSxrdChlLnNlcnZlck9yaWdpbisoKG51bGw9PT0obj1udWxsPT1lP3ZvaWQgMDplLmVuZHBvaW50cyl8fHZvaWQgMD09PW4/dm9pZCAwOm4udG9rZW4pfHxELnRva2VuKSxlKSxfdChlLnNlcnZlck9yaWdpbisoKG51bGw9PT0obz1udWxsPT1lP3ZvaWQgMDplLmVuZHBvaW50cyl8fHZvaWQgMD09PW8/dm9pZCAwOm8ucmV2b2tlKXx8RC5yZXZva2UpLGUpLFN0KGUuc2VydmVyT3JpZ2luKygobnVsbD09PShzPW51bGw9PWU/dm9pZCAwOmUuZW5kcG9pbnRzKXx8dm9pZCAwPT09cz92b2lkIDA6cy5sb2dvdXQpfHxELmxvZ291dCksZSksYnQocisoKG51bGw9PT0oaT1udWxsPT1lP3ZvaWQgMDplLmVuZHBvaW50cyl8fHZvaWQgMD09PWk/dm9pZCAwOmkuandrcyl8fEQuandrcyksZSksSXQoZS5zZXJ2ZXJPcmlnaW4rKChudWxsPT09KGE9bnVsbD09ZT92b2lkIDA6ZS5lbmRwb2ludHMpfHx2b2lkIDA9PT1hP3ZvaWQgMDphLnRva2VuKXx8RC50b2tlbiksZSksVHQoZSksQ3QoZS5zZXJ2ZXJPcmlnaW4rKChudWxsPT09KGM9bnVsbD09ZT92b2lkIDA6ZS5lbmRwb2ludHMpfHx2b2lkIDA9PT1jP3ZvaWQgMDpjLm9pZGNTZXNzaW9uSUZyYW1lKXx8RC5vaWRjU2Vzc2lvbklGcmFtZSksZSksRXQoZS5zaWduSW5SZWRpcmVjdFVSTCxlKSxQdChlLnNpZ25PdXRSZWRpcmVjdFVSTCxlKSxBdChlKSxQcm9taXNlLnJlc29sdmUobmV3IEVycm9yKCJJbml0aWFsaXplZCBPcGVuSUQgUHJvdmlkZXIgY29uZmlndXJhdGlvbiBmcm9tIGRlZmF1bHQgY29uZmlndXJhdGlvbi5CZWNhdXNlIGZhaWxlZCB0byBhY2Nlc3Mgd2VsbGtub3duIGVuZHBvaW50OiAiK3IrRC53ZWxsS25vd24pKX0pKX0sUnQ9ZT0+e2Uuc3RvcmFnZSE9PXZlLldlYldvcmtlcj8ocHQoTixlKSxwdChMLGUpLHB0KEosZSkscHQoRixlKSxwdChLLGUpLHB0KCQsZSkscHQobGUsZSkscHQoZWUsZSkscHQoInRlbmFudCIsZSkscHQoeixlKSxwdChHLGUpLHB0KFYsZSkpOmUuc2Vzc2lvbi5jbGVhcigpfSx4dD1lPT5mdChOLGUpLE90PWU9PmZ0KEwsZSksSHQ9ZT0+ZnQoSyxlKSxxdD1lPT5mdChWLGUpLE10PWU9PmZ0KEosZSksVXQ9ZT0+ZnQoRixlKSxXdD1lPT5mdChsZSxlKSxCdD1lPT5mdChlZSxlKSxEdD1lPT4oZT0+ZS5zdG9yYWdlIT09dmUuV2ViV29ya2VyP2Z0KCQsZSkmJiJ0cnVlIj09PWZ0KCQsZSk6ZS5zZXNzaW9uLmdldCgkKSYmInRydWUiPT09ZS5zZXNzaW9uLmdldCgkKSkoZSkmJiEhQnQoZSkmJkJ0KGUpPT09ZS5jbGllbnRJRDtmdW5jdGlvbiBOdChlKXt2YXIgdDtyZXR1cm4gZS5zdG9yYWdlPT09dmUuU2Vzc2lvblN0b3JhZ2UmJjA9PT1zZXNzaW9uU3RvcmFnZS5sZW5ndGh8fGUuc3RvcmFnZT09PXZlLkxvY2FsU3RvcmFnZSYmMD09PWxvY2FsU3RvcmFnZS5sZW5ndGh8fHJ0KGUpJiYwPT09KG51bGw9PT0odD1udWxsPT1lP3ZvaWQgMDplLnNlc3Npb24pfHx2b2lkIDA9PT10P3ZvaWQgMDp0LnNpemUpP1Byb21pc2UucmVqZWN0KG5ldyBFcnJvcigiTm8gbG9naW4gc2Vzc2lvbnMuIikpOmZ1bmN0aW9uKGUpe2NvbnN0IHQ9TXQoZSk7aWYoIXR8fDA9PT10LnRyaW0oKS5sZW5ndGgpcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcigiTm8gbG9nb3V0IGVuZHBvaW50IGZvdW5kIGluIHRoZSBzZXNzaW9uLiIpKTtjb25zdCBuPWZ0KHRlLGUpO2lmKCFufHwwPT09bi50cmltKCkubGVuZ3RoKXJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoIkludmFsaWQgaWRfdG9rZW4gZm91bmQgaW4gdGhlIHNlc3Npb24uIikpO2NvbnN0IHI9ZnQoRyxlKTtpZighcnx8MD09PXIudHJpbSgpLmxlbmd0aClyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCJObyBjYWxsYmFjayBVUkwgZm91bmQgaW4gdGhlIHNlc3Npb24uIikpO210KGUpLFJ0KGUpO2NvbnN0IG89YCR7dH0/aWRfdG9rZW5faGludD0ke259JnBvc3RfbG9nb3V0X3JlZGlyZWN0X3VyaT0ke3J9JnN0YXRlPWxvZ291dF9zdWNjZXNzYDtyZXR1cm4gcnQoZSk/UHJvbWlzZS5yZXNvbHZlKG8pOih3aW5kb3cubG9jYXRpb24uaHJlZj1vLFByb21pc2UucmVzb2x2ZSghMCkpfShlKX1jb25zdCBMdD0oKCk9PntsZXQgZSx0LG47Y29uc3Qgcj1uZXcgTWFwLG89KCk9PiEhci5nZXQoWSkscz0oKT0+ISFyLmdldChZKSxpPXQ9PmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGZ0KFksZSk/RHQoZSk/UHJvbWlzZS5yZXNvbHZlKHt0eXBlOm1lfSk6KG10KGUpLFJ0KGUpLHB0KCJhdXRoX2NhbGxiYWNrX3VybCIsZSksanQoZSwhMCkudGhlbigoKCk9PnV0KGUsdCkpKS5jYXRjaCgoZT0+UHJvbWlzZS5yZWplY3QoZSkpKSk6anQoZSwhMSkudGhlbigoKCk9PnV0KGUsdCkpKS5jYXRjaCgoZT0+UHJvbWlzZS5yZWplY3QoZSkpKX0oZSx0KS50aGVuKCh0PT57aWYodC50eXBlPT09bWUpe2NvbnN0IG49TXQoZSk7aWYoIW58fDA9PT1uLnRyaW0oKS5sZW5ndGgpcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcigiTm8gbG9nb3V0IGVuZHBvaW50IGZvdW5kIGluIHRoZSBzZXNzaW9uLiIpKTtjb25zdCBvPWZ0KHRlLGUpO2lmKCFvfHwwPT09by50cmltKCkubGVuZ3RoKXJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoIkludmFsaWQgaWRfdG9rZW4gZm91bmQgaW4gdGhlIHNlc3Npb24uIikpO2NvbnN0IHM9ZnQoRyxlKTtpZighc3x8MD09PXMudHJpbSgpLmxlbmd0aClyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCJObyBjYWxsYmFjayBVUkwgZm91bmQgaW4gdGhlIHNlc3Npb24uIikpO2NvbnN0IGk9YCR7bn0/aWRfdG9rZW5faGludD0ke299JnBvc3RfbG9nb3V0X3JlZGlyZWN0X3VyaT0ke3N9YDtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtkYXRhOnthbGxvd2VkU2NvcGVzOnIuZ2V0KHNlKSxkaXNwbGF5TmFtZTpyLmdldChmZSksZW1haWw6ci5nZXQoaGUpLGxvZ291dFVybDppLHNlc3Npb25TdGF0ZTpyLmdldChpZSksdGVuYW50RG9tYWluOnIuZ2V0KHVlKSx1c2VybmFtZTpyLmdldChwZSl9LHR5cGU6dC50eXBlfSl9cmV0dXJuIFByb21pc2UucmVzb2x2ZSh0KX0pKS5jYXRjaCgoZT0+UHJvbWlzZS5yZWplY3QoZSkpKSxhPSgpPT5hdChlLHIuZ2V0KFkpKSxjPSgpPT5OdChlKSx1PSgpPT5mdW5jdGlvbihlLHQpe2NvbnN0IG49SHQoZSk7aWYoIW58fDA9PT1uLnRyaW0oKS5sZW5ndGgpcmV0dXJuIFByb21pc2UucmVqZWN0KCJJbnZhbGlkIHJldm9rZSB0b2tlbiBlbmRwb2ludCBmb3VuZC4iKTtjb25zdCByPVtdO3JldHVybiByLnB1c2goYGNsaWVudF9pZD0ke2UuY2xpZW50SUR9YCksci5wdXNoKGB0b2tlbj0ke3R9YCksci5wdXNoKCJ0b2tlbl90eXBlX2hpbnQ9YWNjZXNzX3Rva2VuIiksQi5wb3N0KG4sci5qb2luKCImIikse2hlYWRlcnM6e0FjY2VwdDoiYXBwbGljYXRpb24vanNvbiIsIkNvbnRlbnQtVHlwZSI6ImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCJ9LHdpdGhDcmVkZW50aWFsczohMH0pLnRoZW4oKGU9PjIwMCE9PWUuc3RhdHVzP1Byb21pc2UucmVqZWN0KG5ldyBFcnJvcigiSW52YWxpZCBzdGF0dXMgY29kZSByZWNlaXZlZCBpbiB0aGUgcmV2b2tlIHRva2VuIHJlc3BvbnNlOiAiK2Uuc3RhdHVzKSk6UHJvbWlzZS5yZXNvbHZlKGUpKSkuY2F0Y2goKGU9PlByb21pc2UucmVqZWN0KGUpKSl9KGUsci5nZXQoWSkpLnRoZW4oKCgpPT4obXQoZSksUnQoZSksUHJvbWlzZS5yZXNvbHZlKCEwKSkpKS5jYXRjaCgoZT0+UHJvbWlzZS5yZWplY3QoZSkpKSxsPShlLHQsbik9PntlJiZyLnNldChaLGUpLHQmJnIuc2V0KGllLHQpLHIuc2V0KHJlLG4pfSxkPW49PntsZXQgcj0hMTtyZXR1cm4gZS5iYXNlVXJscy5mb3JFYWNoKChlPT57dmFyIHQ7KG51bGw9PT0odD1udWxsPT1uP3ZvaWQgMDpuLnVybCl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuc3RhcnRzV2l0aChlKSkmJihyPSEwKX0pKSxyP3QucmVxdWVzdChuKS50aGVuKChlPT5Qcm9taXNlLnJlc29sdmUoZSkpKS5jYXRjaCgoZT0+e3ZhciByO3JldHVybiA0MDE9PT0obnVsbD09PShyPW51bGw9PWU/dm9pZCAwOmUucmVzcG9uc2UpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLnN0YXR1cyk/YSgpLnRoZW4oKCgpPT50KG4pLnRoZW4oKGU9PlByb21pc2UucmVzb2x2ZShlKSkpLmNhdGNoKChlPT5Qcm9taXNlLnJlamVjdChlKSkpKSkuY2F0Y2goKCgpPT5Qcm9taXNlLnJlamVjdCgiQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgcmVmcmVzaGluZyB0aGUgYWNjZXNzIHRva2VuLiBUaGUgYWNjZXNzIHRva2VuIGlzIG5vIG1vcmUgdmFsaWQgYW5kIHJlLWF1dGhlbnRpY2F0aW9uIGlzIHJlcXVpcmVkLiIpKSk6UHJvbWlzZS5yZWplY3QoZSl9KSk6UHJvbWlzZS5yZWplY3QoIlRoZSBwcm92aWRlZCBVUkwgaXMgaWxsZWdhbC4iKX0scD1uPT57bGV0IHI9ITE7ZS5iYXNlVXJscy5mb3JFYWNoKChlPT57bi5ldmVyeSgodD0+dC51cmwuc3RhcnRzV2l0aChlKSkpJiYocj0hMCl9KSk7Y29uc3Qgbz1uLm1hcCgoZT0+dC5yZXF1ZXN0KGUpKSk7cmV0dXJuIHI/Qi5hbGwobykudGhlbigoZT0+UHJvbWlzZS5yZXNvbHZlKGUpKSkuY2F0Y2goKGU9Pnt2YXIgdDtyZXR1cm4gNDAxPT09KG51bGw9PT0odD1udWxsPT1lP3ZvaWQgMDplLnJlc3BvbnNlKXx8dm9pZCAwPT09dD92b2lkIDA6dC5zdGF0dXMpP2EoKS50aGVuKCgoKT0+Qi5hbGwobykudGhlbigoZT0+UHJvbWlzZS5yZXNvbHZlKGUpKSkuY2F0Y2goKGU9PlByb21pc2UucmVqZWN0KGUpKSkpKS5jYXRjaCgoKCk9PlByb21pc2UucmVqZWN0KCJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSByZWZyZXNoaW5nIHRoZSBhY2Nlc3MgdG9rZW4uIFRoZSBhY2Nlc3MgdG9rZW4gaXMgbm8gbW9yZSB2YWxpZCBhbmQgcmUtYXV0aGVudGljYXRpb24gaXMgcmVxdWlyZWQuIikpKTpQcm9taXNlLnJlamVjdChlKX0pKTpQcm9taXNlLnJlamVjdCgiVGhlIHByb3ZpZGVkIFVSTCBpcyBpbGxlZ2FsLiIpfSxoPXQ9Pmx0KHQsZSksZj0oKT0+ZHQoZSksbT0oKT0+UHJvbWlzZS5yZXNvbHZlKChlPT4oe2F1dGhvcml6ZTp4dChlKSxqd2tzOlV0KGUpLGxvZ291dDpNdChlKSxvaWRjU2Vzc2lvbklGcmFtZTpxdChlKSxyZXZva2U6SHQoZSksdG9rZW46T3QoZSksd2VsbEtub3duOkQud2VsbEtub3dufSkpKGUpKSxnPSgpPT4oZT0+e2NvbnN0IHQ9ZnQodGUsZSk7cmV0dXJuIEpTT04ucGFyc2UoYXRvYih0LnNwbGl0KCIuIilbMV0pKX0pKGUpO3JldHVybntnZXRJbnN0YW5jZTp2PT5ufHwobj1mdW5jdGlvbihuKXt2YXIgdix5LHcsayxTLGI7cmV0dXJuIGU9T2JqZWN0LmFzc2lnbih7fSxuKSxyLmNsZWFyKCksZS5zZXNzaW9uPXIsZS5hdXRob3JpemF0aW9uQ29kZSYmci5zZXQoWixlLmF1dGhvcml6YXRpb25Db2RlKSxlLnNlc3Npb25TdGF0ZSYmci5zZXQoaWUsZS5zZXNzaW9uU3RhdGUpLHQ9U2UuZ2V0SW5zdGFuY2UoKSx0LmluaXQoITAsKGU9Pnt2YXIgdCxvO2UuaGVhZGVycz1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZS5oZWFkZXJzKSx7QXV0aG9yaXphdGlvbjpgQmVhcmVyICR7bnVsbD09cj92b2lkIDA6ci5nZXQoWSl9YH0pLChudWxsPT09KHQ9bi5odHRwQ2xpZW50KXx8dm9pZCAwPT09dD92b2lkIDA6dC5yZXF1ZXN0U3RhcnRDYWxsYmFjaykmJihudWxsPT09KG89bi5odHRwQ2xpZW50KXx8dm9pZCAwPT09b3x8by5yZXF1ZXN0U3RhcnRDYWxsYmFjaygpKX0pLG51bGwhPT0oeT1udWxsPT09KHY9bi5odHRwQ2xpZW50KXx8dm9pZCAwPT09dj92b2lkIDA6di5yZXF1ZXN0U3VjY2Vzc0NhbGxiYWNrKSYmdm9pZCAwIT09eT95Om51bGwsbnVsbCE9PShrPW51bGw9PT0odz1uLmh0dHBDbGllbnQpfHx2b2lkIDA9PT13P3ZvaWQgMDp3LnJlcXVlc3RFcnJvckNhbGxiYWNrKSYmdm9pZCAwIT09az9rOm51bGwsbnVsbCE9PShiPW51bGw9PT0oUz1uLmh0dHBDbGllbnQpfHx2b2lkIDA9PT1TP3ZvaWQgMDpTLnJlcXVlc3RGaW5pc2hDYWxsYmFjaykmJnZvaWQgMCE9PWI/YjpudWxsKSx7Y3VzdG9tR3JhbnQ6aCxkb2VzVG9rZW5FeGlzdDpzLGVuZFVzZXJTZXNzaW9uOnUsZ2V0RGVjb2RlZElEVG9rZW46ZyxnZXRTZXJ2aWNlRW5kcG9pbnRzOm0sZ2V0VXNlckluZm86ZixodHRwUmVxdWVzdDpkLGh0dHBSZXF1ZXN0QWxsOnAsaXNTaWduZWRJbjpvLHJlZnJlc2hBY2Nlc3NUb2tlbjphLHNldEF1dGhDb2RlOmwsc2lnbkluOmksc2lnbk91dDpjfX0odiksbil9fSkoKSxLdD1zZWxmO2xldCBKdDtLdC5vbm1lc3NhZ2U9KHtkYXRhOmUscG9ydHM6dH0pPT57dmFyIG4scixvLHM7Y29uc3QgaT10WzBdO3N3aXRjaChlLnR5cGUpe2Nhc2UiaW5pdCI6dHJ5e2NvbnN0IHQ9T2JqZWN0LmFzc2lnbih7fSxlLmRhdGEpO3QuaHR0cENsaWVudD1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdC5odHRwQ2xpZW50KSx7cmVxdWVzdEVycm9yQ2FsbGJhY2s6R3QscmVxdWVzdEZpbmlzaENhbGxiYWNrOnp0LHJlcXVlc3RTdGFydENhbGxiYWNrOkZ0LHJlcXVlc3RTdWNjZXNzQ2FsbGJhY2s6JHR9KSxKdD1MdC5nZXRJbnN0YW5jZSh0KSxpLnBvc3RNZXNzYWdlKHR0KCkpfWNhdGNoKGUpe2kucG9zdE1lc3NhZ2UobnQoZSkpfWJyZWFrO2Nhc2Uic2lnbi1pbiI6SnQ/KCgobnVsbD09PShuPW51bGw9PWU/dm9pZCAwOmUuZGF0YSl8fHZvaWQgMD09PW4/dm9pZCAwOm4uY29kZSl8fChudWxsPT09KHI9bnVsbD09ZT92b2lkIDA6ZS5kYXRhKXx8dm9pZCAwPT09cj92b2lkIDA6ci5wa2NlKSkmJkp0LnNldEF1dGhDb2RlKGUuZGF0YS5jb2RlLG51bGw9PT0obz1udWxsPT1lP3ZvaWQgMDplLmRhdGEpfHx2b2lkIDA9PT1vP3ZvaWQgMDpvLnNlc3Npb25TdGF0ZSxudWxsPT09KHM9bnVsbD09ZT92b2lkIDA6ZS5kYXRhKXx8dm9pZCAwPT09cz92b2lkIDA6cy5wa2NlKSxKdC5zaWduSW4oInN0cmluZyI9PXR5cGVvZihudWxsPT1lP3ZvaWQgMDplLmRhdGEpJiYobnVsbD09ZT92b2lkIDA6ZS5kYXRhKSkudGhlbigoZT0+e2UudHlwZT09PW1lP2kucG9zdE1lc3NhZ2UodHQoe2RhdGE6ZS5kYXRhLHR5cGU6bWV9KSk6aS5wb3N0TWVzc2FnZSh0dCh7Y29kZTplLmNvZGUscGtjZTplLnBrY2UsdHlwZTpnZX0pKX0pKS5jYXRjaCgoZT0+e2kucG9zdE1lc3NhZ2UobnQoZSkpfSkpKTppLnBvc3RNZXNzYWdlKG50KCJXb3JrZXIgaGFzIG5vdCBiZWVuIGluaXRpYXRlZC4iKSk7YnJlYWs7Y2FzZSJhcGktY2FsbCI6aWYoIUp0KXtpLnBvc3RNZXNzYWdlKG50KCJXb3JrZXIgaGFzIG5vdCBiZWVuIGluaXRpYXRlZC4iKSk7YnJlYWt9SnQuaXNTaWduZWRJbigpP0p0Lmh0dHBSZXF1ZXN0KGUuZGF0YSkudGhlbigoZT0+e2kucG9zdE1lc3NhZ2UodHQoZSkpfSkpLmNhdGNoKChlPT57aS5wb3N0TWVzc2FnZShudChlKSl9KSk6aS5wb3N0TWVzc2FnZShudCgiWW91IGhhdmUgbm90IHNpZ25lZCBpbiB5ZXQuIikpO2JyZWFrO2Nhc2UiYXBpLWNhbGwtYWxsIjppZighSnQpe2kucG9zdE1lc3NhZ2UobnQoIldvcmtlciBoYXMgbm90IGJlZW4gaW5pdGlhdGVkLiIpKTticmVha31KdC5pc1NpZ25lZEluKCk/SnQuaHR0cFJlcXVlc3RBbGwoZS5kYXRhKS50aGVuKChlPT57aS5wb3N0TWVzc2FnZSh0dChlKSl9KSkuY2F0Y2goKGU9PntpLnBvc3RNZXNzYWdlKG50KGUpKX0pKTppLnBvc3RNZXNzYWdlKG50KCJZb3UgaGF2ZSBub3Qgc2lnbmVkIGluIHlldC4iKSk7YnJlYWs7Y2FzZSJsb2dvdXQiOmlmKCFKdCl7aS5wb3N0TWVzc2FnZShudCgiV29ya2VyIGhhcyBub3QgYmVlbiBpbml0aWF0ZWQuIikpO2JyZWFrfUp0LmlzU2lnbmVkSW4oKT9KdC5zaWduT3V0KCkudGhlbigoZT0+e2U/aS5wb3N0TWVzc2FnZSh0dChlKSk6aS5wb3N0TWVzc2FnZShudCgiUmVjZWl2ZWQgbm8gcmVzcG9uc2UiKSl9KSkuY2F0Y2goKGU9PntpLnBvc3RNZXNzYWdlKG50KGUpKX0pKTppLnBvc3RNZXNzYWdlKG50KCJZb3UgaGF2ZSBub3Qgc2lnbmVkIGluIHlldC4iKSk7YnJlYWs7Y2FzZSJjdXN0b20tZ3JhbnQiOmlmKCFKdCl7aS5wb3N0TWVzc2FnZShudCgiV29ya2VyIGhhcyBub3QgYmVlbiBpbml0aWF0ZWQuIikpO2JyZWFrfWlmKCFKdC5pc1NpZ25lZEluKCkmJmUuZGF0YS5zaWduSW5SZXF1aXJlZCl7aS5wb3N0TWVzc2FnZShudCgiWW91IGhhdmUgbm90IHNpZ25lZCBpbiB5ZXQuIikpO2JyZWFrfUp0LmN1c3RvbUdyYW50KGUuZGF0YSkudGhlbigoZT0+e2kucG9zdE1lc3NhZ2UodHQoZSkpfSkpLmNhdGNoKChlPT57aS5wb3N0TWVzc2FnZShudChlKSl9KSk7YnJlYWs7Y2FzZSJlbmQtdXNlci1zZXNzaW9uIjppZighSnQpe2kucG9zdE1lc3NhZ2UobnQoIldvcmtlciBoYXMgbm90IGJlZW4gaW5pdGlhdGVkLiIpKTticmVha31pZighSnQuaXNTaWduZWRJbigpJiZlLmRhdGEuc2lnbkluUmVxdWlyZWQpe2kucG9zdE1lc3NhZ2UobnQoIllvdSBoYXZlIG5vdCBzaWduZWQgaW4geWV0LiIpKTticmVha31KdC5lbmRVc2VyU2Vzc2lvbigpLnRoZW4oKGU9PntpLnBvc3RNZXNzYWdlKHR0KGUpKX0pKS5jYXRjaCgoZT0+e2kucG9zdE1lc3NhZ2UobnQoZSkpfSkpO2JyZWFrO2Nhc2UiZ2V0LXNlcnZpY2UtZW5kcG9pbnRzIjppZighSnQpe2kucG9zdE1lc3NhZ2UobnQoIldvcmtlciBoYXMgbm90IGJlZW4gaW5pdGlhdGVkLiIpKTticmVha31KdC5nZXRTZXJ2aWNlRW5kcG9pbnRzKCkudGhlbigoZT0+e2kucG9zdE1lc3NhZ2UodHQoZSkpfSkpLmNhdGNoKChlPT57aS5wb3N0TWVzc2FnZShudChlKSl9KSk7YnJlYWs7Y2FzZSJnZXQtdXNlci1pbmZvIjppZighSnQpe2kucG9zdE1lc3NhZ2UobnQoIldvcmtlciBoYXMgbm90IGJlZW4gaW5pdGlhdGVkLiIpKTticmVha31pZighSnQuaXNTaWduZWRJbigpJiZlLmRhdGEuc2lnbkluUmVxdWlyZWQpe2kucG9zdE1lc3NhZ2UobnQoIllvdSBoYXZlIG5vdCBzaWduZWQgaW4geWV0LiIpKTticmVha310cnl7aS5wb3N0TWVzc2FnZSh0dChKdC5nZXRVc2VySW5mbygpKSl9Y2F0Y2goZSl7aS5wb3N0TWVzc2FnZShudChlKSl9YnJlYWs7Y2FzZSJnZXQtZGVjb2RlZC1pZC10b2tlbiI6aWYoIUp0KXtpLnBvc3RNZXNzYWdlKG50KCJXb3JrZXIgaGFzIG5vdCBiZWVuIGluaXRpYXRlZC4iKSk7YnJlYWt9aWYoIUp0LmlzU2lnbmVkSW4oKSYmZS5kYXRhLnNpZ25JblJlcXVpcmVkKXtpLnBvc3RNZXNzYWdlKG50KCJZb3UgaGF2ZSBub3Qgc2lnbmVkIGluIHlldC4iKSk7YnJlYWt9dHJ5e2kucG9zdE1lc3NhZ2UodHQoSnQuZ2V0RGVjb2RlZElEVG9rZW4oKSkpfWNhdGNoKGUpe2kucG9zdE1lc3NhZ2UobnQoZSkpfWJyZWFrO2RlZmF1bHQ6bnVsbD09aXx8aS5wb3N0TWVzc2FnZShudChgVW5rbm93biBtZXNzYWdlIHR5cGUgJHtudWxsPT1lP3ZvaWQgMDplLnR5cGV9YCkpfX07Y29uc3QgRnQ9KCk9PntLdC5wb3N0TWVzc2FnZSh7dHlwZToicmVxdWVzdC1zdGFydCJ9KX0sJHQ9ZT0+e0t0LnBvc3RNZXNzYWdlKHtkYXRhOkpTT04uc3RyaW5naWZ5KG51bGwhPWU/ZToiIiksdHlwZToicmVxdWVzdC1zdWNjZXNzIn0pfSx6dD0oKT0+e0t0LnBvc3RNZXNzYWdlKHt0eXBlOiJyZXF1ZXN0LWZpbmlzaCJ9KX0sR3Q9ZT0+e2NvbnN0IHQ9T2JqZWN0LmFzc2lnbih7fSxlKTtkZWxldGUgdC50b0pTT04sS3QucG9zdE1lc3NhZ2Uoe2RhdGE6SlNPTi5zdHJpbmdpZnkobnVsbCE9dD90OiIiKSx0eXBlOiJyZXF1ZXN0LWVycm9yIn0pfTtyZXR1cm57fX0oKTsKCg==",yl=null,Il=!1,function(e){return Vl=Vl||Xl(Sl,yl,Il),new Worker(Vl,e)});const Yl=(()=>{let t,l,i,n,o=!1,c=!1;const s=e=>{const l=new MessageChannel;return t.postMessage(e,[l.port2]),new Promise(((e,t)=>{const i=setTimeout((()=>{t("Operation timed out")}),n);return l.port1.onmessage=({data:l})=>{if(clearTimeout(i),null==l?void 0:l.success){const t=JSON.parse(null==l?void 0:l.data);(null==l?void 0:l.blob)&&(t.data=null==l?void 0:l.blob),e(t)}else t(JSON.parse(l.error))}}))},a=e=>{if(!o)return Promise.reject("The object has not been initialized yet");if(!c&&e.signInRequired)return Promise.reject("You have not signed in yet");return s({data:e,type:z}).then((e=>Promise.resolve(e))).catch((e=>Promise.reject(e)))},d=e=>{if(!o)return Promise.reject("The object has not been initialized yet");if(!c)return Promise.reject("You have not signed in yet");return s({data:e,type:F}).then((e=>Promise.resolve(e))).catch((e=>Promise.reject(e)))},r=e=>{if(!o)return Promise.reject("The object has not been initialized yet");if(!c)return Promise.reject("You have not signed in yet");return s({data:e,type:x}).then((e=>Promise.resolve(e))).catch((e=>Promise.reject(e)))},u=l=>{var c;if(l.authorizationType&&"string"!=typeof l.authorizationType)return Promise.reject("The authorizationType must be a string");if(!(l.baseUrls instanceof Array))return Promise.reject("baseUrls must be an array");if(l.baseUrls.find((e=>"string"!=typeof e)))return Promise.reject("Array elements of baseUrls must all be string values");if("string"!=typeof l.signInRedirectURL)return Promise.reject("The sign-in redirect URL must be a string");if("string"!=typeof l.signOutRedirectURL)return Promise.reject("The sign-out redirect URL must be a string");if("string"!=typeof l.clientHost)return Promise.reject("The clientHost must be a string");if("string"!=typeof l.clientID)return Promise.reject("The clientID must be a string");if(l.clientSecret&&"string"!=typeof l.clientSecret)return Promise.reject("The clientString must be a string");if(l.consentDenied&&"boolean"!=typeof l.consentDenied)return Promise.reject("consentDenied must be a boolean");if(l.enablePKCE&&"boolean"!=typeof l.enablePKCE)return Promise.reject("enablePKCE must be a boolean");if(l.prompt&&"string"!=typeof l.prompt)return Promise.reject("The prompt must be a string");if(l.responseMode&&"string"!=typeof l.responseMode)return Promise.reject("The responseMode must be a string");if(l.responseMode&&l.responseMode!==e.ResponseMode.formPost&&l.responseMode!==e.ResponseMode.query)return Promise.reject("The responseMode is invalid");if(l.scope&&!(l.scope instanceof Array))return Promise.reject("scope must be an array");if(l.scope&&l.scope.find((e=>"string"!=typeof e)))return Promise.reject("Array elements of scope must all be string values");if("string"!=typeof l.serverOrigin)return Promise.reject("serverOrigin must be a string");i={isHandlerEnabled:!0,requestErrorCallback:null,requestFinishCallback:null,requestStartCallback:null,requestSuccessCallback:null},n=null!==(c=null==l?void 0:l.requestTimeout)&&void 0!==c?c:6e4,t.onmessage=({data:e})=>{var t,l;switch(e.type){case j:(null==i?void 0:i.requestErrorCallback)&&(null==i||i.requestErrorCallback(JSON.parse(null!==(t=e.data)&&void 0!==t?t:"")));break;case B:(null==i?void 0:i.requestFinishCallback)&&(null==i||i.requestFinishCallback());break;case w:(null==i?void 0:i.requestStartCallback)&&(null==i||i.requestStartCallback());break;case Q:(null==i?void 0:i.requestSuccessCallback)&&(null==i||i.requestSuccessCallback(JSON.parse(null!==(l=e.data)&&void 0!==l?l:"")))}};return s({data:l,type:C}).then((()=>(o=!0,Promise.resolve(!0)))).catch((e=>Promise.reject(e)))},Z=()=>{const e=Vt(),t=new URL(window.location.href).searchParams.get(g),l={data:{code:e,pkce:sessionStorage.getItem(y),sessionState:t},type:L};return history.pushState({},document.title,location.href.replace(/\?code=.*$/,"")),sessionStorage.removeItem(y),sessionStorage.removeItem(G),s(l).then((e=>{if(e.type===T){c=!0,sessionStorage.setItem(R,e.data.logoutUrl);const t=e.data;return delete t.logoutUrl,Promise.resolve(t)}return e.type===H&&e.code?(e.pkce&&sessionStorage.setItem(y,e.pkce),location.href=e.code,Promise.resolve({allowedScopes:"",displayName:"",email:"",sessionState:"",tenantDomain:"",username:""})):e.type!==H||e.code?Promise.reject("Something went wrong during authentication. Failed during signing in after getting the authorization code."):Promise.reject("Something went wrong during authentication after obtaining the authorization code. Re-authentication failed. No authorization url was received."+JSON.stringify(e))})).catch((e=>Promise.reject(e)))},m=e=>{if(o){if(Vt()||sessionStorage.getItem(y))return Z();return s({data:e,type:L}).then((e=>{if(e.type===T){c=!0,sessionStorage.setItem(R,e.data.logoutUrl);const t=e.data;return delete t.logoutUrl,Promise.resolve(t)}return e.type===H&&e.code?(e.pkce&&sessionStorage.setItem(y,e.pkce),location.href=e.code,Promise.resolve({allowedScopes:"",displayName:"",email:"",sessionState:"",tenantDomain:"",username:""})):e.type!==H||e.code?Promise.reject("Something went wrong during authentication.Unknown response received. "+JSON.stringify(e)):Promise.reject("Something went wrong during authentication. No authorization url was received."+JSON.stringify(e))})).catch((e=>Promise.reject(e)))}return Promise.reject("Error while signing in. The object has not been initialized yet.")},b=()=>{if(sessionStorage.getItem(R)){const e=sessionStorage.getItem(R);return sessionStorage.removeItem(R),window.location.href=e,Promise.resolve(!0)}return Promise.reject("No login sessions.")},h=()=>{if(!c)return Promise.reject("You have not signed in yet");return s({type:P}).then((e=>Promise.resolve(e))).catch((e=>Promise.reject(e)))},p=()=>s({type:E}).then((e=>Promise.resolve(e))).catch((e=>Promise.reject(e))),W=()=>s({type:M}).then((e=>Promise.resolve(e))).catch((e=>Promise.reject(e))),X=()=>s({type:O}).then((e=>Promise.resolve(e))).catch((e=>Promise.reject(e))),S=e=>{e&&"function"==typeof e&&(i.requestSuccessCallback=e)},I=e=>{e&&"function"==typeof e&&(i.requestErrorCallback=e)},V=e=>{e&&"function"==typeof e&&(i.requestStartCallback=e)},Y=e=>{e&&"function"==typeof e&&(i.requestFinishCallback=e)};return{getInstance:()=>l||(t=new gl,l={customGrant:a,endUserSession:h,getDecodedIDToken:X,getServiceEndpoints:p,getUserInfo:W,httpRequest:d,httpRequestAll:r,initialize:u,onHttpRequestError:I,onHttpRequestFinish:Y,onHttpRequestStart:V,onHttpRequestSuccess:S,signIn:m,signOut:b},l)}})(),Kl={authorizationType:"authorization_code",clientHost:origin,clientSecret:null,clockTolerance:60,consentDenied:!1,enablePKCE:!0,responseMode:null,scope:[S],validateIDToken:!0};class kl{constructor(){this._startedInitialize=!1,this._onCustomGrant=new Map}static getInstance(){return this._instance||(this._instance=new kl),this._instance}
/**
         * This method initializes the `IdentityClient` instance.
         *
         * @preserve
         *
         * @param {ConfigInterface | WebWorkerConfigInterface} config The config object to initialize with.
         *
         * @return {Promise<boolean>} Resolves to true if initialization is successful.
         */initialize(t){var l;t.signOutRedirectURL||(t.signOutRedirectURL=t.signInRedirectURL),this._storage=null!==(l=t.storage)&&void 0!==l?l:e.Storage.SessionStorage,this._initialized=!1,this._startedInitialize=!0;const i=e=>{e.headers=Object.assign(Object.assign({},e.headers),{Authorization:`Bearer ${Ht(b,t)}`}),this._onHttpRequestStart&&"function"==typeof this._onHttpRequestStart&&this._onHttpRequestStart()};return $(t)?(this._client=Yl.getInstance(),this._client.initialize(Object.assign(Object.assign({},Kl),t)).then((()=>(this._onInitialize&&this._onInitialize(!0),this._initialized=!0,Promise.resolve(!0)))).catch((e=>Promise.reject(e)))):(this._authConfig=Object.assign(Object.assign({},Kl),t),this._initialized=!0,this._httpClient=Pe.getInstance(),this._httpClient.init(!0,i,this._onHttpRequestSuccess,this._onHttpRequestError,this._onHttpRequestFinish),this._onInitialize&&this._onInitialize(!0),Promise.resolve(!0))}getUserInfo(){return this._storage===e.Storage.WebWorker?this._client.getUserInfo():Promise.resolve(Ut(this._authConfig))}validateAuthentication(){}signIn(l){return t(this,void 0,void 0,(function*(){if(!this._startedInitialize)return Promise.reject("The object has not been initialized yet.");let t=0;for(;!this._initialized;)21===t&&console.warn("It is taking longer than usual for the object to be initialized"),yield new Promise((e=>setTimeout(e,500))),t++;return this._storage===e.Storage.WebWorker?this._client.signIn(l).then((e=>(this._onSignInCallback&&(e.allowedScopes||e.displayName||e.email||e.username)&&this._onSignInCallback(e),Promise.resolve(e)))).catch((e=>Promise.reject(e))):Jt(this._authConfig,l).then((()=>{if(this._onSignInCallback){const e=Ut(this._authConfig);(e.allowedScopes||e.displayName||e.email||e.username)&&this._onSignInCallback(Ut(this._authConfig))}return Promise.resolve(Ut(this._authConfig))})).catch((e=>Promise.reject(e)))}))}signOut(){return t(this,void 0,void 0,(function*(){return this._storage===e.Storage.WebWorker?this._client.signOut().then((e=>Promise.resolve(e))).catch((e=>Promise.reject(e))):ul(this._authConfig).then((e=>Promise.resolve(e))).catch((e=>Promise.reject(e)))}))}httpRequest(l){return t(this,void 0,void 0,(function*(){return this._storage===e.Storage.WebWorker?this._client.httpRequest(l):this._httpClient.request(l)}))}httpRequestAll(l){return t(this,void 0,void 0,(function*(){if(this._storage===e.Storage.WebWorker)return this._client.httpRequestAll(l);const t=[];return l.forEach((e=>{t.push(this._httpClient.request(e))})),this._httpClient.all(t)}))}customGrant(l){return t(this,void 0,void 0,(function*(){if(!l.id)throw Error("No ID specified for the custom grant.");return this._storage===e.Storage.WebWorker?this._client.customGrant(l).then((e=>(this._onCustomGrant.get(l.id)&&this._onCustomGrant.get(l.id)(e),Promise.resolve(e)))).catch((e=>Promise.reject(e))):vt(l,this._authConfig).then((e=>(this._onCustomGrant.get(l.id)&&this._onCustomGrant.get(l.id)(e),Promise.resolve(e)))).catch((e=>Promise.reject(e)))}))}endUserSession(){return t(this,void 0,void 0,(function*(){return this._storage===e.Storage.WebWorker?this._client.endUserSession().then((e=>{if(this._onEndUserSession)return this._onEndUserSession(e),Promise.resolve(e)})).catch((e=>Promise.reject(e))):kt(this._authConfig,Ht(b,this._authConfig)).then((e=>{if(el(this._authConfig),Ft(this._authConfig),this._onEndUserSession)return this._onEndUserSession(e),Promise.resolve(!0)})).catch((e=>Promise.reject(e)))}))}getServiceEndpoints(){return t(this,void 0,void 0,(function*(){return this._storage===e.Storage.WebWorker?this._client.getServiceEndpoints():Promise.resolve(tl(this._authConfig))}))}getHttpClient(){if(this._initialized)return this._httpClient;throw Error("Identity Client has not been initialized yet")}getDecodedIDToken(){return this._storage===e.Storage.WebWorker?this._client.getDecodedIDToken():Promise.resolve(ft(this._authConfig))}getAccessToken(){return this._storage===e.Storage.WebWorker?Promise.reject("The access token cannot be obtained when the storage type is set to webWorker."):function(e){const t=Ht(b,e),l=Ht(h,e),i=Ht(p,e);if(!t||0===t.trim().length||!l||0===l.length||!i||0===i.length)return Ft(e),Promise.reject(new Error("Invalid user session."));function n(){const t=Ht(h,e),l=Ht(p,e);return parseInt(l,10)+parseInt(t,10)-Math.floor(Date.now()/1e3)}let o=n();return o<=300?Ct.use((()=>(o=n(),o<=300?Kt(JSON.parse(Ht(K,e)),Ht(I,e)).then((t=>(xt(t,Nt(t.idToken),e),Promise.resolve(t.accessToken)))).catch((e=>Promise.reject(e))):Promise.resolve(Ht(b,e))))):Promise.resolve(t)}(this._authConfig)}refreshToken(){return this._storage===e.Storage.WebWorker?Promise.reject("The token is automatically refreshed when the storage type is set to webWorker."):Kt(this._authConfig,Ht(I,this._authConfig))}on(t,l,i){if(!l||"function"!=typeof l)throw Error("The callback function is not a valid function.");switch(t){case e.Hooks.SignIn:this._onSignInCallback=l;break;case e.Hooks.SignOut:this._onSignOutCallback=l,(()=>{const e=new URL(window.location.href).searchParams.get("state"),t=e&&e===D;if(t){const e=new URL(window.location.href),t=new URLSearchParams(e.search.slice(1));t.delete("state");const l=window.location.href.split("?")[0]+"?"+t.toString();history.pushState({},document.title,l)}return t})()&&this._onSignOutCallback();break;case e.Hooks.EndUserSession:this._onEndUserSession=l;break;case e.Hooks.Initialize:this._onInitialize=l;break;case e.Hooks.HttpRequestError:this._storage===e.Storage.WebWorker&&this._client.onHttpRequestError(l),this._onHttpRequestError=l;break;case e.Hooks.HttpRequestFinish:this._storage===e.Storage.WebWorker&&this._client.onHttpRequestFinish(l),this._onHttpRequestFinish=l;break;case e.Hooks.HttpRequestStart:this._storage===e.Storage.WebWorker&&this._client.onHttpRequestStart(l),this._onHttpRequestStart=l;break;case e.Hooks.HttpRequestSuccess:this._storage===e.Storage.WebWorker&&this._client.onHttpRequestSuccess(l),this._onHttpRequestSuccess=l;break;case e.Hooks.CustomGrant:this._onCustomGrant.set(i,l);break;default:throw Error("No such hook found")}}}class Nl extends Worker{}e.ACCESS_TOKEN=b,e.ACCESS_TOKEN_EXPIRE_IN=h,e.ACCESS_TOKEN_ISSUED_AT=p,e.AUTHORIZATION_CODE=G,e.AUTHORIZATION_ENDPOINT=i,e.CLIENT_ID=W,e.END_SESSION_ENDPOINT=c,e.ID_TOKEN=X,e.ISSUER=N,e.IdentityClient=kl,e.JWKS_ENDPOINT=s,e.LOGOUT_URL=R,e.OIDC_SCOPE=S,e.OIDC_SESSION_IFRAME_ENDPOINT=Z,e.OPEN_ID_CONFIG=m,e.OP_CONFIG_INITIATED=a,e.PKCE_CODE_VERIFIER=y,e.REFRESH_TOKEN=I,e.REFRESH_TOKEN_TIMER=J,e.REQUEST_PARAMS=K,e.REVOKE_TOKEN_ENDPOINT=o,e.SCOPE=V,e.SERVICE_RESOURCES=l,e.SESSION_STATE=g,e.SIGN_IN_REDIRECT_URL=r,e.SIGN_OUT_REDIRECT_URL=u,e.TENANT=d,e.TENANT_DOMAIN=k,e.TOKEN_ENDPOINT=n,e.TOKEN_TYPE=Y,e.WebWorkerClass=Nl,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=asgardio-oidc.production.js.map
